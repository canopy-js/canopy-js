(()=>{var t={482:t=>{t.exports=function t(e){var n=e.replace(/(^|(?:.?[^\S])+)([_`*~])((?:.*?\S))\2(\W+|$)/,"$1$3$4");return n!==e?t(n):e}},911:(t,e,n)=>{function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=n(482);n(269);var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.display=e,this.mixedCase=a(e).split(/\\\\/g).map((function(t){return t.replace(/\\/g,"")})).join("\\\\"),this.escapedMixedCase=CSS.escape(this.mixedCase),this.slug=this.mixedCase.replace(/%/g,"%25").replace(/\\\\/g,"%5C%5C").replace(/#/g,"%23").replace(/`/g,"%60").replace(/_/g,"%5C_").replace(/ /g,"_"),this.caps=this.mixedCase.toUpperCase().replace(/\?$/,"").replace(/"/g,"").replace(/'/g,"").replace(/_/g," "),this.fileName=this.slug.replace(/"/g,"%22").replace(/'/g,"%27").replace(/:/g,"%3A").replace(/</g,"%3C").replace(/>/g,"%3E").replace(/\|/g,"%7C").replace(/\*/g,"%2A").replace(/\?/g,"%3F"),this.requestFileName=encodeURIComponent(this.fileName)}var e,n;return e=t,n=[{key:"fromMixedCase",value:function(e){var n=new t(e=e.replace(/([`_~*])/g,"\\$1"));return n.display=null,n}},{key:"fromEncodedSlug",value:function(e){e=function(t){return t.split(/%5C%5C/g).map((function(t){return t.split(/%5C_/g).map((function(t){return t.replace(/_/g," ")})).join("%5C_")})).join("%5C%5C")}(e);var n=new t(e=(e=decodeURIComponent(e)).replace(/\*/g,"\\*").replace(/`/g,"\\`").replace(/~/g,"\\~"));return n.display=null,n}}],null&&r(e.prototype,null),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();i.convertUnderscoresToSpaces=function(t){return t.split(/%5C%5C/g).map((function(t){return t.split(/%5C_/g).map((function(t){return t.replace(/_/g," ")})).join("%5C_")})).join("%5C%5C")},i.convertSpacesToUnderscores=function(t){return t.split("/").map((function(t){return new i(t).fileName})).join("/")},t.exports=i},570:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var r=n(537),a=n.n(r),i=n(645),o=n.n(i)()(a());o.push([t.id,"#_canopy{padding-top:15px;overflow-anchor:none;padding-bottom:80vh}#_canopy h1{text-align:center;margin:auto;margin-top:10px}#_canopy hr{width:120px;display:block;height:1px;border:0;border-top:5px solid #ccc;margin:0px auto;padding-bottom:30px}#_canopy section.canopy-topic-section{padding-top:40px}#_canopy section{padding-top:30px}#_canopy p{overflow:visible;font-size:22px;max-width:700px;margin:auto;line-height:1.3;letter-spacing:-0.003em;font-weight:400;font-family:Times,serif}#_canopy a.canopy-selectable-link{text-decoration:underline #ddd;color:#000;cursor:pointer}#_canopy a.canopy-selectable-link:focus{outline:0}#_canopy a.canopy-selectable-link.canopy-open-link{text-shadow:.8px 0px 0px #000;text-decoration:underline}#_canopy a.canopy-selectable-link:hover{text-decoration:underline #000}#_canopy a.canopy-selectable-link.canopy-selected-link{background-color:#edeefc;text-shadow:0px 0px 0px #000;text-decoration:none}#_canopy a.canopy-selectable-link.canopy-url-link{text-decoration:none;display:inline;overflow-wrap:break-word;white-space:normal;margin-right:-2px}#_canopy a.canopy-selectable-link.canopy-url-link .canopy-url-link-tokens-container{text-decoration:underline #ddd}#_canopy a.canopy-selectable-link.canopy-url-link .canopy-url-link-tokens-container:hover{text-decoration:underline #000}#_canopy a.canopy-selectable-link.canopy-url-link .canopy-url-link-svg-container{padding-right:3px;margin-left:-8px;margin-right:-8px}#_canopy a.canopy-selectable-link.canopy-url-link .canopy-url-link-tokens-spacing{font-size:18px}#_canopy a.canopy-selectable-link.canopy-url-link span{display:inline}#_canopy a.canopy-selectable-link.canopy-url-link svg{height:15px;width:12px;vertical-align:-4px}#_canopy span.canopy-text-span{display:block}#_canopy hr.canopy-footnote-rule{width:700px;display:block;height:1px;border:0;border-top:1px solid #ccc;margin:12px 0;padding:0}#_canopy sup{font-size:60%;padding:2px}#_canopy .canopy-footnote-span{font-size:80%}#_canopy blockquote{padding:0 .7em;color:#565e67;margin-block-start:.5em;margin-block-end:.5em;margin-inline-start:0px;margin-inline-end:0px}#_canopy blockquote a{color:#565e67}#_canopy blockquote[dir=rtl]{border-right:.25em solid #d3d3d3}#_canopy blockquote[dir=ltr]{border-left:.25em solid #d3d3d3}#_canopy blockquote a.canopy-selectable-link{text-decoration:underline #d3d3d3}#_canopy pre{margin:10px 10px;background-color:#eff0f1;padding:5px;font-size:85%}#_canopy code{background-color:#eff0f1;font-size:90%}#_canopy table{margin:7px auto;table-layout:fixed;width:70%;border-collapse:collapse;border:2px solid #000}#_canopy table td,#_canopy table th{border:2px solid #000;text-align:center;padding:6px}#_canopy .canopy-image{margin-top:15px;margin-bottom:15px}#_canopy .canopy-image a{margin:0 auto}#_canopy .canopy-image img{display:block;width:100%;margin:0 auto}#_canopy .canopy-image span.canopy-image-caption{margin:0px auto;width:100%;padding:6px 0;text-align:left;display:block;font-size:16px;margin-top:4px;line-height:18px;color:#595959}#_canopy .canopy-image span.canopy-image-caption a{color:#595959}#_canopy .canopy-image span.canopy-image-caption span{display:inline}#_canopy div.canopy-image-div{float:right;border:1px solid #c8ccd1;padding:3px;background-color:#f8f9fa;font-size:94%;text-align:center;overflow:hidden;margin:10px}#_canopy div.canopy-image-div>sup{display:block}#_canopy ol,#_canopy ul{margin:7px 10px}#_canopy div.canopy-raw-html{display:inline}#_canopy>section.canopy-topic-section{padding-top:30px}","",{version:3,sources:["webpack://./client/style/canopy.scss"],names:[],mappings:"AAAA,SACE,gBAAA,CACA,oBAAA,CAOA,mBAAA,CAGA,YACE,iBAAA,CACA,WAAA,CACA,eAAA,CAGF,YACE,WAAA,CACA,aAAA,CACA,UAAA,CACA,QAAA,CACA,yBAAA,CACA,eAAA,CACA,mBAAA,CAGF,sCACE,gBAAA,CAGF,iBACE,gBAAA,CAGF,WACE,gBAAA,CACA,cAAA,CACA,eAAA,CACA,WAAA,CAEA,eAAA,CACA,uBAAA,CACA,eAAA,CACA,uBAAA,CAKF,kCACE,8BAAA,CACA,UAAA,CACA,cAAA,CAEA,wCACE,SAAA,CAGF,mDACE,6BAAA,CACA,yBAAA,CAGF,wCACE,8BAAA,CAGF,uDACE,wBAAA,CACA,4BAAA,CACA,oBAAA,CAGF,kDACE,oBAAA,CACA,cAAA,CACA,wBAAA,CACA,kBAAA,CACA,iBAAA,CAEA,oFACE,8BAAA,CAEA,0FACE,8BAAA,CAIJ,iFACE,iBAAA,CACA,gBAAA,CACA,iBAAA,CAGF,kFACE,cAAA,CAGF,uDACE,cAAA,CAGF,sDACE,WAAA,CACA,UAAA,CACA,mBAAA,CAON,+BACE,aAAA,CAGF,iCACE,WAAA,CACA,aAAA,CACA,UAAA,CACA,QAAA,CACA,yBAAA,CACA,aAAA,CACA,SAAA,CAGF,aACE,aAAA,CACA,WAAA,CAGF,+BACE,aAAA,CAGF,oBACE,cAAA,CACA,aAAA,CAcA,uBAAA,CACA,qBAAA,CACA,uBAAA,CACA,qBAAA,CAfA,sBACE,aAAA,CAGF,6BACE,gCAAA,CAGF,6BACE,+BAAA,CAQF,6CACE,iCAAA,CAIJ,aACE,gBAAA,CACA,wBAAA,CACA,WAAA,CACA,aAAA,CAGF,cACE,wBAAA,CACA,aAAA,CAGF,eACE,eAAA,CACA,kBAAA,CACA,SAAA,CACA,wBAAA,CACA,qBAAA,CAEA,oCACE,qBAAA,CACA,iBAAA,CACA,WAAA,CAIJ,uBACE,eAAA,CACA,kBAAA,CAEA,yBACE,aAAA,CAGF,2BACE,aAAA,CACA,UAAA,CACA,aAAA,CAGF,iDACE,eAAA,CACA,UAAA,CACA,aAAA,CACA,eAAA,CACA,aAAA,CACA,cAAA,CACA,cAAA,CACA,gBAAA,CACA,aAAA,CAEA,mDACE,aAAA,CAGF,sDACE,cAAA,CAKN,8BACE,WAAA,CACA,wBAAA,CACA,WAAA,CACA,wBAAA,CACA,aAAA,CACA,iBAAA,CACA,eAAA,CACA,WAAA,CAGF,kCACE,aAAA,CAGF,wBACE,eAAA,CAGF,6BACE,cAAA,CAIJ,sCACE,gBAAA",sourcesContent:['#_canopy {\n  padding-top: 15px;\n  overflow-anchor: none; // Prevent browser from trying to maintain position when page contents change, which might interfere with window.scrollTo\n\n  /* Removing DOM elements from the bottom of the screen can force the page to scroll upward to the existing elements\n  which is not animated. If we keep a padding on the bottom of the last element just beyond the viewport, then\n  removal of elements from the bottom of the visible stack never brings the real bottom of the page into view, and so\n  the scroll upwards can be animated using the window.scrollTo method. */\n\n  padding-bottom: calc(80vh);\n\n\n  h1 {\n    text-align: center;\n    margin: auto;\n    margin-top: 10px;\n  }\n\n  hr {\n    width: 120px;\n    display: block;\n    height: 1px;\n    border: 0;\n    border-top: 5px solid #ccc;\n    margin: 0px auto;\n    padding-bottom: 30px;\n  }\n\n  section.canopy-topic-section {\n    padding-top: 40px;\n  }\n\n  section {\n    padding-top: 30px;\n  }\n\n  p {\n    overflow: visible; // In case external link icon is at end of line\n    font-size: 22px;\n    max-width: 700px;\n    margin: auto;\n\n    line-height: 1.3;\n    letter-spacing: -.003em;\n    font-weight: 400;\n    font-family: Times, serif;\n  }\n\n///////////// Link styles /////////////////\n\n  a.canopy-selectable-link {\n    text-decoration: underline #DDDDDD;\n    color: black;\n    cursor: pointer;\n\n    &:focus {\n      outline:0;\n    }\n\n    &.canopy-open-link {\n      text-shadow: .8px 0px 0px #000000;\n      text-decoration: underline;\n    }\n\n    &:hover {\n      text-decoration: underline #000000;\n    }\n\n    &.canopy-selected-link {\n      background-color: #edeefc;\n      text-shadow: 0px 0px 0px #000000;\n      text-decoration: none;\n    }\n\n    &.canopy-url-link {\n      text-decoration: none; // we want the selection background to extend beyond the icon but the underlining only until the end of the icon\'s bottom\n      display: inline;\n      overflow-wrap: break-word;\n      white-space: normal;\n      margin-right: -2px; // we want the text after the icon to hug the icon, eg if it is a period\n\n      .canopy-url-link-tokens-container {\n        text-decoration: underline #DDDDDD;\n\n        &:hover {\n          text-decoration: underline #000000; // hover underline should be black\n        }\n      }\n\n      .canopy-url-link-svg-container {\n        padding-right: 3px; // this is the spacing after the icon that extends the selected-link-selection bg but not the underlining\n        margin-left: -8px; // We add 3 non-breaking spaces, then move the svg over them so the last word always wraps with svg\n        margin-right: -8px; // If character after is punctuation and we move it within the spacing, it will also wrap with the svg\n      }\n\n      .canopy-url-link-tokens-spacing { // this is the spacing before the icon that creates space for the icon\'s negative margin\n        font-size: 18px;                // we use spaces and not padding because spaces can get text-decoration\n      }\n\n      span {\n        display: inline;\n      }\n\n      svg {\n        height: 15px;\n        width: 12px;\n        vertical-align: -4px; // move the icon in-line with the text\n      }\n     }\n  }\n\n/////////////////////////////////////////////\n\n  span.canopy-text-span {\n    display: block;\n  }\n\n  hr.canopy-footnote-rule {\n    width: 700px;\n    display: block;\n    height: 1px;\n    border: 0;\n    border-top: 1px solid #ccc;\n    margin: 12px 0;\n    padding: 0;\n  }\n\n  sup {\n    font-size: 60%;\n    padding: 2px;\n  }\n\n  .canopy-footnote-span {\n    font-size: 80%;\n  }\n\n  blockquote {\n    padding: 0 .7em;\n    color: #565e67;\n\n    a {\n      color: #565e67;\n    }\n\n    &[dir="rtl"] {\n      border-right: 0.25em solid lightgray;\n    }\n\n    &[dir="ltr"] {\n      border-left: 0.25em solid lightgray;\n    }\n\n    margin-block-start: .5em;\n    margin-block-end: .5em;\n    margin-inline-start: 0px;\n    margin-inline-end: 0px;\n\n    a.canopy-selectable-link {\n      text-decoration: underline #D3D3D3;\n    }\n  }\n\n  pre {\n    margin: 10px 10px;\n    background-color: #eff0f1;\n    padding: 5px;\n    font-size: 85%;\n  }\n\n  code {\n    background-color: #eff0f1;\n    font-size: 90%;\n  }\n\n  table {\n    margin: 7px auto;\n    table-layout: fixed;\n    width: 70%;\n    border-collapse: collapse;\n    border: 2px solid black;\n\n    td, th {\n      border: 2px solid black;\n      text-align: center;\n      padding: 6px;\n    }\n  }\n\n  .canopy-image {\n    margin-top: 15px;\n    margin-bottom: 15px;\n\n    a {\n      margin: 0 auto;\n    }\n\n    img {\n      display: block;\n      width: 100%;\n      margin: 0 auto;\n    }\n\n    span.canopy-image-caption {\n      margin: 0px auto;\n      width: 100%;\n      padding: 6px 0;\n      text-align: left;\n      display: block;\n      font-size: 16px;\n      margin-top: 4px;\n      line-height: 18px;\n      color: #595959;\n\n      a {\n        color: #595959;\n      }\n\n      span {\n        display: inline;\n      }\n    }\n  }\n\n  div.canopy-image-div {\n    float: right;\n    border: 1px solid #c8ccd1;\n    padding: 3px;\n    background-color: #f8f9fa;\n    font-size: 94%;\n    text-align: center;\n    overflow: hidden;\n    margin: 10px;\n  }\n\n  div.canopy-image-div > sup {\n    display: block;\n  }\n\n  ol, ul {\n    margin: 7px 10px;\n  }\n\n  div.canopy-raw-html {\n    display: inline;\n  }\n}\n\n#_canopy > section.canopy-topic-section {\n  padding-top: 30px;\n}\n'],sourceRoot:""}]);const c=o},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,a,i){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var c=0;c<this.length;c++){var l=this[c][0];null!=l&&(o[l]=!0)}for(var s=0;s<t.length;s++){var p=[].concat(t[s]);r&&o[p[0]]||(void 0!==i&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=i),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),a&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=a):p[4]="".concat(a)),e.push(p))}},e}},537:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),a="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),i="/*# ".concat(a," */"),o=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(o).concat([i]).join("\n")}return[e].join("\n")}},269:function(t,e,n){var r;r=void 0!==n.g?n.g:this,t.exports=function(t){if(t.CSS&&t.CSS.escape)return t.CSS.escape;var e=function(t){if(0==arguments.length)throw new TypeError("`CSS.escape` requires an argument.");for(var e,n=String(t),r=n.length,a=-1,i="",o=n.charCodeAt(0);++a<r;)0!=(e=n.charCodeAt(a))?i+=e>=1&&e<=31||127==e||0==a&&e>=48&&e<=57||1==a&&e>=48&&e<=57&&45==o?"\\"+e.toString(16)+" ":0==a&&1==r&&45==e||!(e>=128||45==e||95==e||e>=48&&e<=57||e>=65&&e<=90||e>=97&&e<=122)?"\\"+n.charAt(a):n.charAt(a):i+="ï¿½";return i};return t.CSS||(t.CSS={}),t.CSS.escape=e,e}(r)},379:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var i={},o=[],c=0;c<t.length;c++){var l=t[c],s=r.base?l[0]+r.base:l[0],p=i[s]||0,u="".concat(s," ").concat(p);i[s]=p+1;var d=n(u),h={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(h);else{var f=a(h,r);r.byIndex=c,e.splice(c,0,{identifier:u,updater:f,references:1})}o.push(u)}return o}function a(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,a){var i=r(t=t||[],a=a||{});return function(t){t=t||[];for(var o=0;o<i.length;o++){var c=n(i[o]);e[c].references--}for(var l=r(t,a),s=0;s<i.length;s++){var p=n(i[s]);0===e[p].references&&(e[p].updater(),e.splice(p,1))}i=l}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,a&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(r){var a=e[r];if(void 0!==a)return a.exports;var i=e[r]={id:r,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{"use strict";var t=n(379),e=n.n(t),r=n(795),a=n.n(r),i=n(569),o=n.n(i),c=n(565),l=n.n(c),s=n(216),p=n.n(s),u=n(589),d=n.n(u),h=n(570),f={};f.styleTagTransform=d(),f.setAttributes=l(),f.insert=o().bind(null,"head"),f.domAPI=a(),f.insertStyleElement=p(),e()(h.Z,f),h.Z&&h.Z.locals&&h.Z.locals;var g=document.getElementById("_canopy"),A=g&&g.dataset.defaultTopic,m=g&&g.dataset.projectPathPrefix,y=g&&g.dataset.hashUrls;function k(t,e){for(var n=t.parentElement;n.classList&&!n.classList.contains(e);){if(n===g)return null;n=n.parentNode}return n}const v={};var b=n(911),C=n.n(b);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function x(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}const S=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"A"===e.tagName)this.element=e;else{if(e instanceof t)throw new Error("Cannot instantiate link from link");if("object"===w(e))this.metadataObject=e;else{if("function"!=typeof e)throw new Error("Invalid argument to Link constructor");this.selectorCallback=e}}}var e,n,r;return e=t,r=[{key:"collectMetadata",value:function(e){var n=new t(e);return{pathString:L.containingLink(n).path.string,text:e.dataset.text,relativeLinkNumber:n.relativeLinkNumber}}},{key:"containsLinkSelectionMetadata",value:function(t){return void 0!==t.relativeLinkNumber}},{key:"elementFromMetadata",value:function(t){var e=new _(t.pathString).paragraph;if(!e)throw new Error("Link selection data refers to non-existant link");var n=e.linkBySelector((function(e,n){return e.element.dataset.text===t.text&&n===t.relativeLinkNumber}));return n&&n.element||null}},{key:"select",value:function(e){e&&(e.element.classList.add("canopy-selected-link"),t.persistInHistory(e),t.persistInSession(e),t.persistLastSelectionData(e))}},{key:"selectionPresentInEvent",value:function(e){return e.state&&t.containsLinkSelectionMetadata(e.state)}},{key:"sessionSelection",get:function(){var e=sessionStorage.getItem(_.current.string);return e&&"null"!==e?new t(JSON.parse(e)):null}},{key:"historySelection",get:function(){return history.state&&t.containsLinkSelectionMetadata(history.state)?new t(history.state):null}},{key:"priorSelection",get:function(){return this.historySelection||this.sessionSelection||null}},{key:"selection",get:function(){var e=document.querySelector("a.canopy-selected-link");return e?new t(e):null}},{key:"persistInSession",value:function(t){var e=t&&JSON.stringify(t.metadata);sessionStorage.setItem(location.pathname+location.hash,e||null)}},{key:"persistInHistory",value:function(t){history.replaceState(t&&t.metadata||null,document.title,window.location.href)}},{key:"selectALink",value:function(e){return new t((function(){var t=(e=e||_.current).paragraph;return t.firstLink||t.parentLink}))}},{key:"current",value:function(){throw new Error("Link#current does not exist, try Link#selection")}},{key:"persistLastSelectionData",value:function(t){if(t){var e=JSON.parse(sessionStorage.getItem("lastSelectionsOfParagraph")||"{}");e[t.enclosingParagraph.path]=t.metadata,sessionStorage.setItem("lastSelectionsOfParagraph",JSON.stringify(e))}}},{key:"lastSelectionOfParagraph",value:function(e){var n=JSON.parse(sessionStorage.getItem("lastSelectionsOfParagraph")||"{}");if(n[e.path]){var r=new t(n[e.path]);try{if(r.element)return r}catch(t){return null}}}}],(n=[{key:"equals",value:function(t){return this.element===t.element}},{key:"matches",value:function(t){if(!t)throw new Error("Invalid link argument to Link#matches");return this.targetTopic===t.targetTopic&&this.targetSubtopic===t.targetSubtopic&&this.relativeLinkNumber===t.relativeLinkNumber}},{key:"contradicts",value:function(t){if(!(t instanceof _))throw new Error("Invalid path argument to Link#contradicts");return this.path.string!==t.string}},{key:"element",get:function(){if(this.linkElement)return this.linkElement;if(this.metadataObject){if(this.element=t.elementFromMetadata(this.metadata),!this.linkElement)throw new Error("Metadata refered to non-existant link");return this.linkElement}if(this.selectorCallback){var e=this.selectorCallback();if(!e)throw new Error("Link selector callback provided no link");return this.element=e.element,this.linkElement}},set:function(e){e instanceof HTMLAnchorElement?this.linkElement=e:e instanceof t&&(this.linkElement=e.element),this.transferDataset()}},{key:"transferDataset",value:function(){this.linkElement&&(this._targetTopic=this.linkElement.dataset.targetTopic,this._targetSubtopic=this.linkElement.dataset.targetSubtopic,this._enclosingTopic=this.linkElement.dataset.enclosingTopic,this._enclosingSubtopic=this.linkElement.dataset.enclosingSubtopic,this._typeValue=this.linkElement.dataset.type)}},{key:"targetTopic",get:function(){return C().fromMixedCase(this.element.dataset.targetTopic)}},{key:"targetSubtopic",get:function(){return C().fromMixedCase(this.element.dataset.targetSubtopic)}},{key:"enclosingTopic",get:function(){return C().fromMixedCase(this.element.dataset.enclosingTopic)}},{key:"enclosingSubtopic",get:function(){return C().fromMixedCase(this.element.dataset.enclosingSubtopic)}},{key:"topicName",get:function(){throw new Error("Links have no topicName, only targetTopic or enclosingTopic")}},{key:"subtopicName",get:function(){throw new Error("Links have no subtopicName, only targetSubtopic or enclosingSubtopic")}},{key:"type",get:function(){return this.element.dataset.type}},{key:"enclosingSectionElement",get:function(){return k(this.element,"canopy-section")}},{key:"sectionElement",get:function(){throw new Error("Depreciated in favor of #enclosingSectionElement")}},{key:"enclosingParagraphElement",get:function(){return k(this.element,"canopy-paragraph")}},{key:"parentParagraphElement",get:function(){throw new Error("Depreciated in favor of #enclosingParagraphElement")}},{key:"enclosingParagraph",get:function(){return new L(this.enclosingSectionElement)}},{key:"targetParagraph",get:function(){if(!this.isParent)return null;var t=this.enclosingParagraph.pathDepth;this.isGlobalOrImport&&(t=Number(t)+1);var e=this.enclosingParagraph.sectionElement.querySelector('section[data-topic-name="'.concat(this.targetTopic.escapedMixedCase,'"]')+'[data-subtopic-name="'.concat(this.targetSubtopic.escapedMixedCase,'"]')+'[data-path-depth="'.concat(t,'"'));if(!e)throw new Error("Did not find paragraph child element matching link [".concat(this.targetTopic.mixedCase,", ").concat(this.targetSubtopic.mixedCase,"]"));return new L(e)}},{key:"atNewPath",value:function(e){var n=this;return new t((function(){return(n.isParent?e.paragraph.parentParagraph:e.paragraph).links.find(n.matcher)}))}},{key:"localPathSegmentWhenSelected",get:function(){return this.isGlobalOrImport?new _(this.path.pathArray.slice(-2)):this.path.lastSegment}},{key:"matcher",get:function(){var t=this;return function(e){return e.matches(t)}}},{key:"relativeLinkNumber",get:function(){return this.storedRelativeLinkNumber||(this.storedRelativeLinkNumber=this.enclosingParagraph.links.map((function(t){return t.element})).indexOf(this.element)),this.storedRelativeLinkNumber}},{key:"metadata",get:function(){if(this.metadataObject)return this.metadataObject;if(this.linkElement){var e=t.collectMetadata(this.linkElement);return this.metadataObject=e,e}if(this.selectorCallback)return this.element=this.selectorCallback(),this.metadata;throw new Error("Link has neither supplied metadata, dom element, nor selector function")}},{key:"targetPath",get:function(){return this.isGlobalOrImport?this.enclosingParagraph.path.addSegment(this.targetTopic,this.targetSubtopic):this.isLocal?this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic):null}},{key:"pathToDisplay",get:function(){throw new Error("Depreciated in favor of #path")}},{key:"path",get:function(){return this.isGlobalOrImport?this.enclosingParagraph.path.addSegment(this.targetTopic,this.targetSubtopic):this.isLocal?this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic):this.enclosingParagraph.path}},{key:"urlPathWhenSelected",get:function(){throw new Error("Depreciated in favor of #path")}},{key:"nextSibling",get:function(){var t=this.enclosingParagraph.links;if(this.equals(t[t.length-1]))return null;var e=t.map((function(t){return t.element}));return t[e.indexOf(this.element)+1]}},{key:"previousSibling",get:function(){var t=this.enclosingParagraph.links;if(this.equals(t[0]))return null;var e=t.map((function(t){return t.element}));return t[e.indexOf(this.element)-1]}},{key:"siblings",get:function(){return this.enclosingParagraph.links}},{key:"firstSibling",get:function(){return this.siblings[0]}},{key:"lastSibling",get:function(){return this.siblings[this.siblings.length-1]}},{key:"firstChildLink",get:function(){return this.targetParagraph.firstLink}},{key:"lastChildLink",get:function(){return this.targetParagraph.lastLink}},{key:"parentLink",get:function(){return this.enclosingParagraph.parentLink}},{key:"grandParentLink",get:function(){var t;return null===(t=this.parentLink)||void 0===t?void 0:t.parentLink}},{key:"topicParagraph",get:function(){return k(this.element,"canopy-topic-section")}},{key:"selected",get:function(){return this.element.classList.includes("canopy-selected-link")}},{key:"open",value:function(){this.element.classList.add("canopy-open-link")}},{key:"isOpen",get:function(){return this.element.classList.contains("canopy-open-link")}},{key:"isClosed",get:function(){return!this.isOpen}},{key:"isSelected",get:function(){return this.element.classList.contains("canopy-selected-link")}},{key:"isGlobal",get:function(){return"global"===this.type}},{key:"isImport",get:function(){return"import"===this.type}},{key:"isGlobalOrImport",get:function(){return"global"===this.type||"import"===this.type}},{key:"isLocal",get:function(){return"local"===this.type}},{key:"isParent",get:function(){return this.isGlobal||this.isLocal||this.isImport}},{key:"hasChildren",get:function(){return this.targetParagraph.hasLinks}}])&&x(e.prototype,n),r&&x(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}const L=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e||"SECTION"!==e.tagName)throw new Error("Paragraph instantiation requires section element");if(!e.classList.contains("canopy-section"))throw new Error("Paragraph class requires Canopy section element");this.sectionElement=e,this.transferDataset()}var e,n,r;return e=t,r=[{key:"current",get:function(){return new t(document.querySelector(".canopy-selected-section"))}},{key:"pageRoot",get:function(){return _.current.rootTopicPath.paragraph}},{key:"containingLink",value:function(e){if(!(e instanceof S))throw new Error("Must provide link instance argument");return new t(k(e.element,"canopy-section"))}}],(n=[{key:"equals",value:function(t){return!!t&&this.sectionElement===t.sectionElement}},{key:"display",value:function(){this.sectionElement.style.display="block"}},{key:"element",get:function(){throw new Error("Depreciated in favor of #sectionElement property")}},{key:"transferDataset",value:function(){this._topicName=this.sectionElement.dataset.topicName,this._subtopicName=this.sectionElement.dataset.subtopicName,this.pathDepth=this.sectionElement.dataset.pathDepth}},{key:"topic",get:function(){return C().fromMixedCase(this.sectionElement.dataset.topicName)}},{key:"subtopic",get:function(){return C().fromMixedCase(this.sectionElement.dataset.subtopicName)}},{key:"topicName",get:function(){throw new Error("Depreciated in favor of #topic")}},{key:"subtopicName",get:function(){throw new Error("Depreciated in favor of #subtopic")}},{key:"paragraphElement",get:function(){var t=Array.from(this.sectionElement.childNodes).find((function(t){return"P"===t.tagName}));if(!t)throw new Error("Paragraph has no paragraph element");return t}},{key:"path",get:function(){for(var e=[],n=this.sectionElement,r=this,a=this.topicParagraph;n!==g;)for(a=r.topicParagraph,e.unshift([C().fromMixedCase(n.dataset.topicName),C().fromMixedCase(n.dataset.subtopicName)]);n!==g&&r.topicParagraph.equals(a);)(n=n.parentNode)!==g&&(r=new t(n));return new _(e)}},{key:"links",get:function(){if(this.linkObjects)return this.linkObjects;var t=this.paragraphElement.querySelectorAll("a.canopy-selectable-link");return this.linkObjects=Array.from(t).map((function(t){return new S(t)})),this.linkObjects}},{key:"firstLink",get:function(){return this.links[0]||null}},{key:"lastLink",get:function(){return this.links[this.links.length-1]||null}},{key:"isPageRoot",get:function(){return this.sectionElement.parentNode===g}},{key:"isTopic",get:function(){return this.topic.caps===this.subtopic.caps}},{key:"hasLinks",get:function(){return this.links.length>0}},{key:"linkBySelector",value:function(t){return this.links.find(t)}},{key:"linksBySelector",value:function(t){return this.links.filter(t)}},{key:"linkByTarget",value:function(t,e){return e=e||t,this.linkBySelector((function(n){return n.isParent&&n.targetTopic.caps===t.caps&&n.targetSubtopic.caps===e.caps}))}},{key:"parentLink",get:function(){return this.sectionElement.parentNode===g?null:this.parentParagraph&&this.parentParagraph.linkByTarget(this.topic,this.subtopic)}},{key:"parentLinks",get:function(){var t=this;return this.sectionElement.parentNode===g?null:this.parentParagraph.linksBySelector((function(e){return(e.isLocal||e.isGlobal)&&t.topic.caps===e.targetTopic.caps&&t.subtopic.caps===e.targetSubtopic.caps}))}},{key:"ancestorImportReferences",get:function(){var t=this;return this.pageRoot?[]:this.topicParagraph.parentParagraph?this.topicParagraph.parentParagraph.linksBySelector((function(e){return e.isImport&&t.topic.caps===e.targetTopic.caps&&t.subtopic.caps===e.targetSubtopic.caps})):[]}},{key:"displayTopicName",get:function(){return this.sectionElement.dataset.displayTopicName}},{key:"parentParagraph",get:function(){if(this.sectionElement){var e=k(this.sectionElement,"canopy-section");return e?new t(e):null}return null}},{key:"topicParagraph",get:function(){return this.isTopic?this:new t(k(this.sectionElement,"canopy-topic-section"))}},{key:"isTopicRoot",get:function(){return this.topicName===this.subtopicName}},{key:"select",value:function(){this.sectionElement.classList.add("canopy-selected-section")}}])&&E(e.prototype,n),r&&E(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i=[],o=!0,c=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){c=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(c)throw a}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function B(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}const _=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e?Array.isArray(e)?(0===e.length?this.pathArray=[]:(this.pathArray=e.slice(),t.validatePathArray(this.pathArray)),this.pathString=t.arrayToString(this.pathArray)):("string"==typeof e||e instanceof String)&&(this.pathArray=t.stringToArray(e),this.pathString=t.arrayToString(this.pathArray)):this.pathArray=[]}var e,n,r;return e=t,r=[{key:"validatePathArray",value:function(t){t.forEach((function(t){if(2!==t.length)throw newError("Invalid path segment format: ".concat(t));if(!(t[0]instanceof C()&&t[1]instanceof C()))throw newError("Invalid path segment format: ".concat(t))}))}},{key:"default",get:function(){var e=C().fromMixedCase(A);return new t([[e,e]])}},{key:"current",get:function(){var e=window.location.href.slice(window.location.origin.length);return m&&0===e.indexOf("/".concat(m))&&(e=e.slice(m.length+1)),0===e.indexOf("/#")&&(e=e.slice(2)),new t(e)}},{key:"currentOrDefault",get:function(){return t.current.empty?t.default:t.current}},{key:"forTopic",value:function(e){return new t([[e,e]])}},{key:"forSegment",value:function(e,n){return new t([[e,n]])}},{key:"stringToArray",value:function(e){if("string"!=typeof e)throw newError("Function requires string argument");if("/"===e)return[];var n=e.split("/").filter((function(t){return""!==t})),r=(n=t.fixOrphanSubtopics(e,n)).map((function(t){var e=t.match(/([^#]*)(?:#([^#]*))?/);return[e[1]||e[2]||null,e[2]||e[1]||null]})).filter((function(t){return null!==t[0]}));return r.map((function(t){var e=P(t,2),n=e[0],r=e[1];return[C().fromEncodedSlug(n),C().fromEncodedSlug(r)]}))}},{key:"arrayToString",value:function(t){if(!Array.isArray(t))throw newError("Argument must be array");if(Array.isArray(t)&&0===t.length)return"/";if(!Array.isArray(t[0]))throw newError("Path array must be two-dimensional array");var e="/";return m&&(e+="".concat(m,"/")),y&&(e+="#/"),e+t.map((function(t){var e=P(t,2),n=e[0],r=e[1],a=n.slug;return r&&r.slug!==n.slug&&(a+="#"+r.slug),a})).join("/")}},{key:"fixOrphanSubtopics",value:function(t,e){if("string"!=typeof t)throw newError("pathString must be a string argument");if(!Array.isArray(e))throw newError("slashSeparatedUnits must be an array");if(t.match(/\/#\w+/))for(var n=1;n<e.length;n++)if(e[n].match(/^#/)){if(e[n-1].match(/#/)){var r=e[n].slice(1);return e.slice(0,n).concat([r]).concat(e.slice(n+1))}var a=e[n-1]+e[n];return e.slice(0,n-1).concat([a]).concat(e.slice(n+1))}return e}},{key:"connectingLinkValid",value:function(e,n){if(!e)throw newError("Parent element required");if(!(n instanceof t))throw newError("pathToDisplay must be a Path object");if(e===g)return!0;var r=new L(e);return!!r.linkByTarget(n.firstTopic)||(console.error("Parent element [".concat(r.topic.mixedCase,", ").concat(r.subtopic.mixedCase,"] has no ")+"connecting link to subsequent path segment [".concat(n.firstTopic,", ").concat(n.firstTopic,"]")),!1)}},{key:"elementAtRelativePath",value:function(e,n){if(!(e instanceof t))throw newError("pathToDisplay must be a Path object");!n||n.tagName;var r=n;n||(r=g);var a=e,i=r;if(r===g){if(i=r.querySelector('[data-topic-name="'.concat(a.firstTopic.escapedMixedCase,'"]')+'[data-subtopic-name="'.concat(a.firstSubtopic.escapedMixedCase,'"]')+'[data-path-depth="'.concat(0,'"]')),1===a.length)return i;if(!i)return null;a=a.withoutFirstSegment}for(var o=a,c=0;c<a.length;c++){var l=Number(i.dataset.pathDepth)+1;if(!(i=i.querySelector('[data-topic-name="'.concat(o.firstTopic.escapedMixedCase,'"]')+'[data-subtopic-name="'.concat(o.firstSubtopic.escapedMixedCase,'"]')+'[data-path-depth="'.concat(l,'"]'))))return null;o=o.withoutFirstSegment}return i}},{key:"setPath",value:function(e){if(!(e instanceof t))throw newError("newPath must be Path object");var n=t.current,r=e.firstTopic.display,a=t.current.empty||e.equals(n)?function(t,e,n){history.replaceState(t,e,n)}:function(t,e,n){history.pushState(t,e,n)},i=e.string;a(history.state,r,i)}}],(n=[{key:"equals",value:function(t){return this.string===t.string}},{key:"addSegment",value:function(e,n){return this.empty?new t([[e,n]]):new t(this.pathArray.concat([[e,n]]))}},{key:"replaceTerminalSubtopic",value:function(t){var e=this.lastSegment;return this.withoutLastSegment.addSegment(e.firstTopic,t)}},{key:"toString",value:function(){return this.string}},{key:"array",get:function(){return this.pathArray}},{key:"string",get:function(){return this.pathString}},{key:"rootTopicPath",get:function(){return this.length>0?new t([[this.firstTopic,this.firstTopic]]):this}},{key:"firstTopic",get:function(){return this.pathArray[0][0]}},{key:"lastTopic",get:function(){return this.lastSegment.topic}},{key:"topic",get:function(){var t;return null===(t=this.lastSegment.pathArray[0])||void 0===t?void 0:t[0]}},{key:"firstSubtopic",get:function(){return this.pathArray[0][1]}},{key:"secondTopic",get:function(){return this.pathArray[1]&&this.pathArray[1][0]}},{key:"secondSubtopic",get:function(){return this.pathArray[1]&&this.pathArray[1][1]}},{key:"firstSegment",get:function(){return new t(this.pathArray.slice(0,1))}},{key:"lastSegment",get:function(){return new t(this.pathArray.slice(-1))}},{key:"withoutFirstSegment",get:function(){return new t(this.pathArray.slice(1))}},{key:"withoutLastSegment",get:function(){return new t(this.pathArray.slice(0,-1))}},{key:"length",get:function(){return this.pathArray[0]?this.pathArray.length:0}},{key:"sectionElement",get:function(){return t.elementAtRelativePath(this,g)}},{key:"paragraph",get:function(){return this.sectionElement?new L(this.sectionElement):null}},{key:"empty",get:function(){return!this.pathArray[0]}}])&&B(e.prototype,n),r&&B(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),N=function(t){if(v[t.mixedCase])return v[t.mixedCase];var e=(m?"/"+m:"")+"/_data/"+t.requestFileName+".json",n=fetch(e).then((function(t){return t.json().then((function(t){return t}))})).catch((function(){return v[t.mixedCase]=void 0,Promise.reject(new Error('Unable to find topic file: "'.concat(t.requestFileName,'"')))}));return v[t.mixedCase]=n,n};function O(t){return function(e){var n;e.preventDefault();var r=e.metaKey||e.ctrlKey;return r||e.altKey||!t.isSelected?r||e.altKey||t.isSelected?!r&&e.altKey?(n=_.forSegment(t.targetTopic,t.targetSubtopic),J(n,null,{scrollStyle:"auto"})):r&&!e.altKey?(n=_.forSegment(t.targetTopic,t.targetSubtopic),window.open(location.origin+n.string,"_blank")):r&&e.altKey?(n=t.path,window.open(location.origin+n.string,"_blank")):void 0:(n=t.path,J(n,t)):(n=t.enclosingParagraph.path,J(n))}}var I=function t(e){e.display(),e.isPageRoot||(e.parentLink&&e.parentLinks.forEach((function(t){return t.open()})),e.ancestorImportReferences.forEach((function(t){return t.open()})),t(e.parentParagraph))};const D=function(t,e,n){var r,a,i;if(n=n||{},!t.paragraph)return function(t,e){if(console.error("No section element found for path: ",t.string),t.length>1)return console.log("Trying: ",t.withoutLastSegment.string),D(t.withoutLastSegment);if(e.defaultRedirect)throw new Error("Redirect to default topic failed terminally.");return console.error("No path prefixes remain to try. Redirecting to default topic: "+_.default),J(_.default,null,{defaultRedirect:!0})}(t,n);try{var o;null===(o=e)||void 0===o||o.element}catch(e){return J(t,null,n)}if(t.paragraph.pageRoot||e||(e=t.paragraph.parentLink),null!==(r=e)&&void 0!==r&&r.contradicts(t))return J(e.path,e,n);M(),_.setPath((null===(a=e)||void 0===a?void 0:a.path)||t),i=t.rootTopicPath.topic,document.querySelector('h1[data-topic-name="'.concat(i.escapedMixedCase,'"]')).style.display="block",document.title=t.rootTopicPath.paragraph.topic.mixedCase,S.select(e),I(t.paragraph),t.paragraph.select(),F(e,n)};function j(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var M=function(){Array.from(document.querySelectorAll("#_canopy h1")).forEach((function(t){t.style.display="none"})),Array.from(document.getElementsByTagName("a")).forEach((function(t){t.classList.remove("canopy-selected-link"),t.classList.remove("canopy-open-link")})),Array.from(document.getElementsByTagName("section")).forEach((function(t){t.style.display="none"})),Array.from(document.querySelectorAll(".canopy-selected-section")).forEach((function(t){t.classList.remove("canopy-selected-section")}))};function F(t,e){var n=e.scrollStyle||"smooth",r=((null==t?void 0:t.element.offsetTop)||0)+((null==t?void 0:t.element.offsetHeight)||0)-.3*window.innerHeight;q()?Math.abs(window.scrollY-r)>35&&window.scrollTo({top:r,behavior:n}):g.dataset.imageLoadScrollBehavior=n}function q(){return(t=document.querySelectorAll(".canopy-image img, .canopy-raw-html img"),function(t){if(Array.isArray(t))return j(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return j(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).every((function(t){return t.complete}));var t}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function R(t,e){if("text"===t.type)return function(t){var e=document.createElement("SPAN");return e.innerText=t.text,e}(t);if("local"===t.type)return function(t,e){return(0,e.localLinkSubtreeCallback)(t),function(t,e){var n,r=document.createElement("a");r.classList.add("canopy-selectable-link"),r.dataset.targetTopic=t.targetTopic,r.dataset.targetSubtopic=t.targetSubtopic,r.dataset.enclosingTopic=t.enclosingTopic,r.dataset.enclosingSubtopic=t.enclosingSubtopic,r.dataset.text=t.text,t.tokens.forEach((function(t){var n=R(t,e);r.appendChild(n)})),r.addEventListener("click",(t.targetTopic,t.targetSubtopic,n=new S(r),function(t){var e;t.preventDefault();var r,a=t.metaKey||t.ctrlKey;if(a&&!t.altKey)return window.open(location.origin+n.targetPath.lastSegment.string,"_blank");if(a&&t.altKey)return window.open(location.origin+n.targetPath.string,"_blank");if(!a&&t.altKey){var i=n.targetPath.lastSegment;return J(i,n.atNewPath(i))}return a||t.altKey||!n.isSelected?a||t.altKey||n.isSelected?void 0:(e=n.path,J(e,n)):(e=(null===(r=n.parentLink)||void 0===r?void 0:r.path)||_.current.rootTopicPath,J(e))})),r.classList.add("canopy-local-link"),r.dataset.type="local";var a=new(C())(t.targetTopic),i=new(C())(t.targetSubtopic);return r.href="".concat(m?"/"+m:"").concat(y?"/#":"","/").concat(a.slug,"#").concat(i.slug),r}(t,e)}(t,e);if("global"===t.type)return function(t,e){e.pathArray;var n=e.globalLinkSubtreeCallback,r=function(t,e){var n=document.createElement("a");t.tokens.forEach((function(t){var r=R(t,e);n.appendChild(r)})),n.classList.add("canopy-global-link"),n.classList.add("canopy-selectable-link"),n.dataset.type="global",n.dataset.targetTopic=t.targetTopic,n.dataset.targetSubtopic=t.targetSubtopic,n.dataset.enclosingTopic=t.enclosingTopic,n.dataset.enclosingSubtopic=t.enclosingSubtopic,n.dataset.text=t.text;var r=C().fromMixedCase(t.targetTopic);return n.href="".concat(m?"/"+m:"").concat(y?"/#":"","/").concat(r.slug),n.addEventListener("click",O(new S(n))),n}(t,e);return n(t,r),r}(t,e);if("import"===t.type)return function(t,e){return e.pathArray,function(t,e){var n=document.createElement("a");t.tokens.forEach((function(t){var r=R(t,e);n.appendChild(r)})),n.classList.add("canopy-global-link"),n.classList.add("canopy-selectable-link"),n.dataset.type="import",n.dataset.targetTopic=t.targetTopic,n.dataset.targetSubtopic=t.targetSubtopic,n.dataset.enclosingTopic=t.enclosingTopic,n.dataset.enclosingSubtopic=t.enclosingSubtopic,n.dataset.text=t.text;var r=new(C())(t.targetTopic),a=new(C())(t.targetSubtopic);return n.href="".concat(m?"/"+m:"").concat(y?"/#":"","/").concat(r.slug,"#").concat(a.slug),n.addEventListener("click",O(new S(n))),n}(t,e)}(t,e);if("url"===t.type)return function(t,e){var n=document.createElement("A");n.classList.add("canopy-url-link"),n.classList.add("canopy-selectable-link"),n.dataset.type="url",n.dataset.text=t.text,n.setAttribute("href",t.url),n.setAttribute("target","_blank");var r=document.createElement("SPAN");r.classList.add("canopy-url-link-tokens-container"),n.appendChild(r),t.tokens.forEach((function(t){var n=R(t,e);r.appendChild(n)})),r.innerHTML+='<span class="canopy-url-link-tokens-spacing">&nbsp;&nbsp;</span>';var a=document.createElement("SPAN");return a.classList.add("canopy-url-link-svg-container"),a.innerHTML+='<svg xmlns:svg="http://www.w3.org/2000/svg"\n   xmlns="http://www.w3.org/2000/svg"\n   version="1.0"\n   width="12"\n   height="12"\n   id="svg2">\n  <defs id="defs4"></defs>\n  <rect\n     width="5.9999995"\n     height="6"\n     x="1.5"\n     y="4.5"\n     id="rect3170"\n     style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:#0066cc;stroke-width:0.99999994;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"></rect>\n  <path\n     d="M 4,2.5 L 5,3.5 L 5.25,4.25 L 2.75,6.5 L 5.5,9.25 L 7.75,6.75 L 8.5,7 L 9.5,8 L 11,6.5 L 11,1 L 5.5,1 L 4,2.5 z"\n     id="path2395"\n     style="fill:#0066ff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"></path>\n  <path\n     d="M 6,2 L 10,2 L 10,6 L 9.5,6.75 L 8.25,4.75 L 5.25,8 L 4,6.75 L 7.25,3.75 L 5.25,2.5 L 6,2 z"\n     id="path2398"\n     style="fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" ></path>\n</svg>\n'.replace(/\r?\n|\r/g,""),n.appendChild(a),n.innerHTML+='<span class="canopy-url-link-svg-spacing">&nbsp;</span>',n}(t,e);if("image"===t.type)return function(t,e){var n=document.createElement("DIV");n.classList.add("canopy-image");var r=document.createElement("IMG");r.setAttribute("src",t.resourceUrl);var a=document.createElement("A");if(a.setAttribute("href",t.anchorUrl||t.resourceUrl),a.setAttribute("target","_blank"),a.classList.add("canopy-image-anchor"),a.appendChild(r),n.appendChild(a),t.title&&r.setAttribute("title",t.title),t.caption){var i=document.createElement("SPAN");i.classList.add("canopy-image-caption"),n.appendChild(i),t.tokens.forEach((function(t){var n=R(t,e);i.appendChild(n)}))}else n.appendChild(a);return t.altText&&r.setAttribute("alt",t.altText),r.addEventListener("load",(function(){g.dataset.imageLoadScrollBehavior||console.error("Image-load-initiated scroll behavior not stored"),q()&&F(S.selection,{scrollStyle:g.dataset.imageLoadScrollBehavior})})),n}(t,e);if("html_element"===t.type)return function(t){var e,n=document.createElement("DIV"),r=document.createRange().createContextualFragment(t.html);return n.appendChild(r),n.classList.add("canopy-raw-html"),(e=n.querySelectorAll("img"),function(t){if(Array.isArray(t))return G(t)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(t,e){if(t){if("string"==typeof t)return G(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(t,e):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).forEach((function(t){t.addEventListener("load",(function(){g.dataset.imageLoadScrollBehavior||console.error("Image-load-initiated scroll behavior not stored"),q()&&F(S.selection,{scrollStyle:g.dataset.imageLoadScrollBehavior})}))})),n}(t);if("footnote_marker"===t.type)return function(t){var e=document.createElement("SUP"),n=document.createTextNode(t.text);return e.appendChild(n),e}(t);if("code_block"===t.type)return function(t){var e=document.createElement("PRE"),n=document.createElement("CODE");return e.appendChild(n),n.innerText=t.text,e}(t);if("block_quote"===t.type)return function(t,e){var n=document.createElement("BLOCKQUOTE");return n.setAttribute("dir",t.direction),t.tokens.forEach((function(t){var r=R(t,e);n.appendChild(r)})),n}(t,e);if("outline"===t.type)return U(t.topLevelNodes,e);if("table"===t.type)return function(t,e){var n=document.createElement("TABLE");return n.setAttribute("dir","auto"),t.rows.forEach((function(t){var r=document.createElement("TR");t.forEach((function(t){var n=document.createElement("TD");t.forEach((function(t){var r=R(t,e);n.appendChild(r)})),r.appendChild(n)})),n.appendChild(r)})),n}(t,e);if("footnote_lines"===t.type)return function(t,e){var n=document.createElement("DIV"),r=document.createElement("HR");return r.classList.add("canopy-footnote-rule"),n.appendChild(r),t.lines.forEach((function(t){var r=document.createElement("SPAN");r.classList.add("canopy-footnote-span");var a=document.createTextNode(t.superscript+". ");r.appendChild(a),t.tokens.forEach((function(t){var n=R(t,e);r.appendChild(n)})),n.appendChild(r)})),n}(t,e);if("bold"===t.type)return function(t,e){var n=document.createElement("B");return t.tokens.forEach((function(t){var r=R(t,e);n.appendChild(r)})),n}(t,e);if("strikethrough"===t.type)return function(t,e){var n=document.createElement("S");return t.tokens.forEach((function(t){var r=R(t,e);n.appendChild(r)})),n}(t,e);if("italics"===t.type)return function(t,e){var n=document.createElement("I");return t.tokens.forEach((function(t){var r=R(t,e);n.appendChild(r)})),n}(t,e);if("inline_code"===t.type)return function(t,e){var n=document.createElement("CODE");return n.innerText=t.text,n}(t);throw"Unhandled token type: ".concat(t.type)}function U(t,e){var n=t[0].ordered?document.createElement("OL"):document.createElement("UL");return t[0].ordered&&n.setAttribute("type",t[0].ordinal),t.forEach((function(t){var r=document.createElement("LI");if(t.tokensOfLine.forEach((function(t){var n=R(t,e);r.appendChild(n)})),t.children.length>0){var a=U(t.children);r.appendChild(a)}n.appendChild(r)})),n}const K=R;const z=function t(e){var n=e.subtopic,r=e.paragraphsBySubtopic,a=function(t){var e=t.topic,n=t.subtopic,r=t.displayTopicName,a=t.pathDepth,i=document.createElement("section");i.classList.add("canopy-section");var o=document.createElement("p");return o.classList.add("canopy-paragraph"),i.appendChild(o),i.style.display="none",i.dataset.displayTopicName=r,i.dataset.topicName=e.mixedCase,i.dataset.subtopicName=n.mixedCase,i.dataset.pathDepth=a,e.mixedCase===n.mixedCase&&(a>0&&i.prepend(document.createElement("hr")),i.classList.add("canopy-topic-section")),i}(e),i=new L(a);e.displayBlockingPromises=[],e.localLinkSubtreeCallback=function(e,n){return function(r){var a=t(Object.assign({},n,{subtopic:C().fromMixedCase(r.targetSubtopic)}));a.then((function(t){e.appendChild(t)})),n.displayBlockingPromises.push(a)}}(a,e),e.globalLinkSubtreeCallback=function(t,e){var n=e.pathToDisplay,r=e.subtopic,a=e.displayBlockingPromises;return function(e,i){var o=C().fromMixedCase(e.targetTopic),c=new S(i);if(N(o),function(t,e,n){var r=e.firstSubtopic,a=e.secondTopic,i=e.secondTopic,o=i,c=t.targetTopic.mixedCase===(null==i?void 0:i.mixedCase)&&t.targetSubtopic.mixedCase===(null==o?void 0:o.mixedCase),l=n.mixedCase===r.mixedCase;return a&&c&&l}(c,n,r)){var l=n.withoutFirstSegment,s=H(l,t);a.push(s)}}}(a,e);var o=r[n.mixedCase];if(!o)throw new Error("Paragraph with subtopic not found: ".concat(n.mixedCase));return o.forEach((function(t){var n=K(t,e);i.paragraphElement.appendChild(n)})),Promise.all(e.displayBlockingPromises).then((function(){return a}))};function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const H=function t(e,n){if(0===e.length)return Promise.resolve(null);var r=_.elementAtRelativePath(e.firstSegment,n);return r?_.connectingLinkValid(n,e)?t(e.withoutFirstSegment,r):Promise.resolve():N(e.firstTopic).then((function(t){var r=t.paragraphsBySubtopic,a=t.displayTopicName,i=t.topicTokens,o=n===g?Promise.resolve(function(t,e){var n=new(C())(e),r=document.createElement("h1");return r.dataset.topicName=n.mixedCase,t.forEach((function(t){var e=K(t);r.appendChild(e)})),r}(i,a)):null,c=z({topic:e.firstTopic,subtopic:e.firstTopic,pathToDisplay:e,displayTopicName:a,paragraphsBySubtopic:r,pathDepth:Number(n.dataset.pathDepth)+1||0});return Promise.all([c,o])})).then((function(t){var e,r,a=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,a,i=[],o=!0,c=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(i.push(r.value),!e||i.length!==e);o=!0);}catch(t){c=!0,a=t}finally{try{o||null==n.return||n.return()}finally{if(c)throw a}}return i}}(e,r)||function(t,e){if(t){if("string"==typeof t)return W(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],o=a[1];o&&g.prepend(o),n.appendChild(i)}))},J=function(t,e,n){return function(t,e){if(!(t instanceof _))throw new Error("Invalid path argument");if(e&&!(e instanceof S))throw new Error("Invalid link selection argument")}(t,e),t.empty&&(t=_.default),H(t,g).catch((function(t){return console.error(t)})).then((function(){D(t,e,n)})).catch((function(t){return console.error(t)}))};function $(){var t=S.selection;return t.enclosingParagraph.equals(L.pageRoot)?J(t.enclosingParagraph.path):J(t.parentLink.path,new S((function(){return S.lastSelectionOfParagraph(t.parentLink.enclosingParagraph)||t.parentLink})))}function V(){var t=S.selection,e=S.lastSelectionOfParagraph(t.enclosingParagraph.topicParagraph.parentParagraph)||t.enclosingParagraph.topicParagraph.parentLink;return J((null==e?void 0:e.path)||_.current,e||t)}function Z(){var t=S.selection;if(t.isImport&&J(t.path,t.targetParagraph.parentLink),t.isGlobal||t.isLocal){var e,n,r=(null===(e=t.targetParagraph)||void 0===e?void 0:e.firstLink)||(null===(n=t.targetParagraph)||void 0===n?void 0:n.parentLink);J(r.path,new S((function(){return S.lastSelectionOfParagraph(r.enclosingParagraph)||r})))}t.isParent||J(t.path,t)}function Q(){var t=S.selection.previousSibling||S.selection.lastSibling;return J(t.path,t)}function Y(){var t=S.selection.nextSibling||S.selection.firstSibling;return J(t.path,t)}function X(t){var e=t.newTab;if(t.altKey,S.selection.isLocal){var n,r,a=(null===(n=S.selection.targetParagraph)||void 0===n?void 0:n.firstLink)||(null===(r=S.selection.targetParagraph)||void 0===r?void 0:r.parentLink),i=a.path;return e?window.open(location.origin+S.selection.targetPath.lastSegment,"_blank"):J(i,a)}if(S.selection.isGlobal){if(e){var o=S.selection.targetPath.lastSegment;return window.open(location.origin+o.string,"_blank")}if(!e){var c=S.selection.targetPath.lastSegment;return J(c,null,{scrollStyle:"auto"})}}if(S.selection.isImport){var l=S.selection.targetPath.lastSegment;return e?window.open(location.origin+l.string,"_blank"):J(l,S.selection.parentLink.atNewPath(l),{scrollStyle:"auto"})}if("url"===S.selection.type)return window.open(S.selection.element.href,"_blank")}var tt={left:Q,up:$,down:Z,right:Y,h:Q,j:Z,k:$,l:Y,escape:function(){return J(_.current.rootTopicPath)},z:function(){var t=S.selection,e=t.localPathSegmentWhenSelected,n=t.atNewPath(e);return J(e,n,{scrollStyle:"auto"})},d:function(){return window.open(window.location.href,"_blank")},"shift-up":V,"shift-k":V,enter:function(){return X({})},"meta-enter":function(){return X({newTab:!0})},"ctrl-enter":function(){return X({newTab:!0})},"alt-enter":function(){return X({newTab:!1,altKey:!0})},"meta-alt-enter":function(){return X({newTab:!0,altKey:!0})},"ctrl-alt-enter":function(){return X({newTab:!0,altKey:!0})},tab:function(){var t=S.selection;if(t.isLocal&&t.hasChildren){var e=t.firstChildLink||t.nextSibling||t;return J(e.path,e)}if(t.isGlobalOrImport){var n,r=t.nextSibling||(null===(n=t.parentLink)||void 0===n?void 0:n.nextSibling)||t.enclosingParagraph.firstLink;return J(r.enclosingParagraph.path,r)}if(t.nextSibling&&!t.nextSibling.equals(t))return J(t.nextSibling.enclosingParagraph.path,t.nextSibling);if(t.lastSibling.equals(t)){var a=function t(e){return e.parentLink&&e.parentLink.isLocal?e.parentLink.nextSibling?e.parentLink.nextSibling:t(e.parentLink):e.firstSibling}(t);return J(a.path,a)}}},et={37:"left",39:"right",38:"up",40:"down",71:"g",72:"h",75:"k",74:"j",76:"l",186:";",90:"z",68:"d",13:"enter",9:"tab",27:"escape",192:"`",49:"1",50:"2",51:"3",52:"4",53:"5"};window.addEventListener("keydown",(function(t){if("INPUT"!==document.activeElement.tagName){var e=(t.metaKey?"meta-":"")+(t.ctrlKey?"ctrl-":"")+(t.altKey?"alt-":"")+(t.shiftKey?"shift-":""),n=et[t.keyCode],r=e+n;["tab","down","up","left","right"].includes(n)&&t.preventDefault(),S.selection?(tt[r]||function(){})():tt[r]&&J(_.current,S.selectALink())}})),"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.addEventListener("popstate",(function(t){var e,n=S.selectionPresentInEvent(t)?new S(t.state):null;e=L.current.path.rootTopicPath.equals(_.current.rootTopicPath)?"smooth":"auto",J(_.currentOrDefault,n||S.sessionSelection,{scrollStyle:e})})),J(_.currentOrDefault,S.priorSelection,{scrollStyle:"auto"})})()})();
//# sourceMappingURL=_canopy.js.map
(()=>{var t={417:t=>{t.exports=function t(e){var n=e.replace(/(^|(?:.?[^\S])+)([_`*~])((?:.*?\S))\2(\W+|$)/,"$1$3$4");return n!==e?t(n):e}},333:(t,e,n)=>{function a(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function i(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var r=n(417),o=i((function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.display=e,this.mixedCase=r(e).replace(/\\/g,""),this.slug=this.mixedCase.replace(/ /g,"_"),this.encodedSlug=this.slug.replace(/%/g,"%25").replace(/#/g,"%23"),this.caps=this.mixedCase.toUpperCase().replace(/\?$/,"").replace(/"/g,"").replace(/'/g,"").replace(/_/g," "),this.fileName=this.slug.replace(/\\/g,""),this.requestFileName=encodeURIComponent(this.slug),n&&(this.display=null,this.mixedCase=null)}));t.exports=o},570:(t,e,n)=>{"use strict";n.d(e,{Z:()=>c});var a=n(537),i=n.n(a),r=n(645),o=n.n(r)()(i());o.push([t.id,"#_canopy{padding-top:15px;padding-bottom:55px}#_canopy h1{text-align:center;margin:auto;width:40%;margin-top:10px}#_canopy hr{width:9%;display:block;height:1px;border:0;border-top:5px solid #ccc;margin:0px auto;padding-bottom:30px}#_canopy section.canopy-topic-section{padding-top:40px}#_canopy section.canopy-selected-section{padding-bottom:60vh}#_canopy section{padding-top:30px}#_canopy p{overflow:hidden;font-size:22px;max-width:700px;margin:auto;line-height:1.3;letter-spacing:-0.003em;font-weight:400}#_canopy a.canopy-selectable-link{text-decoration:underline #ddd;color:#000;cursor:pointer}#_canopy a.canopy-selectable-link:hover{text-decoration:underline}#_canopy a.canopy-selectable-link:focus{outline:0}#_canopy a.canopy-selectable-link.canopy-open-link{text-shadow:.8px 0px 0px #000;text-decoration:underline}#_canopy a.canopy-selectable-link.canopy-selected-link{background-color:#edeefc;text-shadow:0px 0px 0px #000;text-decoration:none}#_canopy a.canopy-selectable-link.canopy-selected-link:hover{text-decoration:underline}#_canopy span.canopy-text-span{display:block}#_canopy hr.canopy-footnote-rule{width:700px;display:block;height:1px;border:0;border-top:1px solid #ccc;margin:12px 0;padding:0}#_canopy sup{font-size:60%;padding:2px}#_canopy .canopy-footnote-span{font-size:80%}#_canopy blockquote{margin:7px 10px;background-color:#eff0f1;padding:5px;font-size:90%}#_canopy blockquote a.canopy-selectable-link{text-decoration:underline #d3d3d3}#_canopy pre{margin:7px 10px;background-color:#eff0f1;padding:5px;font-size:85%}#_canopy code{background-color:#eff0f1;font-size:90%}#_canopy table{margin:7px auto;table-layout:fixed;width:70%;border-collapse:collapse;border:2px solid #000}#_canopy table td,#_canopy table th{border:2px solid #000;text-align:center;padding:6px}#_canopy .canopy-image{width:220px;max-height:250px}#_canopy div.canopy-image-div{float:right;border:1px solid #c8ccd1;padding:3px;background-color:#f8f9fa;font-size:94%;text-align:center;overflow:hidden;margin:10px}#_canopy div.canopy-image-div>sup{display:block}#_canopy .canopy-url-link-span>svg{height:15px;width:12px;display:none}#_canopy .canopy-selected-link+svg,#_canopy .canopy-url-link-span:hover>svg{display:inline;vertical-align:middle}#_canopy ol,#_canopy ul{margin:7px 10px}#_canopy div.canopy-raw-html{display:inline}#_canopy>section.canopy-topic-section{padding-top:30px}","",{version:3,sources:["webpack://./client/style/canopy.scss"],names:[],mappings:"AAAA,SACE,gBAAA,CACA,mBAAA,CAEA,YACE,iBAAA,CACA,WAAA,CACA,SAAA,CACA,eAAA,CAGF,YACE,QAAA,CACA,aAAA,CACA,UAAA,CACA,QAAA,CACA,yBAAA,CACA,eAAA,CACA,mBAAA,CAGF,sCACE,gBAAA,CAGF,yCAME,mBAAA,CAGF,iBACE,gBAAA,CAGF,WACE,eAAA,CACA,cAAA,CACA,eAAA,CACA,WAAA,CAEA,eAAA,CACA,uBAAA,CACA,eAAA,CAKF,kCACE,8BAAA,CACA,UAAA,CACA,cAAA,CAEA,wCACE,yBAAA,CAGF,wCACE,SAAA,CAGF,mDACE,6BAAA,CACA,yBAAA,CAGF,uDACE,wBAAA,CACA,4BAAA,CACA,oBAAA,CAEA,6DACE,yBAAA,CAiBN,+BACE,aAAA,CAGF,iCACE,WAAA,CACA,aAAA,CACA,UAAA,CACA,QAAA,CACA,yBAAA,CACA,aAAA,CACA,SAAA,CAGF,aACE,aAAA,CACA,WAAA,CAGF,+BACE,aAAA,CAGF,oBACE,eAAA,CACA,wBAAA,CACA,WAAA,CACA,aAAA,CAEA,6CACE,iCAAA,CAIJ,aACE,eAAA,CACA,wBAAA,CACA,WAAA,CACA,aAAA,CAGF,cACE,wBAAA,CACA,aAAA,CAGF,eACE,eAAA,CACA,kBAAA,CACA,SAAA,CACA,wBAAA,CACA,qBAAA,CAEA,oCACE,qBAAA,CACA,iBAAA,CACA,WAAA,CAIJ,uBACE,WAAA,CACA,gBAAA,CAGF,8BACE,WAAA,CACA,wBAAA,CACA,WAAA,CACA,wBAAA,CACA,aAAA,CACA,iBAAA,CACA,eAAA,CACA,WAAA,CAGF,kCACE,aAAA,CAGF,mCACE,WAAA,CACA,UAAA,CACA,YAAA,CAGF,4EACE,cAAA,CACA,qBAAA,CAGF,wBACE,eAAA,CAGF,6BACE,cAAA,CAIJ,sCACE,gBAAA",sourcesContent:["#_canopy {\n  padding-top: 15px;\n  padding-bottom: 55px;\n\n  h1 {\n    text-align: center;\n    margin: auto;\n    width: 40%;\n    margin-top: 10px;\n  }\n\n  hr {\n    width: 9%;\n    display: block;\n    height: 1px;\n    border: 0;\n    border-top: 5px solid #ccc;\n    margin: 0px auto;\n    padding-bottom: 30px;\n  }\n\n  section.canopy-topic-section {\n    padding-top: 40px;\n  }\n\n  section.canopy-selected-section {\n    /* Removing DOM elements from the bottom of the screen can force the page to scroll upward to the existing elements\n    which is not animated. If we keep a padding on the bottom of the last element just beyond the viewport, then\n    removal of elements from the bottom of the visible stack never brings the real bottom of the page into view, and so\n    the scroll upwards can be animated using the window.scrollTo method. */\n\n    padding-bottom: calc(60vh);\n  }\n\n  section {\n    padding-top: 30px;\n  }\n\n  p {\n    overflow: hidden;\n    font-size: 22px;\n    max-width: 700px;\n    margin: auto;\n\n    line-height: 1.3;\n    letter-spacing: -.003em;\n    font-weight: 400;\n  }\n\n///////////// Link styles /////////////////\n\n  a.canopy-selectable-link {\n    text-decoration: underline #DDDDDD;\n    color: black;\n    cursor: pointer;\n\n    &:hover {\n      text-decoration: underline;\n    }\n\n    &:focus {\n      outline:0;\n    }\n\n    &.canopy-open-link {\n      text-shadow: .8px 0px 0px #000000;\n      text-decoration: underline;\n    }\n\n    &.canopy-selected-link {\n      background-color: #edeefc;\n      text-shadow: 0px 0px 0px #000000;\n      text-decoration: none;\n\n      &:hover {\n        text-decoration: underline;\n      }\n    }\n\n    /*\n    &.canopy-dfs-previously-selected-link {\n      color: #ff0000 !important;\n    }\n\n    &.canopy-reverse-dfs-previously-selected-link {\n      color: #0000ff !important;\n    }\n    */\n  }\n\n/////////////////////////////////////////////\n\n  span.canopy-text-span {\n    display: block;\n  }\n\n  hr.canopy-footnote-rule {\n    width: 700px;\n    display: block;\n    height: 1px;\n    border: 0;\n    border-top: 1px solid #ccc;\n    margin: 12px 0;\n    padding: 0;\n  }\n\n  sup {\n    font-size: 60%;\n    padding: 2px;\n  }\n\n  .canopy-footnote-span {\n    font-size: 80%;\n  }\n\n  blockquote {\n    margin: 7px 10px;\n    background-color: #eff0f1;\n    padding: 5px;\n    font-size: 90%;\n\n    a.canopy-selectable-link {\n      text-decoration: underline #D3D3D3;\n    }\n  }\n\n  pre {\n    margin: 7px 10px;\n    background-color: #eff0f1;\n    padding: 5px;\n    font-size: 85%;\n  }\n\n  code {\n    background-color: #eff0f1;\n    font-size: 90%;\n  }\n\n  table {\n    margin: 7px auto;\n    table-layout: fixed;\n    width: 70%;\n    border-collapse: collapse;\n    border: 2px solid black;\n\n    td, th {\n      border: 2px solid black;\n      text-align: center;\n      padding: 6px;\n    }\n  }\n\n  .canopy-image {\n    width: 220px;\n    max-height: 250px;\n  }\n\n  div.canopy-image-div {\n    float: right;\n    border: 1px solid #c8ccd1;\n    padding: 3px;\n    background-color: #f8f9fa;\n    font-size: 94%;\n    text-align: center;\n    overflow: hidden;\n    margin: 10px;\n  }\n\n  div.canopy-image-div > sup {\n    display: block;\n  }\n\n  .canopy-url-link-span > svg {\n    height: 15px;\n    width: 12px;\n    display: none;\n  }\n\n  .canopy-selected-link + svg, .canopy-url-link-span:hover > svg {\n    display: inline;\n    vertical-align: middle;\n  }\n\n  ol, ul {\n    margin: 7px 10px;\n  }\n\n  div.canopy-raw-html {\n    display: inline;\n  }\n}\n\n#_canopy > section.canopy-topic-section {\n  padding-top: 30px;\n}\n"],sourceRoot:""}]);const c=o},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",a=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),a&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),a&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,a,i,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(a)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(o[s]=!0)}for(var l=0;l<t.length;l++){var p=[].concat(t[l]);a&&o[p[0]]||(void 0!==r&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=r),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),i&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=i):p[4]="".concat(i)),e.push(p))}},e}},537:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),r="/*# ".concat(i," */"),o=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(o).concat([r]).join("\n")}return[e].join("\n")}},379:t=>{"use strict";var e=[];function n(t){for(var n=-1,a=0;a<e.length;a++)if(e[a].identifier===t){n=a;break}return n}function a(t,a){for(var r={},o=[],c=0;c<t.length;c++){var s=t[c],l=a.base?s[0]+a.base:s[0],p=r[l]||0,u="".concat(l," ").concat(p);r[l]=p+1;var h=n(u),d={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==h)e[h].references++,e[h].updater(d);else{var f=i(d,a);a.byIndex=c,e.splice(c,0,{identifier:u,updater:f,references:1})}o.push(u)}return o}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var r=a(t=t||[],i=i||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var c=n(r[o]);e[c].references--}for(var s=a(t,i),l=0;l<r.length;l++){var p=n(r[l]);0===e[p].references&&(e[p].updater(),e.splice(p,1))}r=s}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var a=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,i&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(a,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={id:a,exports:{}};return t[a](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{"use strict";var t=n(379),e=n.n(t),a=n(795),i=n.n(a),r=n(569),o=n.n(r),c=n(565),s=n.n(c),l=n(216),p=n.n(l),u=n(589),h=n.n(u),d=n(570),f={};f.styleTagTransform=h(),f.setAttributes=s(),f.insert=o().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=p(),e()(d.Z,f),d.Z&&d.Z.locals&&d.Z.locals;var g=document.getElementById("_canopy"),y=g&&g.dataset.defaultTopic,m=g&&g.dataset.projectPathPrefix,A=g&&g.dataset.hashUrls;function k(t,e){for(var n=t.parentElement;n.classList&&!n.classList.contains(e);){if(n===g)return null;n=n.parentNode}return n}const v={};var b=n(333),C=n.n(b);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function S(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}const x=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"A"===e.tagName)this.element=e;else{if(e instanceof t)throw"Cannot instantiate link from link";if("object"===w(e))this.metadataObject=e;else{if("function"!=typeof e)throw"Invalid argument to Link constructor";this.selectorCallback=e}}}var e,n,a;return e=t,a=[{key:"collectMetadata",value:function(e){var n=new t(e);return{pathString:L.containingLink(n).path.string,text:e.dataset.text,relativeLinkNumber:n.relativeLinkNumber}}},{key:"containsLinkSelectionMetadata",value:function(t){return void 0!==t.relativeLinkNumber}},{key:"elementFromMetadata",value:function(t){var e=new _(t.pathString).paragraph;if(!e)throw"Link selection data refers to non-existant link";var n=e.linkBySelector((function(e,n){return e.element.dataset.text===t.text&&n===t.relativeLinkNumber}));return n&&n.element||null}},{key:"select",value:function(e){e&&e.element.classList.add("canopy-selected-link"),t.persistInHistory(e),t.persistInSession(e)}},{key:"selectionPresentInEvent",value:function(e){return e.state&&t.containsLinkSelectionMetadata(e.state)}},{key:"sessionSelection",get:function(){var e=sessionStorage.getItem(_.current.string);return e&&"null"!==e?new t(JSON.parse(e)):null}},{key:"historySelection",get:function(){return history.state&&t.containsLinkSelectionMetadata(history.state)?new t(history.state):null}},{key:"priorSelection",get:function(){return this.historySelection||this.sessionSelection||null}},{key:"selection",get:function(){var e=document.querySelector("a.canopy-selected-link");return e?new t(e):null}},{key:"persistInSession",value:function(t){var e=t&&JSON.stringify(t.metadata);sessionStorage.setItem(location.pathname+location.hash,e||null)}},{key:"persistInHistory",value:function(t){history.replaceState(t&&t.metadata||null,document.title,window.location.href)}},{key:"selectALink",value:function(e){return new t((function(){var t=(e=e||_.current).paragraph;return t.firstLink||t.parentLink}))}},{key:"current",value:function(){throw"Link#current does not exist, try Link#selection"}}],(n=[{key:"equals",value:function(t){return this.element===t.element}},{key:"matches",value:function(t){if(!t)throw"Invalid link argument to Link#matches";return this.targetTopic===t.targetTopic&&this.targetSubtopic===t.targetSubtopic&&this.relativeLinkNumber===t.relativeLinkNumber}},{key:"contradicts",value:function(t){if(!(t instanceof _))throw"Invalid path argument to Link#contradicts";return this.paragraphPathWhenSelected.string!==t.string}},{key:"element",get:function(){if(this.linkElement)return this.linkElement;if(this.metadataObject)return this.element=t.elementFromMetadata(this.metadata),this.linkElement;if(this.selectorCallback){var e=this.selectorCallback();if(!e)throw"Link selector callback provided no link";return this.element=e.element,this.linkElement}},set:function(e){e instanceof HTMLAnchorElement?this.linkElement=e:e instanceof t&&(this.linkElement=e.element),this.transferDataset()}},{key:"transferDataset",value:function(){this.linkElement&&(this._targetTopic=this.linkElement.dataset.targetTopic,this._targetSubtopic=this.linkElement.dataset.targetSubtopic,this._enclosingTopic=this.linkElement.dataset.enclosingTopic,this._enclosingSubtopic=this.linkElement.dataset.enclosingSubtopic,this._typeValue=this.linkElement.dataset.type)}},{key:"targetTopic",get:function(){return new(C())(this.element.dataset.targetTopic)}},{key:"targetSubtopic",get:function(){return new(C())(this.element.dataset.targetSubtopic)}},{key:"enclosingTopic",get:function(){return new(C())(this.element.dataset.enclosingTopic)}},{key:"enclosingSubtopic",get:function(){return new(C())(this.element.dataset.enclosingSubtopic)}},{key:"topicName",get:function(){throw"Links have no topicName, only targetTopic or enclosingTopic"}},{key:"subtopicName",get:function(){throw"Links have no subtopicName, only targetSubtopic or enclosingSubtopic"}},{key:"type",get:function(){return this.element.dataset.type}},{key:"enclosingSectionElement",get:function(){return k(this.element,"canopy-section")}},{key:"sectionElement",get:function(){throw"Depreciated in favor of #enclosingSectionElement"}},{key:"enclosingParagraphElement",get:function(){return k(this.element,"canopy-paragraph")}},{key:"parentParagraphElement",get:function(){throw"Depreciated in favor of #enclosingParagraphElement"}},{key:"enclosingParagraph",get:function(){return new L(this.enclosingSectionElement)}},{key:"targetParagraph",get:function(){if(!this.isParent)return null;var t=this.enclosingParagraph.pathDepth;this.isGlobalOrImport&&(t=Number(t)+1);var e=this.enclosingParagraph.sectionElement.querySelector('section[data-topic-name-caps="'.concat(this.targetTopic.caps,'"]')+'[data-subtopic-name-caps="'.concat(this.targetSubtopic.caps,'"]')+'[data-path-depth="'.concat(t,'"'));if(!e)throw"Did not find paragraph child element matching link [".concat(this.targetTopic,", ").concat(this.targetSubtopic,"]");return new L(e)}},{key:"atNewPath",value:function(e){var n=this;return new t((function(){return(n.isParent?e.paragraph.parentParagraph:e.paragraph).links.find(n.matcher)}))}},{key:"localPathWhenSelected",get:function(){return this.isGlobalOrImport?new _(this.paragraphPathWhenSelected.pathArray.slice(-2)):this.paragraphPathWhenSelected.lastSegment}},{key:"matcher",get:function(){var t=this;return function(e){return e.matches(t)}}},{key:"relativeLinkNumber",get:function(){return this.storedRelativeLinkNumber||(this.storedRelativeLinkNumber=this.enclosingParagraph.links.map((function(t){return t.element})).indexOf(this.element)),this.storedRelativeLinkNumber}},{key:"metadata",get:function(){if(this.metadataObject)return this.metadataObject;if(this.linkElement){var e=t.collectMetadata(this.linkElement);return this.metadataObject=e,e}if(this.selectorCallback)return this.element=this.selectorCallback(),this.metadata;throw"Link has neither supplied metadata, dom element, nor selector function"}},{key:"targetPath",get:function(){return this.isGlobalOrImport?this.enclosingParagraph.path.addSegment(this.targetTopic,this.targetSubtopic):this.isLocal?this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic):null}},{key:"path",get:function(){throw"Depreciated in favor of #paragraphPathWhenSelected"}},{key:"pathToDisplay",get:function(){throw"Depreciated in favor of #paragraphPathWhenSelected"}},{key:"paragraphPathWhenSelected",get:function(){return this.isGlobalOrImport?this.enclosingParagraph.path.addSegment(this.targetTopic,this.targetSubtopic):this.isLocal?this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic):this.enclosingParagraph.path}},{key:"urlPathWhenSelected",get:function(){return"import"===this.type?this.enclosingParagraph.path:this.paragraphPathWhenSelected}},{key:"nextSibling",get:function(){var t=this.enclosingParagraph.links;if(this.equals(t[t.length-1]))return null;var e=t.map((function(t){return t.element}));return t[e.indexOf(this.element)+1]}},{key:"previousSibling",get:function(){var t=this.enclosingParagraph.links;if(this.equals(t[0]))return null;var e=t.map((function(t){return t.element}));return t[e.indexOf(this.element)-1]}},{key:"siblings",get:function(){return this.enclosingParagraph.links}},{key:"firstSibling",get:function(){return this.siblings[0]}},{key:"lastSibling",get:function(){return this.siblings[this.siblings.length-1]}},{key:"firstChildLink",get:function(){return this.targetParagraph.firstLink}},{key:"lastChildLink",get:function(){return this.targetParagraph.lastLink}},{key:"parentLink",get:function(){return this.enclosingParagraph.parentLink}},{key:"grandParentLink",get:function(){var t;return null===(t=this.parentLink)||void 0===t?void 0:t.parentLink}},{key:"topicParagraph",get:function(){return k(this.element,"canopy-topic-section")}},{key:"selected",get:function(){return this.element.classList.includes("canopy-selected-link")}},{key:"open",value:function(){this.element.classList.add("canopy-open-link")}},{key:"isOpen",get:function(){return this.element.classList.contains("canopy-open-link")}},{key:"isClosed",get:function(){return!this.isOpen}},{key:"isSelected",get:function(){return this.element.classList.contains("canopy-selected-link")}},{key:"isGlobal",get:function(){return"global"===this.type}},{key:"isImport",get:function(){return"import"===this.type}},{key:"isGlobalOrImport",get:function(){return"global"===this.type||"import"===this.type}},{key:"isLocal",get:function(){return"local"===this.type}},{key:"isParent",get:function(){return this.isGlobal||this.isLocal||this.isImport}},{key:"hasChildren",get:function(){return this.targetParagraph.hasLinks}}])&&S(e.prototype,n),a&&S(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function E(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}const L=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e||"SECTION"!==e.tagName)throw"Paragraph instantiation requires section element";if(!e.classList.contains("canopy-section"))throw"Paragraph class requires Canopy section element";this.sectionElement=e,this.transferDataset()}var e,n,a;return e=t,a=[{key:"current",get:function(){return new t(document.querySelector("canopy-selected-section"))}},{key:"pageRoot",get:function(){return _.current.rootTopicPath.paragraph}},{key:"containingLink",value:function(e){if(!(e instanceof x))throw"Must provide link instance argument";return new t(k(e.element,"canopy-section"))}}],(n=[{key:"equals",value:function(t){return!!t&&this.sectionElement===t.sectionElement}},{key:"display",value:function(){this.sectionElement.style.display="block"}},{key:"element",get:function(){throw"Depreciated in favor of #sectionElement property"}},{key:"transferDataset",value:function(){this._topicName=this.sectionElement.dataset.displayTopicName,this._subtopicName=this.sectionElement.dataset.displaySubtopicName,this.pathDepth=this.sectionElement.dataset.pathDepth}},{key:"topic",get:function(){return new(C())(this.sectionElement.dataset.displayTopicName)}},{key:"subtopic",get:function(){return new(C())(this.sectionElement.dataset.displaySubtopicName)}},{key:"topicName",get:function(){throw console.trace(),"Depreciated in favor of #topic"}},{key:"subtopicName",get:function(){throw console.trace(),"Depreciated in favor of #subtopic"}},{key:"paragraphElement",get:function(){var t=Array.from(this.sectionElement.childNodes).find((function(t){return"P"===t.tagName}));if(!t)throw"Paragraph has no paragraph element";return t}},{key:"path",get:function(){for(var e=[],n=this.sectionElement,a=this,i=this.topicParagraph;n!==g;)for(i=a.topicParagraph,e.unshift([new(C())(n.dataset.displayTopicName),new(C())(n.dataset.displaySubtopicName)]);n!==g&&a.topicParagraph.equals(i);)(n=n.parentNode)!==g&&(a=new t(n));return new _(e)}},{key:"links",get:function(){if(this.linkObjects)return this.linkObjects;var t=this.paragraphElement.querySelectorAll("a.canopy-selectable-link");return this.linkObjects=Array.from(t).map((function(t){return new x(t)})),this.linkObjects}},{key:"firstLink",get:function(){return this.links[0]||null}},{key:"lastLink",get:function(){return this.links[this.links.length-1]||null}},{key:"isPageRoot",get:function(){return this.sectionElement.parentNode===g}},{key:"isTopic",get:function(){return this.topic.caps===this.subtopic.caps}},{key:"hasLinks",get:function(){return this.links.length>0}},{key:"linkBySelector",value:function(t){return this.links.find(t)}},{key:"linksBySelector",value:function(t){return this.links.filter(t)}},{key:"linkByTarget",value:function(t,e){return e=e||t,this.linkBySelector((function(n){return n.targetTopic.caps===t.caps&&n.targetSubtopic.caps===e.caps}))}},{key:"parentLink",get:function(){return this.sectionElement.parentNode===g?null:this.parentParagraph&&this.parentParagraph.linkByTarget(this.topic,this.subtopic)}},{key:"parentLinks",get:function(){var t=this;return this.sectionElement.parentNode===g?null:this.parentParagraph.linksBySelector((function(e){return(e.isLocal||e.isGlobal)&&t.topic.caps===e.targetTopic.caps&&t.subtopic.caps===e.targetSubtopic.caps}))}},{key:"ancestorImportReferences",get:function(){var t=this;return this.pageRoot?[]:this.topicParagraph.parentParagraph?this.topicParagraph.parentParagraph.linksBySelector((function(e){return e.isImport&&t.topic.caps===e.targetTopic.caps&&t.subtopic.caps===e.targetSubtopic.caps})):[]}},{key:"displayTopicName",get:function(){return this.sectionElement.dataset.displayTopicName}},{key:"parentParagraph",get:function(){if(this.sectionElement){var e=k(this.sectionElement,"canopy-section");return e?new t(e):null}return null}},{key:"topicParagraph",get:function(){return this.isTopic?this:new t(k(this.sectionElement,"canopy-topic-section"))}},{key:"isTopicRoot",get:function(){return this.topicName===this.subtopicName}},{key:"select",value:function(){this.sectionElement.classList.add("canopy-selected-section")}}])&&E(e.prototype,n),a&&E(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function P(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,i,r=[],o=!0,c=!1;try{for(n=n.call(t);!(o=(a=n.next()).done)&&(r.push(a.value),!e||r.length!==e);o=!0);}catch(t){c=!0,i=t}finally{try{o||null==n.return||n.return()}finally{if(c)throw i}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return T(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function N(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}const _=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e?Array.isArray(e)?(0===e.length?this.pathArray=[]:(this.pathArray=e.slice(),t.validatePathArray(this.pathArray)),this.pathString=t.arrayToString(this.pathArray)):("string"==typeof e||e instanceof String)&&(this.pathString=e,this.pathArray=t.stringToArray(e)):this.pathArray=[]}var e,n,a;return e=t,a=[{key:"validatePathArray",value:function(t){t.forEach((function(t){if(2!==t.length)throw"Invalid path segment format: ".concat(t);if(!(t[0]instanceof C()&&t[1]instanceof C()))throw"Invalid path segment format: ".concat(t)}))}},{key:"default",get:function(){var e=new(C())(y);return new t([[e,e]])}},{key:"current",get:function(){var e=window.location.href.slice(window.location.origin.length);return m&&0===e.indexOf("/".concat(m))&&(e=e.slice(m.length+1)),0===e.indexOf("#/")&&(e=e.slice(1)),new t(e)}},{key:"currentOrDefault",get:function(){return t.current.empty?t.default:t.current}},{key:"forTopic",value:function(e){return new t([[e,e]])}},{key:"forSegment",value:function(e,n){return new t([[e,n]])}},{key:"stringToArray",value:function(e){if("string"!=typeof e)throw"Function requires string argument";if(1===e.indexOf(m)&&(e=e.slice(m.length+1)),"/"===e)return[];var n=e.replace(/_/g," ").split("/").filter((function(t){return""!==t})),a=(n=t.fixOrphanSubtopics(e,n)).map((function(t){var e=t.match(/([^#]*)(?:#([^#]*))?/);return[e[1]||e[2]||null,e[2]||e[1]||null]})).filter((function(t){return null!==t[0]}));return a.map((function(t){var e=P(t,2),n=e[0],a=e[1];return[new(C())(decodeURIComponent(n),!0),new(C())(decodeURIComponent(a),!0)]}))}},{key:"arrayToString",value:function(t){if(!Array.isArray(t))throw"Argument must be array";if(Array.isArray(t)&&0===t.length)return"/";if(!Array.isArray(t[0]))throw"Path array must be two-dimensional array";return"/"+t.map((function(t){var e=P(t,2),n=e[0],a=e[1],i=n.encodedSlug;return a&&a.encodedSlug!==n.encodedSlug&&(i+="#"+a.encodedSlug),i})).join("/")}},{key:"fixOrphanSubtopics",value:function(t,e){if("string"!=typeof t)throw"pathString must be a string argument";if(!Array.isArray(e))throw"slashSeparatedUnits must be an array";if(t.match(/\/#\w+/))for(var n=1;n<e.length;n++)if(e[n].match(/^#/)){if(e[n-1].match(/#/)){var a=e[n].slice(1);return e.slice(0,n).concat([a]).concat(e.slice(n+1))}var i=e[n-1]+e[n];return e.slice(0,n-1).concat([i]).concat(e.slice(n+1))}return e}},{key:"connectingLinkValid",value:function(e,n){if(!e)throw"Parent element required";if(!(n instanceof t))throw"pathToDisplay must be a Path object";if(e===g)return!0;var a=new L(e);return!!a.linkByTarget(n.firstTopic)||(console.error("Parent element [".concat(a.topic.mixedCase,", ").concat(a.subtopic.mixedCase,"] has no ")+"connecting link to subsequent path segment [".concat(n.firstTopic,", ").concat(n.firstTopic,"]")),!1)}},{key:"elementAtRelativePath",value:function(e,n){if(!(e instanceof t))throw"pathToDisplay must be a Path object";!n||n.tagName;var a=n;n||(a=g);var i=e,r=a;if(a===g){if(r=a.querySelector('[data-topic-name-caps="'.concat(i.firstTopic.caps,'"]')+'[data-subtopic-name-caps="'.concat(i.firstSubtopic.caps,'"]')+'[data-path-depth="'.concat(0,'"]')),1===i.length)return r;if(!r)return null;i=i.withoutFirstSegment}for(var o=i,c=0;c<i.length;c++){var s=Number(r.dataset.pathDepth)+1;if(!(r=r.querySelector('[data-topic-name-caps="'.concat(o.firstTopic.caps,'"]')+'[data-subtopic-name-caps="'.concat(o.firstSubtopic.caps,'"]')+'[data-path-depth="'.concat(s,'"]'))))return null;o=o.withoutFirstSegment}return r}},{key:"setPath",value:function(e){if(!(e instanceof t))throw"newPath must be Path object";var n=t.current,a=e.firstTopic.display,i=e.equals(n)?function(t,e,n){history.replaceState(t,e,n)}:function(t,e,n){history.pushState(t,e,n)},r=(m?"/".concat(m):"")+(A?"/#":"")+e.string;i(history.state,a,r)}}],(n=[{key:"equals",value:function(t){return this.string===t.string}},{key:"addSegment",value:function(e,n){return this.empty?new t([[e,n]]):new t(this.pathArray.concat([[e,n]]))}},{key:"replaceTerminalSubtopic",value:function(t){var e=this.lastSegment;return this.withoutLastSegment.addSegment(e.firstTopic,t)}},{key:"toString",value:function(){return this.string}},{key:"array",get:function(){return this.pathArray}},{key:"string",get:function(){return this.pathString}},{key:"rootTopicPath",get:function(){return new t([[this.firstTopic,this.firstTopic]])}},{key:"firstTopic",get:function(){return this.pathArray[0][0]}},{key:"firstSubtopic",get:function(){return this.pathArray[0][1]}},{key:"secondTopic",get:function(){return this.pathArray[1]&&this.pathArray[1][0]}},{key:"secondSubtopic",get:function(){return this.pathArray[1]&&this.pathArray[1][1]}},{key:"firstSegment",get:function(){return new t(this.pathArray.slice(0,1))}},{key:"lastSegment",get:function(){return new t(this.pathArray.slice(-1))}},{key:"withoutFirstSegment",get:function(){return new t(this.pathArray.slice(1))}},{key:"withoutLastSegment",get:function(){return new t(this.pathArray.slice(0,-1))}},{key:"length",get:function(){return this.pathArray[0]?this.pathArray.length:0}},{key:"sectionElement",get:function(){return t.elementAtRelativePath(this,g)}},{key:"paragraph",get:function(){return this.sectionElement?new L(this.sectionElement):null}},{key:"empty",get:function(){return!this.pathArray[0]}}])&&N(e.prototype,n),a&&N(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),B=function(t){if(v[t.caps])return v[t.caps];var e=m+"/_data/"+t.requestFileName+".json",n=fetch(e).then((function(t){return t.json().then((function(t){return t}))})).catch((function(){return v[t.caps]=void 0,Promise.reject('Unable to request topic file: "'.concat(t.requestFileName,'"'))}));return v[t.caps]=n,n};function O(t){return function(e){var n,a;e.preventDefault();var i=e.metaKey||e.ctrlKey;return i||e.altKey||!t.isSelected?i||e.altKey||t.isSelected?!i&&e.altKey?(n=_.forSegment(t.targetTopic,t.targetSubtopic),U(n,a)):i&&!e.altKey?(n=t.paragraphPathWhenSelected,window.open(location.origin+n.string,"_blank")):i&&e.altKey?(n=_.forSegment(t.targetTopic,t.targetSubtopic),window.open(location.origin+n.string,"_blank")):void 0:(n=t.paragraphPathWhenSelected,U(n,a=t)):(n=t.enclosingParagraph.path,U(n,a))}}const I=function(t){var e,n="",a=!1,i=[],r={_:"I","*":"B","~":"S","`":"CODE"},o=[];t=function t(e){var n=e.replace(/(^|[\s}_*`~]+)([*`_~])(.*?(?!{{CLOSE|{{OPEN|\\))(\2)(?=[\s.,{*_`~]|$)/g,"$1{{OPEN$2}}$3{{CLOSE$4}}");return e===n?n:t(n)}(t=(t=t.replace(/{{(OPEN|CLOSE).}}/g,(function(t){return t.split("").join("\\")}))).replace(/(^|[\s}_*`~]+)([`])(.*?[^\\])(\2)(?=[\s.,{*_`~]|$)/g,(function(t,e,n,a,i){return e+n+a.replace(/([^\\]|^)\\(?=[^\\]|$)/g,"$1").replace(/\\\\/g,"\\").split("").join("\\")+i})));for(var c=0;c<t.length;c++){var s=t.slice(c).match(/^{{OPEN(.)}}/),l=t.slice(c).match(/^{{CLOSE(.)}}/);if(s){var p=s[1];if(n){var u=document.createTextNode(n);n="",e?e.appendChild(u):o.push(u)}var h=document.createElement(r[p]);e?e.appendChild(h):o.push(h),e=h,i.push(p),c+=s[0].length-1}else if(l&&i.slice(-1)[0]===l[1]){if(n){var d=document.createTextNode(n);n="",e?e.appendChild(d):o.push(d)}e=e.parentNode||null,i.pop(),c+=l[0].length-1}else l&&i.slice(-1)[0]!==l[1]?(n+=l[1],c+=l[0].length-1):a||"\\"!==t[c]?(n+=t[c],a=!1):a=!0}if(n){var f=document.createTextNode(n);o.push(f)}return o};function D(t,e){return"text"===t.type?function(t){var e=document.createElement("SPAN");return j(I(t.text),e),e}(t):"local"===t.type?function(t,e){return(0,e.localLinkSubtreeCallback)(t),function(t){var e,n=document.createElement("a");n.classList.add("canopy-selectable-link"),n.dataset.targetTopic=t.targetTopic,n.dataset.targetSubtopic=t.targetSubtopic,n.dataset.enclosingTopic=t.enclosingTopic,n.dataset.enclosingSubtopic=t.enclosingSubtopic,n.dataset.text=t.text,j(I(t.text),n),n.addEventListener("click",(t.targetTopic,t.targetSubtopic,e=new x(n),function(t){var n,a;t.preventDefault();var i,r=t.metaKey||t.ctrlKey;if(r&&!t.altKey)return window.open(location.origin+e.targetPath.string,"_blank");if(r&&t.altKey)return window.open(location.origin+e.targetPath.lastSegment.string,"_blank");if(!r&&t.altKey){var o=e.targetPath.lastSegment;return U(o,e.atNewPath(o))}return r||t.altKey||!e.isSelected?r||t.altKey||e.isSelected?void 0:(n=e.paragraphPathWhenSelected,U(n,a=e)):(n=null===(i=e.parentLink)||void 0===i?void 0:i.paragraphPathWhenSelected,U(n,a))})),n.classList.add("canopy-local-link"),n.dataset.type="local";var a=new(C())(t.targetTopic),i=new(C())(t.targetSubtopic);return n.href="/".concat(a.slug,"#").concat(i.slug),n}(t)}(t,e):"global"===t.type?function(t,e){e.pathArray;var n=e.globalLinkSubtreeCallback,a=function(t){var e=document.createElement("a");j(I(t.text),e),e.classList.add("canopy-global-link"),e.classList.add("canopy-selectable-link"),e.dataset.type="global",e.dataset.targetTopic=t.targetTopic,e.dataset.targetSubtopic=t.targetSubtopic,e.dataset.enclosingTopic=t.enclosingTopic,e.dataset.enclosingSubtopic=t.enclosingSubtopic,e.dataset.text=t.text;var n=new(C())(t.targetTopic,!0);return e.href="/".concat(n.slug),e.addEventListener("click",O(new x(e))),e}(t);return n(t,a),a}(t,e):"import"===t.type?function(t,e){return e.pathArray,function(t){var e=document.createElement("a");j(I(t.text),e),e.classList.add("canopy-global-link"),e.classList.add("canopy-selectable-link"),e.dataset.type="import",e.dataset.targetTopic=t.targetTopic,e.dataset.targetSubtopic=t.targetSubtopic,e.dataset.enclosingTopic=t.enclosingTopic,e.dataset.enclosingSubtopic=t.enclosingSubtopic,e.dataset.text=t.text;var n=new(C())(t.targetTopic),a=new(C())(t.targetSubtopic);return e.href="/".concat(n.slug,"#").concat(a.slug),e.addEventListener("click",O(new x(e))),e}(t)}(t,e):"url"===t.type?function(t){var e=document.createElement("SPAN"),n=document.createElement("a");return e.classList.add("canopy-url-link-span"),n.classList.add("canopy-url-link"),n.classList.add("canopy-selectable-link"),n.setAttribute("href",t.url),j(I(t.text),n),n.dataset.type="url",n.dataset.text=t.text,e.appendChild(n),n.innerHTML+='<svg xmlns:svg="http://www.w3.org/2000/svg"\n   xmlns="http://www.w3.org/2000/svg"\n   version="1.0"\n   width="12"\n   height="12"\n   id="svg2">\n  <defs id="defs4"></defs>\n  <rect\n     width="5.9999995"\n     height="6"\n     x="1.5"\n     y="4.5"\n     id="rect3170"\n     style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:#0066cc;stroke-width:0.99999994;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"></rect>\n  <path\n     d="M 4,2.5 L 5,3.5 L 5.25,4.25 L 2.75,6.5 L 5.5,9.25 L 7.75,6.75 L 8.5,7 L 9.5,8 L 11,6.5 L 11,1 L 5.5,1 L 4,2.5 z"\n     id="path2395"\n     style="fill:#0066ff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"></path>\n  <path\n     d="M 6,2 L 10,2 L 10,6 L 9.5,6.75 L 8.25,4.75 L 5.25,8 L 4,6.75 L 7.25,3.75 L 5.25,2.5 L 6,2 z"\n     id="path2398"\n     style="fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" ></path>\n</svg>\n'.replace(/\r?\n|\r/g,""),e}(t):"image"===t.type?function(t){var e=document.createElement("DIV");e.classList.add("canopy-image-div");var n=document.createElement("IMG");e.appendChild(n),n.setAttribute("src",t.resourceUrl),n.classList.add("canopy-image");var a=document.createElement("A");if(a.setAttribute("href",t.anchorUrl||t.resourceUrl),a.setAttribute("target","_blank"),a.appendChild(n),e.appendChild(a),t.title){n.setAttribute("title",t.title);var i=document.createElement("SUP"),r=document.createElement("DIV");i.appendChild(document.createTextNode(t.title)),i.classList.add("canopy-image-caption"),r.classList.add("canopy-caption-div"),e.appendChild(i)}else e.appendChild(a);return t.altText&&n.setAttribute("alt",t.altText),e}(t):"html_element"===t.type?function(t){var e=document.createElement("DIV");return e.innerHTML=t.html,e.classList.add("canopy-raw-html"),e}(t):"footnote"===t.type?function(t){var e=document.createElement("SUP"),n=document.createTextNode(t.text);return e.appendChild(n),e}(t):"code_block"===t.type?function(t){var e=document.createElement("PRE"),n=document.createElement("CODE");return e.appendChild(n),n.innerText=t.text,e}(t):"quote"===t.type?function(t){var e=document.createElement("BLOCKQUOTE");return e.innerText=t.text,e}(t):"list"===t.type?W(t.topLevelNodes):"table"===t.type?function(t,e){var n=document.createElement("TABLE");return t.rows.forEach((function(t){var e=document.createElement("TR");t.forEach((function(t){var n=document.createElement("TD");t.forEach((function(t){var e=D(t,undefined);n.appendChild(e)})),e.appendChild(n)})),n.appendChild(e)})),n}(t):"html_block"===t.type?function(t){var e=document.createElement("DIV");return e.innerHTML=t.html,e.classList.add("canopy-raw-html"),e}(t):"footnote_rule"===t.type?((n=document.createElement("HR")).classList.add("canopy-footnote-rule"),n):"footnote_line"===t.type?function(t,e){var n=document.createElement("SPAN");n.classList.add("canopy-footnote-span");var a=document.createTextNode(t.superscript+". ");return n.appendChild(a),t.tokens.forEach((function(t){var e=D(t,undefined);n.appendChild(e)})),n}(t):void 0;var n}function j(t,e){t.forEach((function(t){e.appendChild(t)}))}function W(t){var e=t[0].ordered?document.createElement("OL"):document.createElement("UL");return t[0].ordered&&e.setAttribute("type",t[0].ordinal),t.forEach((function(t){var n=document.createElement("LI");if(t.tokensOfLine.forEach((function(t){var e=D(t);n.appendChild(e)})),t.children.length>0){var a=W(t.children);n.appendChild(a)}e.appendChild(n)})),e}const q=D;const F=function t(e){var n=e.subtopic,a=e.paragraphsBySubtopic,i=function(t){var e=t.topic,n=t.subtopic,a=t.pathDepth,i=document.createElement("section");i.classList.add("canopy-section");var r=document.createElement("p");return r.classList.add("canopy-paragraph"),i.appendChild(r),i.style.display="none",i.dataset.displayTopicName=e.display,i.dataset.displaySubtopicName=n.display,i.dataset.topicNameCaps=e.caps,i.dataset.subtopicNameCaps=n.caps,i.dataset.pathDepth=a,e.caps===n.caps&&(a>0&&i.prepend(document.createElement("hr")),i.classList.add("canopy-topic-section")),i}(e),r=new L(i);e.displayBlockingPromises=[],e.localLinkSubtreeCallback=function(e,n){return function(a){var i=t(Object.assign({},n,{subtopic:new(C())(a.targetSubtopic)}));i.then((function(t){e.appendChild(t)})),n.displayBlockingPromises.push(i)}}(i,e),e.globalLinkSubtreeCallback=function(t,e){var n=e.pathToDisplay,a=e.subtopic,i=e.displayBlockingPromises;return function(e,r){var o=new(C())(e.targetTopic),c=new x(r);if(B(o),function(t,e,n){var a=e.firstSubtopic,i=e.secondTopic,r=e.secondTopic,o=r,c=t.targetTopic.caps===(null==r?void 0:r.caps)&&t.targetSubtopic.caps===(null==o?void 0:o.caps),s=n.caps===a.caps;return i&&c&&s}(c,n,a)){var s=n.withoutFirstSegment,l=G(s,t);i.push(l)}}}(i,e);var o=a[n.caps];if(!o)throw"Paragraph with subtopic not found: ".concat(n.mixedCase);return o.forEach((function(t){var n=q(t,e);r.paragraphElement.appendChild(n)})),Promise.all(e.displayBlockingPromises).then((function(){return i}))},G=function t(e,n){if(0===e.length)return Promise.resolve(null);var a=_.elementAtRelativePath(e.firstSegment,n);return a?_.connectingLinkValid(n,e)?t(e.withoutFirstSegment,a):Promise.resolve():B(e.firstTopic).then((function(t){var a=t.paragraphsBySubtopic,i=t.displayTopicName;return F({topic:new(C())(i),subtopic:new(C())(i),pathToDisplay:e,paragraphsBySubtopic:a,pathDepth:Number(n.dataset.pathDepth)+1||0})})).then((function(t){return n.appendChild(t)}))};var R=function t(e){e.display(),e.isPageRoot||(e.parentLink&&e.parentLinks.forEach((function(t){return t.open()})),e.ancestorImportReferences.forEach((function(t){return t.open()})),e.parentLink&&!x.selection&&x.select(e.parentLink),t(e.parentParagraph))};const M=function(t,e,n){return n=n||{},t.paragraph?null!=e&&e.contradicts(t)?U(e.paragraphPathWhenSelected,e,n):(Array.from(document.getElementsByTagName("a")).forEach((function(t){t.classList.remove("canopy-selected-link"),t.classList.remove("canopy-open-link")})),Array.from(document.getElementsByTagName("section")).forEach((function(t){t.style.display="none"})),Array.from(document.querySelectorAll(".canopy-selected-section")).forEach((function(t){t.classList.remove("canopy-selected-section")})),_.setPath((null==e?void 0:e.urlPathWhenSelected)||t),function(t){var e=document.querySelector("#_canopy h1");e&&e.remove();var n=document.createElement("h1"),a=I(t);Array.from(a).forEach((function(t){n.appendChild(t)})),g.prepend(n)}(t.rootTopicPath.paragraph.displayTopicName),document.title=t.rootTopicPath.paragraph.topic.mixedCase,x.select(e),t.paragraph.select(),R(t.paragraph),void(e&&function(t){var e=t.initialPageLoad?"auto":"smooth";window.scrollTo({top:x.selection.enclosingParagraph.paragraphElement.offsetTop-.3*window.screen.height,behavior:e})}(n))):function(t,e){return console.error("No section element found for path: ",t.string),t.length>1?(console.log("Trying: ",t.withoutLastSegment.string),M(t.withoutLastSegment,null,e)):(console.error("No path prefixes remain to try. Redirecting to default topic: "+_.default),U(_.default))}(t,n)},U=function(t,e,n){return function(t,e){if(!(t instanceof _))throw"Invalid path argument";if(e&&!(e instanceof x))throw"Invalid link selection argument"}(t,e),t.empty&&(t=_.default),G(t,g).finally((function(){M(t,e,n)})).catch(function(t,e){return function(n){"Link selector callback provided no link"===n?M(t,null,e):console.error(n)}}(t,n))};function K(){var t=x.selection;return t.enclosingParagraph.equals(L.pageRoot)?U(t.enclosingParagraph.path):U(t.parentLink.paragraphPathWhenSelected,t.parentLink)}function z(){var t=x.selection;if(t.isImport&&U(t.paragraphPathWhenSelected,t.targetParagraph.parentLink),t.isGlobal||t.isLocal){var e,n,a=(null===(e=t.targetParagraph)||void 0===e?void 0:e.firstLink)||(null===(n=t.targetParagraph)||void 0===n?void 0:n.parentLink);U(a.paragraphPathWhenSelected,a)}t.isParent||U(t.paragraphPathWhenSelected,t)}function $(){var t=x.selection.previousSibling||x.selection.lastSibling;return U(t.paragraphPathWhenSelected,t)}function H(){var t=x.selection.nextSibling||x.selection.firstSibling;return U(t.paragraphPathWhenSelected,t)}function J(t,e){if(x.selection.isLocal&&!e){var n,a,i=(null===(n=x.selection.targetParagraph)||void 0===n?void 0:n.firstLink)||(null===(a=x.selection.targetParagraph)||void 0===a?void 0:a.parentLink),r=i.paragraphPathWhenSelected;return t?window.open(location.origin+x.selection.targetPath,"_blank"):U(r,i)}if(x.selection.isLocal&&e){var o=x.selection,c=o.paragraphPathWhenSelected.lastSegment;return t?window.open(location.origin+x.selection.targetPath.lastSegment,"_blank"):U(c,o.atNewPath(c))}if(x.selection.isGlobal){var s=x.selection.targetPath.lastSegment;return t?window.open(location.origin+s.string,"_blank"):U(s,x.selectALink(s))}if(x.selection.isImport){var l=x.selection.targetPath.lastSegment;return t?window.open(location.origin+l.string,"_blank"):U(l,x.selection.parentLink.atNewPath(l))}if("url"===x.selection.type){if(t)return window.open(x.selection.element.href,"_blank");window.location=x.selection.element.href}}var V={left:$,up:K,down:z,right:H,"shift-up":function(){var t=x.selection,e=t.enclosingParagraph.topicParagraph.parentLink;return U((null==e?void 0:e.paragraphPathWhenSelected)||_.current,e||t)},h:$,j:z,k:K,l:H,escape:function(){return U(_.current.rootTopicPath)},z:function(){var t=x.selection,e=t.localPathWhenSelected,n=t.atNewPath(e);return U(e,n)},enter:J,"meta-enter":J.bind(null,!0),"ctrl-enter":J.bind(null,!0),"alt-enter":J.bind(null,!1,!0),"meta-alt-enter":J.bind(null,!0,!0),"ctrl-alt-enter":J.bind(null,!0,!0),tab:function(){var t=x.selection;if(t.isLocal&&t.hasChildren){var e=t.firstChildLink||t.nextSibling||t;return U(e.paragraphPathWhenSelected,e)}if(t.isGlobalOrImport){var n,a=t.nextSibling||(null===(n=t.parentLink)||void 0===n?void 0:n.nextSibling)||t.enclosingParagraph.firstLink;return U(a.enclosingParagraph.path,a)}if(t.nextSibling&&!t.nextSibling.equals(t))return U(t.nextSibling.enclosingParagraph.path,t.nextSibling);if(t.lastSibling.equals(t)){var i=function t(e){return e.parentLink&&e.parentLink.isLocal?e.parentLink.nextSibling?e.parentLink.nextSibling:t(e.parentLink):e.firstSibling}(t);return U(i.paragraphPathWhenSelected,i)}}},Z={37:"left",39:"right",38:"up",40:"down",71:"g",72:"h",75:"k",74:"j",76:"l",186:";",90:"z",13:"enter",9:"tab",27:"escape",192:"`",49:"1",50:"2",51:"3",52:"4",53:"5"};window.addEventListener("keydown",(function(t){var e=(t.metaKey?"meta-":"")+(t.ctrlKey?"ctrl-":"")+(t.altKey?"alt-":"")+(t.shiftKey?"shift-":""),n=Z[t.keyCode],a=e+n;["tab","down","up"].includes(n)&&t.preventDefault(),x.selection?(V[a]||function(){})():V[a]&&U(_.current,x.selectALink())})),"scrollRestoration"in history&&(history.scrollRestoration="manual"),window.addEventListener("popstate",(function(t){var e=x.selectionPresentInEvent(t)?new x(t.state):null;U(_.currentOrDefault,e||x.sessionSelection)})),U(_.currentOrDefault,x.priorSelection,{initialPageLoad:!0})})()})();
//# sourceMappingURL=canopy.js.map
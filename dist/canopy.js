(()=>{"use strict";var t={570:(t,e,n)=>{n.d(e,{Z:()=>c});var a=n(537),i=n.n(a),r=n(645),o=n.n(r)()(i());o.push([t.id,"#_canopy{padding-top:15px;padding-bottom:55px}#_canopy h1{text-align:center;margin:auto;width:40%;margin-top:10px}#_canopy hr{width:9%;display:block;height:1px;border:0;border-top:5px solid #ccc;margin:0px auto;padding-bottom:30px}#_canopy section.canopy-topic-section{padding-top:40px}#_canopy section{padding-top:30px}#_canopy p{overflow:hidden;font-size:22px;max-width:700px;margin:auto;line-height:1.3;letter-spacing:-0.003em;font-weight:400}#_canopy a.canopy-selectable-link{text-decoration:underline #ddd;color:#000;cursor:pointer}#_canopy a.canopy-selectable-link:hover{text-decoration:underline}#_canopy a.canopy-selectable-link:focus{outline:0}#_canopy a.canopy-selectable-link.canopy-open-link{text-shadow:.8px 0px 0px #000;text-decoration:underline}#_canopy a.canopy-selectable-link.canopy-selected-link{background-color:#edeefc;text-shadow:0px 0px 0px #000;text-decoration:none}#_canopy a.canopy-selectable-link.canopy-url-link:hover{color:#4078c0}#_canopy a.canopy-selectable-link.canopy-url-link.canopy-selected-link{color:#4078c0}#_canopy span.canopy-text-span{display:block}#_canopy hr.footnote-rule{width:700px;display:block;height:1px;border:0;border-top:1px solid #ccc;margin:12px 0;padding:0}#_canopy sup{font-size:60%;padding:2px}#_canopy .footnote-span{font-size:80%}#_canopy blockquote{margin:7px 10px;background-color:#eff0f1;padding:5px;font-size:90%}#_canopy blockquote a.canopy-selectable-link{text-decoration:underline #d3d3d3}#_canopy pre{margin:7px 10px;background-color:#eff0f1;padding:5px;font-size:85%}#_canopy code{background-color:#eff0f1;font-size:90%}#_canopy table{margin:7px auto;table-layout:fixed;width:70%;border-collapse:collapse;border:2px solid #000}#_canopy table td,#_canopy table th{border:2px solid #000;text-align:center;padding:6px}#_canopy img{max-width:200px;max-height:275px}#_canopy div.canopy-image-div{float:right;border:1px solid #c8ccd1;padding:3px;background-color:#f8f9fa;font-size:94%;text-align:center;overflow:hidden;min-width:172px;min-height:230px;margin:10px}#_canopy div.canopy-image-div>sup{display:block}#_canopy .canopy-url-link-span>svg{height:15px;width:12px;display:none}#_canopy .canopy-selected-link+svg,#_canopy .canopy-url-link-span:hover>svg{display:inline;vertical-align:middle}#_canopy ol,#_canopy ul{margin:7px 10px}#_canopy div.canopy-raw-html{display:inline}#_canopy>section.canopy-topic-section{padding-top:30px}","",{version:3,sources:["webpack://./client/style/canopy.scss"],names:[],mappings:"AAAA,SACE,gBAAA,CACA,mBAAA,CAEA,YACE,iBAAA,CACA,WAAA,CACA,SAAA,CACA,eAAA,CAGF,YACE,QAAA,CACA,aAAA,CACA,UAAA,CACA,QAAA,CACA,yBAAA,CACA,eAAA,CACA,mBAAA,CAGF,sCACE,gBAAA,CAGF,iBACE,gBAAA,CAGF,WACE,eAAA,CACA,cAAA,CACA,eAAA,CACA,WAAA,CAEA,eAAA,CACA,uBAAA,CACA,eAAA,CAKF,kCACE,8BAAA,CACA,UAAA,CACA,cAAA,CAEA,wCACE,yBAAA,CAGF,wCACE,SAAA,CAGF,mDACE,6BAAA,CACA,yBAAA,CAGF,uDACE,wBAAA,CACA,4BAAA,CACA,oBAAA,CAIA,wDACE,aAAA,CAGF,uEACE,aAAA,CAiBN,+BACE,aAAA,CAGF,0BACE,WAAA,CACA,aAAA,CACA,UAAA,CACA,QAAA,CACA,yBAAA,CACA,aAAA,CACA,SAAA,CAGF,aACE,aAAA,CACA,WAAA,CAGF,wBACE,aAAA,CAGF,oBACE,eAAA,CACA,wBAAA,CACA,WAAA,CACA,aAAA,CAEA,6CACE,iCAAA,CAIJ,aACE,eAAA,CACA,wBAAA,CACA,WAAA,CACA,aAAA,CAGF,cACE,wBAAA,CACA,aAAA,CAGF,eACE,eAAA,CACA,kBAAA,CACA,SAAA,CACA,wBAAA,CACA,qBAAA,CAEA,oCACE,qBAAA,CACA,iBAAA,CACA,WAAA,CAIJ,aACE,eAAA,CACA,gBAAA,CAGF,8BACE,WAAA,CACA,wBAAA,CACA,WAAA,CACA,wBAAA,CACA,aAAA,CACA,iBAAA,CACA,eAAA,CACA,eAAA,CACA,gBAAA,CACA,WAAA,CAGF,kCACE,aAAA,CAGF,mCACE,WAAA,CACA,UAAA,CACA,YAAA,CAGF,4EACE,cAAA,CACA,qBAAA,CAGF,wBACE,eAAA,CAGF,6BACE,cAAA,CAIJ,sCACE,gBAAA",sourcesContent:["#_canopy {\n  padding-top: 15px;\n  padding-bottom: 55px;\n\n  h1 {\n    text-align: center;\n    margin: auto;\n    width: 40%;\n    margin-top: 10px;\n  }\n\n  hr {\n    width: 9%;\n    display: block;\n    height: 1px;\n    border: 0;\n    border-top: 5px solid #ccc;\n    margin: 0px auto;\n    padding-bottom: 30px;\n  }\n\n  section.canopy-topic-section {\n    padding-top: 40px;\n  }\n\n  section {\n    padding-top: 30px;\n  }\n\n  p {\n    overflow: hidden;\n    font-size: 22px;\n    max-width: 700px;\n    margin: auto;\n\n    line-height: 1.3;\n    letter-spacing: -.003em;\n    font-weight: 400;\n  }\n\n///////////// Link styles /////////////////\n\n  a.canopy-selectable-link {\n    text-decoration: underline #DDDDDD;\n    color: black;\n    cursor: pointer;\n\n    &:hover {\n      text-decoration: underline;\n    }\n\n    &:focus {\n      outline:0;\n    }\n\n    &.canopy-open-link {\n      text-shadow: .8px 0px 0px #000000;\n      text-decoration: underline;\n    }\n\n    &.canopy-selected-link {\n      background-color: #edeefc;\n      text-shadow: 0px 0px 0px #000000;\n      text-decoration: none;\n    }\n\n    &.canopy-url-link {\n      &:hover {\n        color: #4078c0;\n      }\n\n      &.canopy-selected-link {\n        color: #4078c0;\n      }\n    }\n\n    /*\n    &.canopy-dfs-previously-selected-link {\n      color: #ff0000 !important;\n    }\n\n    &.canopy-reverse-dfs-previously-selected-link {\n      color: #0000ff !important;\n    }\n    */\n  }\n\n///////////// Markdown styles /////////////////\n\n  span.canopy-text-span {\n    display: block;\n  }\n\n  hr.footnote-rule {\n    width: 700px;\n    display: block;\n    height: 1px;\n    border: 0;\n    border-top: 1px solid #ccc;\n    margin: 12px 0;\n    padding: 0;\n  }\n\n  sup {\n    font-size: 60%;\n    padding: 2px;\n  }\n\n  .footnote-span {\n    font-size: 80%;\n  }\n\n  blockquote {\n    margin: 7px 10px;\n    background-color: #eff0f1;\n    padding: 5px;\n    font-size: 90%;\n\n    a.canopy-selectable-link {\n      text-decoration: underline #D3D3D3;\n    }\n  }\n\n  pre {\n    margin: 7px 10px;\n    background-color: #eff0f1;\n    padding: 5px;\n    font-size: 85%;\n  }\n\n  code {\n    background-color: #eff0f1;\n    font-size: 90%;\n  }\n\n  table {\n    margin: 7px auto;\n    table-layout: fixed;\n    width: 70%;\n    border-collapse: collapse;\n    border: 2px solid black;\n\n    td, th {\n      border: 2px solid black;\n      text-align: center;\n      padding: 6px;\n    }\n  }\n\n  img {\n    max-width: 200px;\n    max-height: 275px;\n  }\n\n  div.canopy-image-div {\n    float: right;\n    border: 1px solid #c8ccd1;\n    padding: 3px;\n    background-color: #f8f9fa;\n    font-size: 94%;\n    text-align: center;\n    overflow: hidden;\n    min-width: 172px;\n    min-height: 230px;\n    margin: 10px;\n  }\n\n  div.canopy-image-div > sup {\n    display: block;\n  }\n\n  .canopy-url-link-span > svg {\n    height: 15px;\n    width: 12px;\n    display: none;\n  }\n\n  .canopy-selected-link + svg, .canopy-url-link-span:hover > svg {\n    display: inline;\n    vertical-align: middle;\n  }\n\n  ol, ul {\n    margin: 7px 10px;\n  }\n\n  div.canopy-raw-html {\n    display: inline;\n  }\n}\n\n#_canopy > section.canopy-topic-section {\n  padding-top: 30px;\n}\n"],sourceRoot:""}]);const c=o},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",a=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),a&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),a&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,a,i,r){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(a)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(o[s]=!0)}for(var l=0;l<t.length;l++){var p=[].concat(t[l]);a&&o[p[0]]||(void 0!==r&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=r),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),i&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=i):p[4]="".concat(i)),e.push(p))}},e}},537:t=>{t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),r="/*# ".concat(i," */"),o=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[e].concat(o).concat([r]).join("\n")}return[e].join("\n")}},379:t=>{var e=[];function n(t){for(var n=-1,a=0;a<e.length;a++)if(e[a].identifier===t){n=a;break}return n}function a(t,a){for(var r={},o=[],c=0;c<t.length;c++){var s=t[c],l=a.base?s[0]+a.base:s[0],p=r[l]||0,u="".concat(l," ").concat(p);r[l]=p+1;var h=n(u),d={css:s[1],media:s[2],sourceMap:s[3],supports:s[4],layer:s[5]};if(-1!==h)e[h].references++,e[h].updater(d);else{var f=i(d,a);a.byIndex=c,e.splice(c,0,{identifier:u,updater:f,references:1})}o.push(u)}return o}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var r=a(t=t||[],i=i||{});return function(t){t=t||[];for(var o=0;o<r.length;o++){var c=n(r[o]);e[c].references--}for(var s=a(t,i),l=0;l<r.length;l++){var p=n(r[l]);0===e[p].references&&(e[p].updater(),e.splice(p,1))}r=s}}},569:t=>{var e={};t.exports=function(t,n){var a=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(n)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var a="";n.supports&&(a+="@supports (".concat(n.supports,") {")),n.media&&(a+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(a+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),a+=n.css,i&&(a+="}"),n.media&&(a+="}"),n.supports&&(a+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleTagTransform(a,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function n(a){var i=e[a];if(void 0!==i)return i.exports;var r=e[a]={id:a,exports:{}};return t[a](r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{var t=n(379),e=n.n(t),a=n(795),i=n.n(a),r=n(569),o=n.n(r),c=n(565),s=n.n(c),l=n(216),p=n.n(l),u=n(589),h=n.n(u),d=n(570),f={};function g(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}f.styleTagTransform=h(),f.setAttributes=s(),f.insert=o().bind(null,"head"),f.domAPI=i(),f.insertStyleElement=p(),e()(d.Z,f),d.Z&&d.Z.locals&&d.Z.locals;const y=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e||"SECTION"!==e.tagName)throw"Paragraph instantiation requires section element";if(!e.classList.contains("canopy-section"))throw"Paragraph class requires Canopy section element";this.sectionElement=e,this.transferDataset()}var e,n,a;return e=t,a=[{key:"current",get:function(){return T.current.paragraph}},{key:"pageRoot",get:function(){return T.forTopic(T.current.firstTopic).paragraph}},{key:"containingLink",value:function(e){if(!e instanceof k)throw"Must provide link instance argument";return new t(w(e.element,"canopy-section"))}}],(n=[{key:"equals",value:function(t){return!!t&&this.sectionElement===t.sectionElement}},{key:"display",value:function(){this.sectionElement.style.display="block"}},{key:"element",get:function(){throw"Depreciated in favor of #sectionElement property"}},{key:"transferDataset",value:function(){this.topicName=this.sectionElement.dataset.topicName,this.subtopicName=this.sectionElement.dataset.subtopicName,this.pathDepth=this.sectionElement.dataset.pathDepth}},{key:"topic",get:function(){throw"Depreciated in favor of #topicName"}},{key:"subtopic",get:function(){throw"Depreciated in favor of #subtopicName"}},{key:"paragraphElement",get:function(){var t=Array.from(this.sectionElement.childNodes).find((function(t){return"P"===t.tagName}));if(!t)throw"Paragraph has no paragraph element";return t}},{key:"path",get:function(){for(var t=[],e=this.sectionElement;e!==b;){var n=e.dataset.topicName;for(t.unshift([n,e.dataset.subtopicName]);e.dataset.topicName===n;)e=e.parentNode}return new T(t)}},{key:"links",get:function(){if(this.linkObjects)return this.linkObjects;var t=this.paragraphElement.querySelectorAll("a.canopy-selectable-link");return this.linkObjects=Array.from(t).map((function(t){return new k(t)})),this.linkObjects}},{key:"firstLink",get:function(){return this.links[0]||null}},{key:"lastLink",get:function(){return this.links[this.links.length-1]||null}},{key:"isPageRoot",get:function(){return this.sectionElement.parentNode===b}},{key:"isTopic",get:function(){return this.topicName===this.subtopicName}},{key:"hasLinks",get:function(){return this.links.length>0}},{key:"linkBySelector",value:function(t){return this.links.find(t)}},{key:"linksBySelector",value:function(t){return this.links.filter(t)}},{key:"linkByTarget",value:function(t,e){return e=e||t,this.linkBySelector((function(n){return n.targetTopic===t&&n.targetSubtopic===e}))}},{key:"parentLink",get:function(){return this.sectionElement.parentNode===b?null:this.parentParagraph&&this.parentParagraph.linkByTarget(this.sectionElement.dataset.topicName,this.sectionElement.dataset.subtopicName)}},{key:"displayTopicName",get:function(){return this.sectionElement.dataset.displayTopicName}},{key:"parentParagraph",get:function(){if(this.sectionElement){var e=w(this.sectionElement,"canopy-section");return e?new t(e):null}return null}},{key:"topicParagraph",get:function(){return this.isTopic?this:new t(w(this.sectionElement,"canopy-topic-section"))}},{key:"isTopicRoot",get:function(){return this.topicName===this.subtopicName}}])&&g(e.prototype,n),a&&g(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();function A(t){return A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},A(t)}function m(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}const k=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),"A"===e.tagName)this.element=e;else{if(e instanceof t)throw"Cannot instantiate link from link";if("object"===A(e))this.metadataObject=e;else{if("function"!=typeof e)throw"Invalid argument to Link constructor";this.selectorCallback=e}}}var e,n,a;return e=t,a=[{key:"collectMetadata",value:function(e){var n=new t(e);return{pathString:y.containingLink(n).path.string,text:e.dataset.text,relativeLinkNumber:n.relativeLinkNumber}}},{key:"containsLinkSelectionMetadata",value:function(t){return t.hasOwnProperty("relativeLinkNumber")}},{key:"elementFromMetadata",value:function(t){var e=new T(t.pathString).paragraph;if(!e)throw"Link selection data refers to non-existant link";var n=e.linkBySelector((function(e,n){return e.element.dataset.text===t.text&&n===t.relativeLinkNumber}));return n&&n.element||null}},{key:"select",value:function(e){e&&e.element.classList.add("canopy-selected-link"),t.persistInHistory(e),t.persistInSession(e)}},{key:"selectionPresentInEvent",value:function(e){return e.state&&t.containsLinkSelectionMetadata(e.state)}},{key:"sessionSelection",get:function(){var e=sessionStorage.getItem(T.current.string);return e&&"null"!==e?new t(JSON.parse(e)):null}},{key:"historySelection",get:function(){return history.state&&t.containsLinkSelectionMetadata(history.state)?new t(history.state):null}},{key:"priorSelection",get:function(){return this.historySelection||this.sessionSelection||null}},{key:"selection",get:function(){var e=document.querySelector("a.canopy-selected-link");return e?new t(e):null}},{key:"persistInSession",value:function(t){var e=t&&JSON.stringify(t.metadata);sessionStorage.setItem(location.pathname+location.hash,e||null)}},{key:"persistInHistory",value:function(t){history.replaceState(t&&t.metadata||null,document.title,window.location.href)}},{key:"selectALink",value:function(e){return new t((function(){var t=(e=e||T.current).paragraph;return t.parentLink||t.firstLink}))}},{key:"current",value:function(){throw"Link#current does not exist, try Link#selection"}}],(n=[{key:"equals",value:function(t){return this.element===t.element}},{key:"matches",value:function(t){if(!t)throw"Invalid link argument to Link#matches";return this.targetTopic===t.targetTopic&&this.targetSubtopic===t.targetSubtopic&&this.relativeLinkNumber===t.relativeLinkNumber}},{key:"contradicts",value:function(t){if(!t instanceof T)throw"Invalid path argument to Link#contradicts";return this.pathToDisplay.string!==t.string}},{key:"element",get:function(){if(this.linkElement)return this.linkElement;if(this.metadataObject)return this.element=t.elementFromMetadata(this.metadata),this.linkElement;if(this.selectorCallback){var e=this.selectorCallback();if(!e)throw"Link selector callback didn't select link";return this.element=e.element,this.linkElement}},set:function(e){e instanceof HTMLAnchorElement?this.linkElement=e:e instanceof t&&(this.linkElement=e.element),this.transferDataset()}},{key:"transferDataset",value:function(){if(!this.linkElement)throw"Link element must be present";this._targetTopic=this.linkElement.dataset.targetTopic,this._targetSubtopic=this.linkElement.dataset.targetSubtopic,this._enclosingTopic=this.linkElement.dataset.enclosingTopic,this._enclosingSubtopic=this.linkElement.dataset.enclosingSubtopic,this._typeValue=this.linkElement.dataset.type}},{key:"targetTopic",get:function(){return this.element.dataset.targetTopic}},{key:"targetSubtopic",get:function(){return this.element.dataset.targetSubtopic}},{key:"enclosingTopic",get:function(){return this.element.dataset.enclosingTopic}},{key:"enclosingSubtopic",get:function(){return this.element.dataset.enclosingSubtopic}},{key:"type",get:function(){return this.element.dataset.type}},{key:"enclosingSectionElement",get:function(){return w(this.element,"canopy-section")}},{key:"sectionElement",get:function(){throw"Depreciated in favor of #enclosingSectionElement"}},{key:"enclosingParagraphElement",get:function(){return w(this.element,"canopy-paragraph")}},{key:"parentParagraphElement",get:function(){throw"Depreciated in favor of #enclosingParagraphElement"}},{key:"enclosingParagraph",get:function(){return new y(this.enclosingSectionElement)}},{key:"targetParagraph",get:function(){if(!this.isParent)return null;var t=this.enclosingParagraph.pathDepth;this.isGlobalOrImport&&(t=Number(t)+1);var e=this.enclosingParagraph.sectionElement.querySelector('section[data-topic-name="'.concat(this.targetTopic,'"]')+'[data-subtopic-name="'.concat(this.targetSubtopic,'"]')+'[data-path-depth="'.concat(t,'"'));if(!e)throw"Did not find paragraph child element matching link [".concat(this.targetTopic,", ").concat(this.targetSubtopic,"]");return new y(e)}},{key:"atNewPath",value:function(t){return(this.isParent?t.paragraph.parentParagraph:t.paragraph).links.find(this.matcher)}},{key:"localPathWhenSelected",get:function(){return this.isGlobalOrImport?new T(this.pathToDisplay.pathArray.slice(-2)):this.pathToDisplay.lastSegment}},{key:"matcher",get:function(){var t=this;return function(e){return e.matches(t)}}},{key:"relativeLinkNumber",get:function(){return this.storedRelativeLinkNumber||(this.storedRelativeLinkNumber=this.enclosingParagraph.links.map((function(t){return t.element})).indexOf(this.element)),this.storedRelativeLinkNumber}},{key:"metadata",get:function(){if(this.metadataObject)return this.metadataObject;if(this.linkElement){var e=t.collectMetadata(this.linkElement);return this.metadataObject=e,e}if(this.selectorCallback)return this.element=this.selectorCallback(),this.metadata;throw"Link has neither supplied metadata, dom element, nor selector function"}},{key:"targetPath",get:function(){return this.isGlobalOrImport?this.enclosingParagraph.path.addSegment(this.targetTopic,this.targetSubtopic):this.isLocal?this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic):null}},{key:"path",get:function(){throw"Depreciated in favor of #pathToDisplay"}},{key:"pathToDisplay",get:function(){return this.isGlobalOrImport?this.enclosingParagraph.path.addSegment(this.targetTopic,this.targetSubtopic):this.isLocal?this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic):this.enclosingParagraph.path}},{key:"nextSibling",get:function(){var t=this.enclosingParagraph.links;if(this.equals(t[t.length-1]))return null;var e=t.map((function(t){return t.element}));return t[e.indexOf(this.element)+1]}},{key:"previousSibling",get:function(){var t=this.enclosingParagraph.links;if(this.equals(t[0]))return null;var e=t.map((function(t){return t.element}));return t[e.indexOf(this.element)-1]}},{key:"siblings",get:function(){return this.enclosingParagraph.links}},{key:"firstSibling",get:function(){return this.siblings[0]}},{key:"lastSibling",get:function(){return this.siblings[this.siblings.length-1]}},{key:"firstChildLink",get:function(){return this.targetParagraph.firstLink}},{key:"lastChildLink",get:function(){return this.targetParagraph.lastLink}},{key:"parentLink",get:function(){return this.enclosingParagraph.parentLink}},{key:"grandParentLink",get:function(){return this.parentLink.parentLink}},{key:"topicParagraph",get:function(){return w(this.element,"canopy-topic-section")}},{key:"selected",get:function(){return this.element.classList.includes("canopy-selected-link")}},{key:"open",value:function(){this.element.classList.add("canopy-open-link")}},{key:"isOpen",get:function(){return this.element.classList.contains("canopy-open-link")}},{key:"isClosed",get:function(){return!this.isOpen}},{key:"isGlobal",get:function(){return"global"===this.type}},{key:"isImport",get:function(){return"import"===this.type}},{key:"isGlobalOrImport",get:function(){return"global"===this.type||"import"===this.type}},{key:"isLocal",get:function(){return"local"===this.type}},{key:"isParent",get:function(){return this.isGlobal||this.isLocal||this.isImport}}])&&m(e.prototype,n),a&&m(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}();var b=document.getElementById("_canopy"),v=b&&b.dataset.defaultTopic,C=b&&b.dataset.projectPathPrefix,S=b&&b.dataset.hashUrls;function w(t,e){for(var n=t.parentElement;n.classList&&!n.classList.contains(e);){if(n===b)return null;n=n.parentNode}return n}var x=function(t){return t?t.replace(/ /g,"_"):t};function E(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function L(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}const T=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e?Array.isArray(e)?(0===e.length?this.pathArray=[["",""]]:(this.pathArray=JSON.parse(JSON.stringify(e)),t.validatePathArray(this.pathArray)),this.pathString=t.arrayToString(this.pathArray)):("string"==typeof e||e instanceof String)&&(this.pathString=e,this.pathArray=t.stringToArray(this.pathString)):this.pathArray=[["",""]]}var e,n,a;return e=t,a=[{key:"validatePathArray",value:function(t){t.forEach((function(t){if(2!==t.length)throw"Invalid path segment format: ".concat(t);if("string"!=typeof t[0]||"string"!=typeof t[1])throw"Invalid path segment format: ".concat(t)}))}},{key:"default",get:function(){return new t([[v,v]])}},{key:"current",get:function(){var e=window.location.pathname+window.location.hash;return 0===e.indexOf("/".concat(C))&&(e=e.slice(C.length+1)),0===e.indexOf("#/")&&(e=e.slice(1)),new t(e)}},{key:"initial",get:function(){return t.current.empty?t.default:t.current}},{key:"forTopic",value:function(e){return new t([[e,e]])}},{key:"forSegment",value:function(e,n){return new t([[e,n]])}},{key:"stringToArray",value:function(e){if("string"!=typeof e)throw"Function requires string argument";if(1===e.indexOf(C)&&(e=e.slice(C.length+1)),"/"===e)return[["",""]];var n=e.replace(/_/g," ").split("/").filter((function(t){return""!==t}));return(n=t.fixOrphanSubtopics(e,n)).map((function(t){var e=t.match(/([^#]*)(?:#([^#]*))?/);return[e[1]||e[2]||null,e[2]||e[1]||null]})).filter((function(t){return null!==t[0]}))}},{key:"arrayToString",value:function(t){if(!Array.isArray(t))throw"Argument must be array";if(Array.isArray(t)&&0===t.length)return"/";if(!Array.isArray(t[0]))throw"Path array must be two-dimensional array";return"/"+t.map((function(t){var e,n,a=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,i,r=[],o=!0,c=!1;try{for(n=n.call(t);!(o=(a=n.next()).done)&&(r.push(a.value),!e||r.length!==e);o=!0);}catch(t){c=!0,i=t}finally{try{o||null==n.return||n.return()}finally{if(c)throw i}}return r}}(e,n)||function(t,e){if(t){if("string"==typeof t)return E(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],r=a[1],o=x(i);return r&&r!==i&&(o+="#"+x(r)),o})).join("/")}},{key:"fixOrphanSubtopics",value:function(t,e){if("string"!=typeof t)throw"pathString must be a string argument";if(!Array.isArray(e))throw"slashSeparatedUnits must be an array";if(t.match(/\/#\w+/))for(var n=1;n<e.length;n++)if(e[n].match(/^#/)){if(e[n-1].match(/#/)){var a=e[n].slice(1);return e.slice(0,n).concat([a]).concat(e.slice(n+1))}var i=e[n-1]+e[n];return e.slice(0,n-1).concat([i]).concat(e.slice(n+1))}return e}},{key:"validateConnectingLink",value:function(e,n){if(!e)throw"Parent element required";if(!n instanceof t)throw"pathToDisplay must be a Path object";if(e!==b&&!new y(e).linkByTarget(n.firstTopic))throw"Parent element has no connecting link to subsequent path segment"}},{key:"elementAtRelativePath",value:function(e,n){if(!e instanceof t)throw"pathToDisplay must be a Path object";!n||n.tagName;var a=n;n||(a=b);var i=e.clone,r=a;if(a===b){if(r=a.querySelector('[data-topic-name="'.concat(i.firstTopic,'"]')+'[data-subtopic-name="'.concat(i.firstSubtopic,'"]')+'[data-path-depth="'.concat(0,'"]')),1===i.length)return r;if(!r)return null;i=i.withoutFirstSegment}for(var o=i.clone,c=0;c<i.length;c++){var s=Number(r.dataset.pathDepth)+1;r=r.querySelector('[data-topic-name="'.concat(o.firstTopic,'"]')+'[data-subtopic-name="'.concat(o.firstSubtopic,'"]')+'[data-path-depth="'.concat(s,'"]')),o=o.withoutFirstSegment}return r}},{key:"setPath",value:function(e,n){if(!e instanceof t)throw"newPath must be Path object";var a=t.current,i=e.firstTopic,r=e.equals(a)?function(t,e,n){history.replaceState(t,e,n)}:function(t,e,n){history.pushState(t,e,n)},o=(C?"/".concat(C):"")+(S?"/#":"")+e.string;r(history.state,i,o)}}],(n=[{key:"equals",value:function(t){return this.string===t.string}},{key:"addSegment",value:function(e,n){return this.empty?new t([[e,n]]):new t(this.pathArray.concat([[e,n]]))}},{key:"replaceTerminalSubtopic",value:function(t){var e=this.lastSegment;return this.withoutLastSegment.addSegment(e.topic,t)}},{key:"toString",value:function(){return this.string}},{key:"array",get:function(){return this.pathArray}},{key:"string",get:function(){return this.pathString}},{key:"firstTopic",get:function(){return this.pathArray[0][0]}},{key:"topic",get:function(){return this.pathArray[0][0]}},{key:"rootPath",get:function(){return new t([[this.topic,this.topic]])}},{key:"firstSubtopic",get:function(){return this.pathArray[0][1]}},{key:"subtopic",get:function(){return this.pathArray[0][1]}},{key:"secondTopic",get:function(){return this.pathArray[1]&&this.pathArray[1][0]}},{key:"secondSubtopic",get:function(){return this.pathArray[1]&&this.pathArray[1][1]}},{key:"firstSegment",get:function(){return new t([[this.pathArray[0][0],this.pathArray[0][1]]])}},{key:"lastSegment",get:function(){return new t(this.pathArray.slice(-1))}},{key:"withoutFirstSegment",get:function(){return new t(this.pathArray.slice(1))}},{key:"withoutLastSegment",get:function(){return new t(this.pathArray.slice(0,-1))}},{key:"clone",get:function(){return new t(JSON.parse(JSON.stringify(this.pathArray)))}},{key:"length",get:function(){return""===this.pathArray[0][0]?0:this.pathArray.length}},{key:"sectionElement",get:function(){return t.elementAtRelativePath(this,b)}},{key:"paragraph",get:function(){return this.sectionElement?new y(this.sectionElement):null}},{key:"empty",get:function(){return""===this.pathArray[0][0]}}])&&L(e.prototype,n),a&&L(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}(),P=function(t){for(var e="",n=!1,a={B:!1,I:!1,S:!1,CODE:!1},i={_:"I","*":"B","~":"S","`":"CODE"},r=[],o=0;o<t.length;o++)!n&&["_","*","~","`"].includes(t[o])?function(){var n=document.createTextNode(e);e="";var c=void 0,s=void 0;Object.keys(a).forEach((function(t){if(a[t]){var e=document.createElement(t);s&&s.appendChild(e),c=c||e,s=e}})),s?(s.appendChild(n),r.push(c)):r.push(n),a[i[t[o]]]=!a[i[t[o]].toUpperCase()]}():n||"\\"!==t[o]?(e+=t[o],n=!1):n=!0;if(e){var c=document.createTextNode(e);r.push(c)}return r};var N=function t(e){e.display(),e.isPageRoot||(e.parentLink&&e.parentLink.open(),t(e.parentParagraph))};const B=function(t,e,n){return n=n||{},t.paragraph?e&&e.contradicts(t)?q(e.pathToDisplay,e,n):(Array.from(document.getElementsByTagName("a")).forEach((function(t){t.classList.remove("canopy-selected-link"),t.classList.remove("canopy-open-link")})),Array.from(document.getElementsByTagName("section")).forEach((function(t){t.style.display="none"})),n.pathAlreadySet||T.setPath(function(t,e){return e&&"import"===e.type?e.enclosingParagraph.path:t}(t,e)),function(t){var e=document.querySelector("#_canopy h1");e&&e.remove();var n=document.createElement("h1"),a=P(t);Array.from(a).forEach((function(t){n.appendChild(t)})),b.prepend(n)}(y.pageRoot.displayTopicName),document.title=t.firstTopic,k.select(e),N(t.paragraph),void window.scrollTo(0,b.scrollHeight)):function(t,e){if(console.log("No section element found for path: ",JSON.stringify(t.toString())),console.log("Trying: ",JSON.stringify(t.withoutLastSegment)),t.length>1)return B(t.withoutLastSegment,null,e);throw"Invalid path: "+t.array}(t,n)};function D(t){return function(e){var n;e.preventDefault(),n=e.altKey?t.isOpen?t.enclosingParagraph.path:t.pathToDisplay:T.forSegment(t.targetTopic,t.targetSubtopic),e.metaKey?window.open(location.origin+n.string,"_blank"):q(n)}}const O={};function _(t,e){t.forEach((function(t){e.appendChild(t)}))}const I=function(t,e){return"text"===t.type?function(t){var e=document.createElement("SPAN");return _(P(t.text),e),e}(t):"local"===t.type?function(t,e){return(0,e.localLinkSubtreeCallback)(t),function(t){var e,n=document.createElement("a");return n.classList.add("canopy-selectable-link"),n.dataset.targetTopic=t.targetTopic,n.dataset.targetSubtopic=t.targetSubtopic,n.dataset.enclosingTopic=t.enclosingTopic,n.dataset.enclosingSubtopic=t.enclosingSubtopic,n.dataset.text=t.text,_(P(t.text),n),n.addEventListener("click",(t.targetTopic,t.targetSubtopic,e=new k(n),function(t){t.preventDefault();var n,a=e.enclosingParagraph.path;n=e.isOpen?a.replaceTerminalSubtopic(e.enclosingParagraph.subtopicName):a.replaceTerminalSubtopic(e.targetSubtopic),q(n)})),n.classList.add("canopy-local-link"),n.dataset.type="local",n.href="/".concat(x(t.targetTopic),"#").concat(x(t.enclosingSubtopic)),n}(t)}(t,e):"global"===t.type?function(t,e){e.pathArray,e.subtopicName;var n=e.globalLinkSubtreeCallback,a=function(t){var e=document.createElement("a");return _(P(t.text),e),e.classList.add("canopy-global-link"),e.classList.add("canopy-selectable-link"),e.dataset.type="global",e.dataset.targetTopic=t.targetTopic,e.dataset.targetSubtopic=t.targetSubtopic,e.dataset.enclosingTopic=t.enclosingTopic,e.dataset.enclosingSubtopic=t.enclosingSubtopic,e.dataset.text=t.text,e.href="/".concat(x(t.targetTopic),"#").concat(x(t.targetSubtopic)),e.addEventListener("click",D(new k(e))),e}(t);return n(t,a),a}(t,e):"import"===t.type?function(t,e){return e.pathArray,e.subtopicName,e.globalLinkSubtreeCallback,function(t){var e=document.createElement("a");return _(P(t.text),e),e.classList.add("canopy-global-link"),e.classList.add("canopy-selectable-link"),e.dataset.type="import",e.dataset.targetTopic=t.targetTopic,e.dataset.targetSubtopic=t.targetSubtopic,e.dataset.enclosingTopic=t.enclosingTopic,e.dataset.enclosingSubtopic=t.enclosingSubtopic,e.dataset.text=t.text,e.href="/".concat(x(t.targetTopic),"#").concat(x(t.targetSubtopic)),e.addEventListener("click",D(new k(e))),e}(t)}(t,e):"url"===t.type?function(t){var e=document.createElement("SPAN"),n=document.createElement("a");return e.classList.add("canopy-url-link-span"),n.classList.add("canopy-url-link"),n.classList.add("canopy-selectable-link"),n.setAttribute("href",t.url),_(P(t.text),n),n.dataset.type="url",n.dataset.text=t.text,e.appendChild(n),n.innerHTML+='<svg xmlns:svg="http://www.w3.org/2000/svg"\n   xmlns="http://www.w3.org/2000/svg"\n   version="1.0"\n   width="12"\n   height="12"\n   id="svg2">\n  <defs id="defs4"></defs>\n  <rect\n     width="5.9999995"\n     height="6"\n     x="1.5"\n     y="4.5"\n     id="rect3170"\n     style="fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:#0066cc;stroke-width:0.99999994;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"></rect>\n  <path\n     d="M 4,2.5 L 5,3.5 L 5.25,4.25 L 2.75,6.5 L 5.5,9.25 L 7.75,6.75 L 8.5,7 L 9.5,8 L 11,6.5 L 11,1 L 5.5,1 L 4,2.5 z"\n     id="path2395"\n     style="fill:#0066ff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"></path>\n  <path\n     d="M 6,2 L 10,2 L 10,6 L 9.5,6.75 L 8.25,4.75 L 5.25,8 L 4,6.75 L 7.25,3.75 L 5.25,2.5 L 6,2 z"\n     id="path2398"\n     style="fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" ></path>\n</svg>\n'.replace(/\r?\n|\r/g,""),e}(t):"image"===t.type?function(t){var e=document.createElement("DIV");e.classList.add("canopy-image-div");var n=document.createElement("IMG");e.appendChild(n),n.setAttribute("src",t.resourceUrl);var a=document.createElement("A");if(a.setAttribute("href",t.anchorUrl||t.resourceUrl),a.appendChild(n),e.appendChild(a),t.title){n.setAttribute("title",t.title);var i=document.createElement("SUP"),r=document.createElement("DIV");i.appendChild(document.createTextNode(t.title)),i.classList.add("canopy-image-caption"),r.classList.add("canopy-caption-div"),e.appendChild(i)}else e.appendChild(a);return t.altText&&n.setAttribute("alt",t.altText),e}(t):"html"===t.type?function(t){var e=document.createElement("DIV");return e.innerHTML=t.html,e.classList.add("canopy-raw-html"),e}(t):"footnote"===t.type?function(t){var e=document.createElement("SUP"),n=document.createTextNode(t.text);return e.appendChild(n),e}(t):void 0},j={text:function(t,e){var n=[];return t.tokensByLine.forEach((function(t,a){var i=document.createElement("SPAN");i.classList.add("canopy-text-span"),n.push(i),t.forEach((function(t){var n=I(t,e);i.appendChild(n)}))})),n},code:function(t,e){var n=document.createElement("PRE"),a=document.createElement("CODE");return n.appendChild(a),t.lines.forEach((function(t,e){e>0&&a.appendChild(document.createElement("BR"));var n=document.createTextNode(t);a.appendChild(n)})),[n]},quote:function(t,e){var n=document.createElement("BLOCKQUOTE");return t.tokensByLine.forEach((function(t,a){a>0&&n.appendChild(document.createElement("br")),t.forEach((function(t){var a=I(t,e);n.appendChild(a)}))})),[n]},list:function(t,e){return function n(a){var i=t.topLevelNodes[0].ordered?document.createElement("OL"):document.createElement("UL");return i.setAttribute("type",a[0].ordinal),a.forEach((function(t){var a=document.createElement("LI");if(t.tokensOfLine.forEach((function(t){var n=I(t,e);a.appendChild(n)})),t.children.length>0){var r=n(t.children);a.appendChild(r)}i.appendChild(a)})),i}(t.topLevelNodes)},table:function(t,e){var n=document.createElement("TABLE");return t.tokensByCellByRow.forEach((function(t,a){var i=document.createElement("TR");t.forEach((function(t){var n=document.createElement("TD");t.forEach((function(t){var a=I(t,e);n.appendChild(a)})),i.appendChild(n)})),n.appendChild(i)})),[n]},html:function(t,e){var n=t.tokensByLine.map((function(t,e){return t.map((function(t){return t.html}))})).join(""),a=document.createElement("DIV");return a.innerHTML=n,[a]},footnote:function(t,e){var n=document.createElement("HR");n.classList.add("footnote-rule");var a=Array.prototype.concat.apply([],t.footnoteObjects.map((function(t,n){var a=document.createElement("SPAN");a.classList.add("footnote-span");var i=document.createTextNode(t.superscript+". ");a.appendChild(i),t.tokens.forEach((function(t){var n=I(t,e);a.appendChild(n)}));var r=[];return n>0&&r.push(document.createElement("BR")),r.push(a),r})));return[n].concat(a)}};const F=function t(e){e.pathToDisplay;var n=e.subtopicName,a=e.paragraphsBySubtopic,i=function(t){var e=t.topicName,n=t.subtopicName,a=t.displayTopicName,i=t.pathDepth,r=document.createElement("section");r.classList.add("canopy-section");var o=document.createElement("p");return o.classList.add("canopy-paragraph"),r.appendChild(o),r.style.display="none",r.dataset.topicName=e,r.dataset.displayTopicName=a,r.dataset.subtopicName=n,r.dataset.pathDepth=i,e===n&&(i>0&&r.prepend(document.createElement("hr")),r.classList.add("canopy-topic-section")),r}(e);e.promises=[],e.localLinkSubtreeCallback=function(e,n){return function(a){var i=t(Object.assign({},n,{subtopicName:a.targetSubtopic,placeHolderElement:null}));i.then((function(t){e.appendChild(t)})),n.promises.push(i)}}(i,e),e.globalLinkSubtreeCallback=function(t,e){var n=e.pathToDisplay,a=(e.pathDepth,e.subtopicName),i=e.promises;return function(e,r){if(function(t){if(!O[t]){var e=C+"/_data/"+x(t.toLowerCase())+".json";fetch(e).then((function(e){return e.json().then((function(e){return O[t]=e,e}))}))}}(e.targetTopic),function(t,e,n){var a=e.firstSubtopic,i=e.secondTopic,r=e.secondTopic,o=r,c=t.dataset.targetTopic===r&&t.dataset.targetSubtopic===o;return i&&c&&n===a}(r,n,a)){var o=n.withoutFirstSegment,c=G(o,t);i.push(c)}}}(i,e);var r=function(t,e){var n=[];return t.forEach((function(t){var a=(0,j[t.type])(t,e);n=n.concat(a)})),n}(a[n],e);return r.forEach((function(t){new y(i).paragraphElement.appendChild(t)})),Promise.all(e.promises).then((function(t){return i}))},G=function t(e,n){if(0===e.length)return Promise.resolve(null);var a=T.elementAtRelativePath(e.firstSegment,n);return a?(T.validateConnectingLink(n,e),t(e.withoutFirstSegment,a)):function(t){if(O[t])return Promise.resolve(O[t]);var e=C+"/_data/"+x(t)+".json";return fetch(e).then((function(e){return e.json().then((function(e){return O[t]=e,e}))})).catch((function(e){return 0===b.childNodes.length&&t!==v&&q(T.default),Promise.reject("Unrecognized path: "+t)}))}(e.firstTopic).then((function(t){var a=t.paragraphsBySubtopic,i=t.displayTopicName;return F({topicName:e.firstTopic,subtopicName:e.firstTopic,pathToDisplay:e,displayTopicName:i,paragraphsBySubtopic:a,pathDepth:Number(n.dataset.pathDepth)+1||0})})).then((function(t){return n.appendChild(t)}))},q=function(t,e,n){return function(t,e){if(!(t instanceof T))throw"Invalid path argument";if(e&&!(e instanceof k))throw"Invalid link selection argument"}(t,e),G(t,b).then((function(){B(t,e,n)}))};function M(t){var e=k.selection;if(t){var n=e.enclosingParagraph.topicParagraph.parentLink;return q(n.pathToDisplay,n)}return e.enclosingParagraph.equals(y.pageRoot)?q(e.enclosingParagraph.path):q(e.parentLink.pathToDisplay,e.parentLink)}function R(){T.current;var t=k.selection;if(t.isParent){if(t.isImport)return q(t.pathToDisplay,t.targetParagraph.parentLink);var e=t.targetParagraph.firstLink||t.targetParagraph.parentLink;return q(e.pathToDisplay,e)}}function U(){var t=k.selection.previousSibling||k.selection.lastSibling;return q(t.pathToDisplay,t)}function z(){var t=k.selection.nextSibling||k.selection.firstSibling;return q(t.pathToDisplay,t)}function W(t,e){if(k.selection.isLocal)return R();if(k.selection.isGlobalOrImport&&e)return R();if(k.selection.isGlobalOrImport&&!e){var n=k.selection.targetPath.lastSegment;return t?window.open(location.origin+n.string,"_blank"):q(n,k.selectALink).catch((function(t){console.error("No link on new page to select"),q(n)}))}if("url"===k.selection.type){if(t)return window.open(k.selection.element.href,"_blank");window.location=k.selection.element.href}}function J(t){var e=k.selection;if(e.isLocal&&e.isClosed)return q(T.current.replaceTerminalSubtopic(e.targetSubtopic),e.firstChildLink||e);if(e.isLocal&&e.isClosed&&!e.targetParagraph.hasLinks)return q(T.current.replaceTerminalSubtopic(e.targetSubtopic),e.parentLink.nextSibling||e.grandParentLink);if(e.isGlobalOrImport){var n=e.parentLink.nextSibling||e.grandParentLink;return q(n.enclosingParagraph.path,{linkToSelect:n})}return 1===t&&e.nextSibling&&!e.nextSibling.equals(e)?q(e.nextSibling.enclosingParagraph.path,e.nextSibling):-1===t&&e.previousSibling&&!e.previousSibling.equals(e)?q(e.nextSibling.enclosingParagraph.path,e.previousSibling):1===t&&e.topicParagraph.lastLink?q(T.current,e.firstSibling):-1===t&&e.topicParagraph.firstLink?q(T.current,e.lastSibling):void 0}var H={left:U,up:M,down:R,right:z,"alt-up":M.bind(null,!0),h:U,j:R,k:M,l:z,escape:function(){return q(T.current)},z:function(){var t=k.selection,e=t.localPathWhenSelected,n=new k((function(){return t.atNewPath(e)}));return q(e,n)},return:W,"command-return":W.bind(null,!0),"alt-return":W.bind(null,!1,!0),"command-alt-return":W.bind(null,!0,!0),tab:J.bind(null,1),"shift-tab":J.bind(null,-1)},K={37:"left",39:"right",38:"up",40:"down",71:"g",72:"h",75:"k",74:"j",76:"l",186:";",90:"z",13:"return",9:"tab",27:"escape",192:"`",49:"1",50:"2",51:"3",52:"4",53:"5"};window.addEventListener("keydown",(function(t){var e=(t.metaKey?"command-":"")+(t.altKey?"alt-":"")+(t.ctrlKey?"ctrl-":"")+(t.shiftKey?"shift-":""),n=K[t.keyCode],a=e+n;"tab"===n&&t.preventDefault(),k.selection?(H[a]||function(){})():H[a]&&q(T.current,k.selectALink())})),window.addEventListener("popstate",(function(t){k.persistInHistory(k.selection),k.persistInSession(k.selection);var e=k.selectionPresentInEvent(t)?new k(t.state):null;q(T.current,e||k.sessionSelection,{pathAlreadySet:!0})})),q(T.initial,k.priorSelection)})()})();
//# sourceMappingURL=canopy.js.map
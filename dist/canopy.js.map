{"version":3,"file":"canopy.js","mappings":"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","sources":["webpack:///./bin/commands/shared/remove_style_characters.js","webpack:///./bin/commands/shared/topic.js","webpack:///./client/style/canopy.scss","webpack:///./node_modules/css-loader/dist/runtime/api.js","webpack:///./node_modules/css-loader/dist/runtime/sourceMaps.js","webpack:///./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack:///./node_modules/style-loader/dist/runtime/insertBySelector.js","webpack:///./node_modules/style-loader/dist/runtime/insertStyleElement.js","webpack:///./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js","webpack:///./node_modules/style-loader/dist/runtime/styleDomAPI.js","webpack:///./node_modules/style-loader/dist/runtime/styleTagTransform.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/compat get default export","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/nonce","webpack:///./client/style/canopy.scss?ec98","webpack:///./client/helpers/getters.js","webpack:///./client/requests/request_cache.js","webpack:///./client/models/link.js","webpack:///./client/models/paragraph.js","webpack:///./client/models/path.js","webpack:///./client/requests/request_json.js","webpack:///./client/render/click_handlers.js","webpack:///./client/assets/external_link_icon/icon.svg","webpack:///./client/render/render_styled_text.js","webpack:///./client/render/render_token_element.js","webpack:///./client/render/render_dom_tree.js","webpack:///./client/render/fetch_and_render_path.js","webpack:///./client/display/helpers.js","webpack:///./client/display/display_path.js","webpack:///./client/display/update_view.js","webpack:///./client/keys/key_handlers.js","webpack:///./client/keys/register_key_listeners.js","webpack:///./client/history/register_pop_state_listener.js","webpack:///./client/canopy.js"],"sourcesContent":["/*\nThis function removes style characters from a string, eg '*_a_* -> 'a'\nIn order to remove multiple layers of wrapping, eg *_a_*, each call removes the outermost layer,\n  then, if there was a difference between the previous value and this one, we try once more.\n  If there was no difference, then we have run out of style tokens and can return.\n*/\n\nfunction removeStyleCharacters(string) {\n  let newString = string.replace(/(^|(?:.?[^\\S])+)([_`*~])((?:.*?\\S))\\2(\\W+|$)/, '$1$3$4');\n  if (newString !== string) {\n    return removeStyleCharacters(newString);\n  } else {\n    return string;\n  }\n}\n\nmodule.exports = removeStyleCharacters;\n","let removeStyleCharacters = require('./remove_style_characters');\n\nclass Topic {\n  // There are several permutations of the topic key:\n  // There is the \"display\" topic, this is the string precisely as it appears in the expl file\n  // There is a \"mixed case\" topic, which is the displayTopic sans style characters * _ ~ ` and a trailing question mark.\n  // There is an all caps topic, this is the mixed case topic but all caps, used for case-insensitive matching\n  // Filenames are the mixed case topic name sans characters that cause problems in file paths, like quotation marks.\n  // The fromMixedCase argument is when the topic class is instantiated with an already-mixed-case topic to avoid double processing\n  constructor(string, fromMixedCase) {\n    this.display = fromMixedCase ? null : string;\n    this.mixedCase = fromMixedCase ? string : removeStyleCharacters(string).replace(/\\\\/g, '');\n    this.escapedMixedCase = this.mixedCase.replace(/\"/g, '\\\\\"').replace(/'/g, \"\\\\'\");\n    this.slug = this.mixedCase.replace(/_/g, '%255f').replace(/ /g, '_');\n    this.encodedSlug = this.slug.replace(/#/g, '%23');\n    this.caps = this.mixedCase.toUpperCase().replace(/\\?$/, '').replace(/\"/g, '').replace(/'/g, '');\n    this.fileName = this.slug.replace(/\\\\/g, '');\n    this.requestFileName = encodeURIComponent(this.slug);\n    this.capsFile = this.fileName.toUpperCase();\n  }\n}\n\nmodule.exports = Topic;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"#_canopy{padding-top:15px;padding-bottom:55px}#_canopy h1{text-align:center;margin:auto;width:40%;margin-top:10px}#_canopy hr{width:9%;display:block;height:1px;border:0;border-top:5px solid #ccc;margin:0px auto;padding-bottom:30px}#_canopy section.canopy-topic-section{padding-top:40px}#_canopy section.canopy-selected-section{padding-bottom:60vh}#_canopy section{padding-top:30px}#_canopy p{overflow:hidden;font-size:22px;max-width:700px;margin:auto;line-height:1.3;letter-spacing:-0.003em;font-weight:400}#_canopy a.canopy-selectable-link{text-decoration:underline #ddd;color:#000;cursor:pointer}#_canopy a.canopy-selectable-link:hover{text-decoration:underline}#_canopy a.canopy-selectable-link:focus{outline:0}#_canopy a.canopy-selectable-link.canopy-open-link{text-shadow:.8px 0px 0px #000;text-decoration:underline}#_canopy a.canopy-selectable-link.canopy-selected-link{background-color:#edeefc;text-shadow:0px 0px 0px #000;text-decoration:none}#_canopy a.canopy-selectable-link.canopy-selected-link:hover{text-decoration:underline}#_canopy span.canopy-text-span{display:block}#_canopy hr.canopy-footnote-rule{width:700px;display:block;height:1px;border:0;border-top:1px solid #ccc;margin:12px 0;padding:0}#_canopy sup{font-size:60%;padding:2px}#_canopy .canopy-footnote-span{font-size:80%}#_canopy blockquote{margin:7px 10px;background-color:#eff0f1;padding:5px;font-size:90%}#_canopy blockquote a.canopy-selectable-link{text-decoration:underline #d3d3d3}#_canopy pre{margin:7px 10px;background-color:#eff0f1;padding:5px;font-size:85%}#_canopy code{background-color:#eff0f1;font-size:90%}#_canopy table{margin:7px auto;table-layout:fixed;width:70%;border-collapse:collapse;border:2px solid #000}#_canopy table td,#_canopy table th{border:2px solid #000;text-align:center;padding:6px}#_canopy .canopy-image{width:220px;max-height:250px}#_canopy div.canopy-image-div{float:right;border:1px solid #c8ccd1;padding:3px;background-color:#f8f9fa;font-size:94%;text-align:center;overflow:hidden;margin:10px}#_canopy div.canopy-image-div>sup{display:block}#_canopy .canopy-url-link-span>svg{height:15px;width:12px;display:none}#_canopy .canopy-selected-link+svg,#_canopy .canopy-url-link-span:hover>svg{display:inline;vertical-align:middle}#_canopy ol,#_canopy ul{margin:7px 10px}#_canopy div.canopy-raw-html{display:inline}#_canopy>section.canopy-topic-section{padding-top:30px}\", \"\",{\"version\":3,\"sources\":[\"webpack://./client/style/canopy.scss\"],\"names\":[],\"mappings\":\"AAAA,SACE,gBAAA,CACA,mBAAA,CAEA,YACE,iBAAA,CACA,WAAA,CACA,SAAA,CACA,eAAA,CAGF,YACE,QAAA,CACA,aAAA,CACA,UAAA,CACA,QAAA,CACA,yBAAA,CACA,eAAA,CACA,mBAAA,CAGF,sCACE,gBAAA,CAGF,yCAME,mBAAA,CAGF,iBACE,gBAAA,CAGF,WACE,eAAA,CACA,cAAA,CACA,eAAA,CACA,WAAA,CAEA,eAAA,CACA,uBAAA,CACA,eAAA,CAKF,kCACE,8BAAA,CACA,UAAA,CACA,cAAA,CAEA,wCACE,yBAAA,CAGF,wCACE,SAAA,CAGF,mDACE,6BAAA,CACA,yBAAA,CAGF,uDACE,wBAAA,CACA,4BAAA,CACA,oBAAA,CAEA,6DACE,yBAAA,CAiBN,+BACE,aAAA,CAGF,iCACE,WAAA,CACA,aAAA,CACA,UAAA,CACA,QAAA,CACA,yBAAA,CACA,aAAA,CACA,SAAA,CAGF,aACE,aAAA,CACA,WAAA,CAGF,+BACE,aAAA,CAGF,oBACE,eAAA,CACA,wBAAA,CACA,WAAA,CACA,aAAA,CAEA,6CACE,iCAAA,CAIJ,aACE,eAAA,CACA,wBAAA,CACA,WAAA,CACA,aAAA,CAGF,cACE,wBAAA,CACA,aAAA,CAGF,eACE,eAAA,CACA,kBAAA,CACA,SAAA,CACA,wBAAA,CACA,qBAAA,CAEA,oCACE,qBAAA,CACA,iBAAA,CACA,WAAA,CAIJ,uBACE,WAAA,CACA,gBAAA,CAGF,8BACE,WAAA,CACA,wBAAA,CACA,WAAA,CACA,wBAAA,CACA,aAAA,CACA,iBAAA,CACA,eAAA,CACA,WAAA,CAGF,kCACE,aAAA,CAGF,mCACE,WAAA,CACA,UAAA,CACA,YAAA,CAGF,4EACE,cAAA,CACA,qBAAA,CAGF,wBACE,eAAA,CAGF,6BACE,cAAA,CAIJ,sCACE,gBAAA\",\"sourcesContent\":[\"#_canopy {\\n  padding-top: 15px;\\n  padding-bottom: 55px;\\n\\n  h1 {\\n    text-align: center;\\n    margin: auto;\\n    width: 40%;\\n    margin-top: 10px;\\n  }\\n\\n  hr {\\n    width: 9%;\\n    display: block;\\n    height: 1px;\\n    border: 0;\\n    border-top: 5px solid #ccc;\\n    margin: 0px auto;\\n    padding-bottom: 30px;\\n  }\\n\\n  section.canopy-topic-section {\\n    padding-top: 40px;\\n  }\\n\\n  section.canopy-selected-section {\\n    /* Removing DOM elements from the bottom of the screen can force the page to scroll upward to the existing elements\\n    which is not animated. If we keep a padding on the bottom of the last element just beyond the viewport, then\\n    removal of elements from the bottom of the visible stack never brings the real bottom of the page into view, and so\\n    the scroll upwards can be animated using the window.scrollTo method. */\\n\\n    padding-bottom: calc(60vh);\\n  }\\n\\n  section {\\n    padding-top: 30px;\\n  }\\n\\n  p {\\n    overflow: hidden;\\n    font-size: 22px;\\n    max-width: 700px;\\n    margin: auto;\\n\\n    line-height: 1.3;\\n    letter-spacing: -.003em;\\n    font-weight: 400;\\n  }\\n\\n///////////// Link styles /////////////////\\n\\n  a.canopy-selectable-link {\\n    text-decoration: underline #DDDDDD;\\n    color: black;\\n    cursor: pointer;\\n\\n    &:hover {\\n      text-decoration: underline;\\n    }\\n\\n    &:focus {\\n      outline:0;\\n    }\\n\\n    &.canopy-open-link {\\n      text-shadow: .8px 0px 0px #000000;\\n      text-decoration: underline;\\n    }\\n\\n    &.canopy-selected-link {\\n      background-color: #edeefc;\\n      text-shadow: 0px 0px 0px #000000;\\n      text-decoration: none;\\n\\n      &:hover {\\n        text-decoration: underline;\\n      }\\n    }\\n\\n    /*\\n    &.canopy-dfs-previously-selected-link {\\n      color: #ff0000 !important;\\n    }\\n\\n    &.canopy-reverse-dfs-previously-selected-link {\\n      color: #0000ff !important;\\n    }\\n    */\\n  }\\n\\n/////////////////////////////////////////////\\n\\n  span.canopy-text-span {\\n    display: block;\\n  }\\n\\n  hr.canopy-footnote-rule {\\n    width: 700px;\\n    display: block;\\n    height: 1px;\\n    border: 0;\\n    border-top: 1px solid #ccc;\\n    margin: 12px 0;\\n    padding: 0;\\n  }\\n\\n  sup {\\n    font-size: 60%;\\n    padding: 2px;\\n  }\\n\\n  .canopy-footnote-span {\\n    font-size: 80%;\\n  }\\n\\n  blockquote {\\n    margin: 7px 10px;\\n    background-color: #eff0f1;\\n    padding: 5px;\\n    font-size: 90%;\\n\\n    a.canopy-selectable-link {\\n      text-decoration: underline #D3D3D3;\\n    }\\n  }\\n\\n  pre {\\n    margin: 7px 10px;\\n    background-color: #eff0f1;\\n    padding: 5px;\\n    font-size: 85%;\\n  }\\n\\n  code {\\n    background-color: #eff0f1;\\n    font-size: 90%;\\n  }\\n\\n  table {\\n    margin: 7px auto;\\n    table-layout: fixed;\\n    width: 70%;\\n    border-collapse: collapse;\\n    border: 2px solid black;\\n\\n    td, th {\\n      border: 2px solid black;\\n      text-align: center;\\n      padding: 6px;\\n    }\\n  }\\n\\n  .canopy-image {\\n    width: 220px;\\n    max-height: 250px;\\n  }\\n\\n  div.canopy-image-div {\\n    float: right;\\n    border: 1px solid #c8ccd1;\\n    padding: 3px;\\n    background-color: #f8f9fa;\\n    font-size: 94%;\\n    text-align: center;\\n    overflow: hidden;\\n    margin: 10px;\\n  }\\n\\n  div.canopy-image-div > sup {\\n    display: block;\\n  }\\n\\n  .canopy-url-link-span > svg {\\n    height: 15px;\\n    width: 12px;\\n    display: none;\\n  }\\n\\n  .canopy-selected-link + svg, .canopy-url-link-span:hover > svg {\\n    display: inline;\\n    vertical-align: middle;\\n  }\\n\\n  ol, ul {\\n    margin: 7px 10px;\\n  }\\n\\n  div.canopy-raw-html {\\n    display: inline;\\n  }\\n}\\n\\n#_canopy > section.canopy-topic-section {\\n  padding-top: 30px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var k = 0; k < this.length; k++) {\n        var id = this[k][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _k = 0; _k < modules.length; _k++) {\n      var item = [].concat(modules[_k]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (item) {\n  var content = item[1];\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (typeof btoa === \"function\") {\n    var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(cssMapping))));\n    var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n    var sourceMapping = \"/*# \".concat(data, \" */\");\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || \"\").concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join(\"\\n\");\n  }\n\n  return [content].join(\"\\n\");\n};","\"use strict\";\n\nvar stylesInDOM = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDOM.length; i++) {\n    if (stylesInDOM[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var indexByIdentifier = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3],\n      supports: item[4],\n      layer: item[5]\n    };\n\n    if (indexByIdentifier !== -1) {\n      stylesInDOM[indexByIdentifier].references++;\n      stylesInDOM[indexByIdentifier].updater(obj);\n    } else {\n      var updater = addElementStyle(obj, options);\n      options.byIndex = i;\n      stylesInDOM.splice(i, 0, {\n        identifier: identifier,\n        updater: updater,\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction addElementStyle(obj, options) {\n  var api = options.domAPI(options);\n  api.update(obj);\n\n  var updater = function updater(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap && newObj.supports === obj.supports && newObj.layer === obj.layer) {\n        return;\n      }\n\n      api.update(obj = newObj);\n    } else {\n      api.remove();\n    }\n  };\n\n  return updater;\n}\n\nmodule.exports = function (list, options) {\n  options = options || {};\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDOM[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDOM[_index].references === 0) {\n        stylesInDOM[_index].updater();\n\n        stylesInDOM.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\nvar memo = {};\n/* istanbul ignore next  */\n\nfunction getTarget(target) {\n  if (typeof memo[target] === \"undefined\") {\n    var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n    if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n      try {\n        // This will throw an exception if access to iframe is blocked\n        // due to cross-origin restrictions\n        styleTarget = styleTarget.contentDocument.head;\n      } catch (e) {\n        // istanbul ignore next\n        styleTarget = null;\n      }\n    }\n\n    memo[target] = styleTarget;\n  }\n\n  return memo[target];\n}\n/* istanbul ignore next  */\n\n\nfunction insertBySelector(insert, style) {\n  var target = getTarget(insert);\n\n  if (!target) {\n    throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n  }\n\n  target.appendChild(style);\n}\n\nmodule.exports = insertBySelector;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction insertStyleElement(options) {\n  var element = document.createElement(\"style\");\n  options.setAttributes(element, options.attributes);\n  options.insert(element, options.options);\n  return element;\n}\n\nmodule.exports = insertStyleElement;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction setAttributesWithoutAttributes(styleElement) {\n  var nonce = typeof __webpack_nonce__ !== \"undefined\" ? __webpack_nonce__ : null;\n\n  if (nonce) {\n    styleElement.setAttribute(\"nonce\", nonce);\n  }\n}\n\nmodule.exports = setAttributesWithoutAttributes;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction apply(styleElement, options, obj) {\n  var css = \"\";\n\n  if (obj.supports) {\n    css += \"@supports (\".concat(obj.supports, \") {\");\n  }\n\n  if (obj.media) {\n    css += \"@media \".concat(obj.media, \" {\");\n  }\n\n  var needLayer = typeof obj.layer !== \"undefined\";\n\n  if (needLayer) {\n    css += \"@layer\".concat(obj.layer.length > 0 ? \" \".concat(obj.layer) : \"\", \" {\");\n  }\n\n  css += obj.css;\n\n  if (needLayer) {\n    css += \"}\";\n  }\n\n  if (obj.media) {\n    css += \"}\";\n  }\n\n  if (obj.supports) {\n    css += \"}\";\n  }\n\n  var sourceMap = obj.sourceMap;\n\n  if (sourceMap && typeof btoa !== \"undefined\") {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  options.styleTagTransform(css, styleElement, options.options);\n}\n\nfunction removeStyleElement(styleElement) {\n  // istanbul ignore if\n  if (styleElement.parentNode === null) {\n    return false;\n  }\n\n  styleElement.parentNode.removeChild(styleElement);\n}\n/* istanbul ignore next  */\n\n\nfunction domAPI(options) {\n  var styleElement = options.insertStyleElement(options);\n  return {\n    update: function update(obj) {\n      apply(styleElement, options, obj);\n    },\n    remove: function remove() {\n      removeStyleElement(styleElement);\n    }\n  };\n}\n\nmodule.exports = domAPI;","\"use strict\";\n\n/* istanbul ignore next  */\nfunction styleTagTransform(css, styleElement) {\n  if (styleElement.styleSheet) {\n    styleElement.styleSheet.cssText = css;\n  } else {\n    while (styleElement.firstChild) {\n      styleElement.removeChild(styleElement.firstChild);\n    }\n\n    styleElement.appendChild(document.createTextNode(css));\n  }\n}\n\nmodule.exports = styleTagTransform;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","__webpack_require__.nc = undefined;","\n      import API from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./canopy.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/sass-loader/dist/cjs.js!./canopy.scss\";\n       export default content && content.locals ? content.locals : undefined;\n","const canopyContainer = document.getElementById('_canopy');\n\nconst defaultTopic = canopyContainer && canopyContainer.dataset.defaultTopic;\n\nconst projectPathPrefix = canopyContainer && canopyContainer.dataset.projectPathPrefix;\n\nconst hashUrls = canopyContainer && canopyContainer.dataset.hashUrls;\n\nfunction getAncestorElement(currentElement, className) {\n  let parentElement = currentElement.parentElement;\n  while (parentElement.classList && !parentElement.classList.contains(className)) {\n    if (parentElement === canopyContainer) return null;\n    parentElement = parentElement.parentNode;\n  }\n  return parentElement;\n}\n\nexport {\n  canopyContainer,\n  defaultTopic,\n  projectPathPrefix,\n  hashUrls,\n  getAncestorElement\n};\n","let REQUEST_CACHE = {};\n\nexport default REQUEST_CACHE;\n","import { getAncestorElement } from 'helpers/getters';\nimport Path from 'models/path';\nimport Paragraph from 'models/paragraph';\nimport Topic from '../../bin/commands/shared/topic';\n\nclass Link {\n  constructor(argument) {\n    // There are three ways to instantiate a link object:\n    // 1. You can provide a DOM element\n    // 2. You can provide a metadata object\n    //   (This is helpful when storing link selection in the session or history)\n    // 3. You can provide a callback that returns the link\n    //   (This is helpful for selecting links that are not yet rendered)\n\n    if (argument.tagName === 'A') {\n      this.element = argument;\n    } else if (argument instanceof Link) {\n      throw \"Cannot instantiate link from link\";\n    } else if (typeof argument === 'object') {\n      this.metadataObject = argument;\n    } else if (typeof argument === 'function') {\n      this.selectorCallback = argument;\n    } else {\n      throw 'Invalid argument to Link constructor';\n    }\n  }\n\n  equals(otherLink) {\n    return this.element === otherLink.element;\n  }\n\n  matches(otherLink) {\n    if (!otherLink) throw 'Invalid link argument to Link#matches';\n\n    return this.targetTopic === otherLink.targetTopic &&\n      this.targetSubtopic === otherLink.targetSubtopic &&\n      this.relativeLinkNumber === otherLink.relativeLinkNumber;\n  }\n\n  contradicts(path) {\n    if (!(path instanceof Path)) throw 'Invalid path argument to Link#contradicts';\n    return this.paragraphPathWhenSelected.string !== path.string;\n  }\n\n  get element () {\n    if (this.linkElement) {\n      return this.linkElement\n    } else if (this.metadataObject) {\n      this.element = Link.elementFromMetadata(this.metadata);\n      return this.linkElement;\n    } else if (this.selectorCallback) {\n      let link = this.selectorCallback();\n      if (!link) throw 'Link selector callback provided no link';\n      this.element = link.element;\n      return this.linkElement;\n    }\n  }\n\n  set element(argument) {\n    if (argument instanceof HTMLAnchorElement) {\n      this.linkElement = argument;\n    } else if (argument instanceof Link) {\n      this.linkElement = argument.element;\n    }\n    this.transferDataset();\n  }\n\n  transferDataset() {\n    // This is just to make it easier to inspect and debug DOM elements\n    // Getters are used instead of properties to allow lazy access for callback-specified links\n    if (!this.linkElement) return;\n    this._targetTopic = this.linkElement.dataset.targetTopic;\n    this._targetSubtopic = this.linkElement.dataset.targetSubtopic;\n    this._enclosingTopic = this.linkElement.dataset.enclosingTopic;\n    this._enclosingSubtopic = this.linkElement.dataset.enclosingSubtopic;\n    this._typeValue = this.linkElement.dataset.type;\n  }\n\n  get targetTopic() {\n    return new Topic(this.element.dataset.targetTopic, true);\n  }\n  get targetSubtopic() {\n    return new Topic(this.element.dataset.targetSubtopic, true);\n  }\n  get enclosingTopic() {\n    return new Topic(this.element.dataset.enclosingTopic, true);\n  }\n  get enclosingSubtopic() {\n    return new Topic(this.element.dataset.enclosingSubtopic, true);\n  }\n\n  get topicName() {\n    throw 'Links have no topicName, only targetTopic or enclosingTopic';\n  }\n\n  get subtopicName() {\n    throw 'Links have no subtopicName, only targetSubtopic or enclosingSubtopic';\n  }\n\n  get type() {\n    return this.element.dataset.type;\n  }\n\n  get enclosingSectionElement() {\n    return getAncestorElement(this.element, 'canopy-section');\n  }\n\n  get sectionElement() {\n    throw \"Depreciated in favor of #enclosingSectionElement\";\n  }\n\n  get enclosingParagraphElement() {\n    return getAncestorElement(this.element, 'canopy-paragraph');\n  }\n\n  get parentParagraphElement() {\n    throw \"Depreciated in favor of #enclosingParagraphElement\";\n  }\n\n  get enclosingParagraph() {\n    return new Paragraph(this.enclosingSectionElement);\n  }\n\n  get targetParagraph() {\n    if (!this.isParent) return null;\n\n    let pathDepth = this.enclosingParagraph.pathDepth;\n    if (this.isGlobalOrImport) pathDepth = Number(pathDepth) + 1;\n\n    let sectionElement = this.enclosingParagraph.sectionElement.querySelector(\n        `section[data-topic-name=\"${this.targetTopic.escapedMixedCase}\"]` +\n        `[data-subtopic-name=\"${this.targetSubtopic.escapedMixedCase}\"]` +\n        `[data-path-depth=\"${pathDepth}\"`\n      );\n\n    if (!sectionElement) {\n      throw `Did not find paragraph child element matching link [${this.targetTopic}, ${this.targetSubtopic}]`;\n    }\n\n    return new Paragraph(sectionElement);\n  }\n\n  atNewPath(newPath) { // get link instantiated with callback that returns matching link at new path\n    return new Link(() => {\n      let newEnclosingParagraph;\n      if (this.isParent) {\n        newEnclosingParagraph = newPath.paragraph.parentParagraph;\n      } else {\n        newEnclosingParagraph = newPath.paragraph;\n      }\n      return newEnclosingParagraph\n        .links\n        .find(this.matcher);\n    });\n  }\n\n  get localPathWhenSelected() {\n    if (this.isGlobalOrImport) {\n      return new Path(this.paragraphPathWhenSelected.pathArray.slice(-2));\n    } else {\n      return this.paragraphPathWhenSelected.lastSegment;\n    }\n  }\n\n  get matcher() {\n    return (link) => link.matches(this);\n  }\n\n  get relativeLinkNumber() {\n    if (this.storedRelativeLinkNumber) return this.storedRelativeLinkNumber;\n    this.storedRelativeLinkNumber = this.\n      enclosingParagraph.\n      links.\n      map(e => e.element).\n      indexOf(this.element);\n\n    return this.storedRelativeLinkNumber;\n  }\n\n  /* eslint getter-return: \"off\" */\n  get metadata() {\n    if (this.metadataObject) {\n      return this.metadataObject;\n    } else if(this.linkElement) {\n      let metadata = Link.collectMetadata(this.linkElement);\n      this.metadataObject = metadata;\n      return metadata;\n    } else if (this.selectorCallback) {\n      this.element = this.selectorCallback();\n      return this.metadata; // now that there is a this.linkElement\n    } else {\n      throw \"Link has neither supplied metadata, dom element, nor selector function\";\n    }\n  }\n\n  get targetPath() {\n    if (this.isGlobalOrImport) {\n      return this.enclosingParagraph.path.addSegment(this.targetTopic, this.targetSubtopic);\n    } else if (this.isLocal) {\n      return this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic);\n    } else {\n      return null; // eg URL link\n    }\n  }\n\n  get path() {\n    throw \"Depreciated in favor of #paragraphPathWhenSelected\";\n  }\n\n  get pathToDisplay() {\n    throw \"Depreciated in favor of #paragraphPathWhenSelected\";\n  }\n\n  get paragraphPathWhenSelected() {\n    if (this.isGlobalOrImport) {\n      return this.enclosingParagraph.path.addSegment(this.targetTopic, this.targetSubtopic);\n    } else if (this.isLocal) {\n      return this.enclosingParagraph.path.replaceTerminalSubtopic(this.targetSubtopic);\n    } else {\n      return this.enclosingParagraph.path;\n    }\n  }\n\n  get urlPathWhenSelected() {\n    if (this.type === 'import') {\n      return this.enclosingParagraph.path;\n    } else {\n      return this.paragraphPathWhenSelected;\n    }\n  }\n\n  static collectMetadata(linkElement) {\n    let link = new Link(linkElement);\n    let paragraph = Paragraph.containingLink(link);\n\n    // changing the metadata schema requires changing Link#containsLinkSelectionMetadata\n    return {\n      pathString: paragraph.path.string, // initial page load with session/history link selection requires this\n      text: linkElement.dataset.text,\n      relativeLinkNumber: link.relativeLinkNumber\n    };\n  }\n\n  static containsLinkSelectionMetadata(object) {\n    return object.relativeLinkNumber !== undefined;\n  }\n\n  static elementFromMetadata(object) {\n    let path = new Path(object.pathString);\n    let paragraph = path.paragraph;\n    if (!paragraph) throw \"Link selection data refers to non-existant link\";\n    let link = paragraph.linkBySelector(\n      (link, i) => link.element.dataset.text === object.text &&\n        i === object.relativeLinkNumber\n    );\n\n    return link && link.element || null;\n  }\n\n  get nextSibling() {\n    let links = this.enclosingParagraph.links;\n    if (!this.equals(links[links.length - 1])) {\n      let linkElements = links.map((link) => link.element);\n      let indexOfCurrentLink = linkElements.indexOf(this.element);\n      return links[indexOfCurrentLink + 1];\n    } else {\n      return null;\n    }\n  }\n\n  get previousSibling() {\n    let links = this.enclosingParagraph.links;\n    if (!this.equals(links[0])) {\n      let linkElements = links.map((link) => link.element);\n      let indexOfCurrentLink = linkElements.indexOf(this.element);\n      return links[indexOfCurrentLink - 1];\n    } else {\n      return null;\n    }\n  }\n\n  get siblings() {\n    return this.enclosingParagraph.links;\n  }\n\n  get firstSibling() {\n    return this.siblings[0];\n  }\n\n  get lastSibling() {\n    return this.siblings[this.siblings.length - 1];\n  }\n\n  get firstChildLink() {\n    return this.targetParagraph.firstLink;\n  }\n\n  get lastChildLink() {\n    return this.targetParagraph.lastLink;\n  }\n\n  get parentLink() {\n    return this.enclosingParagraph.parentLink;\n  }\n\n  get grandParentLink() {\n    return this.parentLink?.parentLink;\n  }\n\n  get topicParagraph() {\n    return getAncestorElement(this.element, 'canopy-topic-section');\n  }\n\n  get selected() {\n    return this.element.classList.includes('canopy-selected-link');\n  }\n\n  open() {\n    this.element.classList.add('canopy-open-link');\n  }\n\n  get isOpen() {\n    return this.element.classList.contains('canopy-open-link');\n  }\n\n  get isClosed() {\n    return !this.isOpen;\n  }\n\n  get isSelected() {\n    return this.element.classList.contains('canopy-selected-link');\n  }\n\n  get isGlobal() {\n    return this.type === 'global';\n  }\n\n  get isImport() {\n    return this.type === 'import';\n  }\n\n  get isGlobalOrImport() {\n    return this.type === 'global' || this.type === 'import';\n  }\n\n  get isLocal() {\n    return this.type === 'local';\n  }\n\n  get isParent() {\n    return this.isGlobal || this.isLocal || this.isImport;\n  }\n\n  get hasChildren() {\n    return this.targetParagraph.hasLinks;\n  }\n\n  static select(linkToSelect) {\n    linkToSelect && linkToSelect.element.classList.add('canopy-selected-link');\n    Link.persistInHistory(linkToSelect);\n    Link.persistInSession(linkToSelect);\n  }\n\n  static selectionPresentInEvent(e) {\n    return e.state && Link.containsLinkSelectionMetadata(e.state);\n  }\n\n  static get sessionSelection() {\n    let sessionData = sessionStorage.getItem(Path.current.string);\n    if (sessionData && sessionData !== 'null') {\n      return new Link(JSON.parse(sessionData));\n    } else {\n      return null;\n    }\n  }\n\n  static get historySelection() {\n    if (history.state && Link.containsLinkSelectionMetadata(history.state)) {\n      return new Link(history.state);\n    } else {\n      return null;\n    }\n  }\n\n  static get priorSelection() {\n    return this.historySelection || this.sessionSelection || null;\n  }\n\n  static get selection() {\n    let selectedLink = document.querySelector('a.canopy-selected-link');\n    if (selectedLink) {\n      return new Link(selectedLink);\n    } else {\n      return null;\n    }\n  }\n\n  static persistInSession(link) {\n    // This has to be static because Link.selection hasn't always updated\n    // between when a new link is selected and when we want to persist that selection\n    let linkData = link && JSON.stringify(link.metadata);\n    sessionStorage.setItem(location.pathname + location.hash, linkData || null);\n  }\n\n  static persistInHistory(link) {\n    // This has to be static because Link.selection hasn't always updated\n    // between when a new link is selected and when we want to persist that selection\n    history.replaceState(\n      link && link.metadata || null,\n      document.title,\n      window.location.href\n    );\n  }\n\n  // selectALink returns a callback that will pick a link to select\n  // once the DOM has rendered.\n  //\n  // selectALink takes a path to clarify which path is intended in case\n  // there are multiple rendered in the DOM, and the path has not updated yet.\n\n  static selectALink(path) {\n    return new Link(() => {\n      path = path || Path.current;\n      let paragraph = path.paragraph;\n      return paragraph.firstLink || paragraph.parentLink;\n    });\n  }\n\n  static current() {\n    throw \"Link#current does not exist, try Link#selection\";\n  }\n}\n\nexport default Link;\n","import Path from 'models/path';\nimport Link from 'models/link';\nimport { canopyContainer } from 'helpers/getters';\nimport { getAncestorElement } from 'helpers/getters';\nimport Topic from '../../bin/commands/shared/topic';\n\nclass Paragraph {\n  // A paragraph instance represents a visible paragraph, not\n  // specifically the DOM element of type paragraph.\n  //\n  // Visible paragraphs in the UI are created with a section element\n  // that has a paragraph element child.\n  //\n  // paragraph.sectionElement returns the section element, whereas\n  // paragraph.paragraphElement returns the paragraph element.\n\n  constructor(sectionElement) {\n    if (!sectionElement || sectionElement.tagName !== 'SECTION' ) throw \"Paragraph instantiation requires section element\";\n    if (!sectionElement.classList.contains('canopy-section')) throw \"Paragraph class requires Canopy section element\";\n    this.sectionElement = sectionElement;\n    this.transferDataset();\n  }\n\n  equals(otherParagraph) {\n    if (!otherParagraph) return false;\n    return this.sectionElement === otherParagraph.sectionElement;\n  }\n\n  display() {\n    this.sectionElement.style.display = 'block';\n  }\n\n  get element() {\n    throw \"Depreciated in favor of #sectionElement property\";\n  }\n\n  transferDataset() {\n    this._topicName = this.sectionElement.dataset.topicName;\n    this._subtopicName = this.sectionElement.dataset.subtopicName;\n    this.pathDepth = this.sectionElement.dataset.pathDepth;\n  }\n\n  get topic () {\n    return new Topic(this.sectionElement.dataset.topicName, true);\n  }\n\n  get subtopic () {\n    return new Topic(this.sectionElement.dataset.subtopicName, true);\n  }\n\n  get topicName() {\n    console.trace();\n    throw \"Depreciated in favor of #topic\";\n  }\n\n  get subtopicName() {\n    console.trace();\n    throw \"Depreciated in favor of #subtopic\";\n  }\n\n  get paragraphElement() {\n    let paragraphElement = Array.from(this.sectionElement.childNodes).\n      find((element) => element.tagName === 'P');\n\n    if (!paragraphElement) throw \"Paragraph has no paragraph element\";\n    return paragraphElement;\n  }\n\n  get path() {\n    let pathArray = [];\n    let currentElement = this.sectionElement;\n    let currentParagraph = this;\n    let currentTopicParagraph = this.topicParagraph;\n\n    while (currentElement !== canopyContainer) {\n      currentTopicParagraph = currentParagraph.topicParagraph;\n\n      pathArray.unshift([\n        new Topic(currentElement.dataset.topicName),\n        new Topic(currentElement.dataset.subtopicName)\n      ]);\n\n      while (currentElement !== canopyContainer && currentParagraph.topicParagraph.equals(currentTopicParagraph)) {\n        currentElement = currentElement.parentNode;\n        if (currentElement !== canopyContainer) currentParagraph = new Paragraph(currentElement);\n      }\n    }\n\n    return new Path(pathArray);\n  }\n\n  get links() {\n    if (this.linkObjects) return this.linkObjects;\n    let linkElements = this.paragraphElement.querySelectorAll('a.canopy-selectable-link');\n    this.linkObjects = Array.from(linkElements).map((element) => new Link(element));\n    return this.linkObjects;\n  }\n\n  get firstLink() {\n    return this.links[0] || null;\n  }\n\n  get lastLink() {\n    return this.links[this.links.length - 1] || null;\n  }\n\n  get isPageRoot() {\n    return this.sectionElement.parentNode === canopyContainer\n  }\n\n  get isTopic() {\n    return this.topic.mixedCase === this.subtopic.mixedCase;\n  }\n\n  get hasLinks() {\n    return this.links.length > 0;\n  }\n\n  linkBySelector(callback) {\n    return this.links.find(callback);\n  }\n\n  linksBySelector(callback) {\n    return this.links.filter(callback);\n  }\n\n  linkByTarget(targetTopic, targetSubtopic) {\n    targetSubtopic = targetSubtopic || targetTopic;\n\n    return this.linkBySelector(\n      (link) => link.targetTopic.mixedCase === targetTopic.mixedCase && link.targetSubtopic.mixedCase === targetSubtopic.mixedCase\n    );\n  }\n\n  get parentLink() {\n    if (this.sectionElement.parentNode === canopyContainer) { return null; }\n\n    return this.parentParagraph && this.parentParagraph.linkByTarget(\n      this.topic,\n      this.subtopic\n    );\n  }\n\n  get parentLinks() {\n    if (this.sectionElement.parentNode === canopyContainer) { return null; }\n\n    return this.parentParagraph.linksBySelector(\n      link => {\n        return (link.isLocal || link.isGlobal) &&\n          this.topic.mixedCase === link.targetTopic.mixedCase &&\n          this.subtopic.mixedCase === link.targetSubtopic.mixedCase;\n      }\n    );\n  }\n\n  get ancestorImportReferences() {\n    if (this.pageRoot) { return []; }\n    if (!this.topicParagraph.parentParagraph) { return []; }\n\n    return this.topicParagraph.parentParagraph.linksBySelector(\n      link => {\n        return link.isImport &&\n          this.topic.mixedCase === link.targetTopic.mixedCase &&\n          this.subtopic.mixedCase === link.targetSubtopic.mixedCase;\n      }\n    );\n  }\n\n  get displayTopicName() {\n    return this.sectionElement.dataset.displayTopicName;\n  }\n\n  get parentParagraph() {\n    if (this.sectionElement) {\n      let parentElement = getAncestorElement(this.sectionElement, 'canopy-section');\n      return parentElement ? new Paragraph(parentElement) : null;\n    } else {\n      return null;\n    }\n  }\n\n  get topicParagraph() {\n    if (this.isTopic) {\n      return this;\n    } else {\n      return new Paragraph(getAncestorElement(this.sectionElement, 'canopy-topic-section'));\n    }\n  }\n\n  get isTopicRoot() {\n    return this.topicName === this.subtopicName;\n  }\n\n  static get current() {\n    return new Paragraph(document.querySelector('canopy-selected-section'));\n  }\n\n  select() {\n    this.sectionElement.classList.add('canopy-selected-section');\n  }\n\n  static get pageRoot() {\n    let path = Path.current.rootTopicPath;\n    return path.paragraph;\n  }\n\n  static containingLink(link) {\n    if (!(link instanceof Link)) throw \"Must provide link instance argument\";\n    let sectionElement = getAncestorElement(link.element, 'canopy-section');\n    return new Paragraph(sectionElement);\n  }\n\n}\n\nexport default Paragraph;\n","import { defaultTopic, canopyContainer, projectPathPrefix, hashUrls } from 'helpers/getters';\nimport Paragraph from 'models/paragraph';\nimport Topic from '../../bin/commands/shared/topic';\n\nclass Path {\n  constructor(argument) {\n    if (!argument) {\n      this.pathArray = [];\n    } else if (Array.isArray(argument)) {\n      if (argument.length === 0) {\n        this.pathArray = [];\n      } else {\n        this.pathArray = argument.slice();\n        Path.validatePathArray(this.pathArray);\n      }\n      this.pathString = Path.arrayToString(this.pathArray);\n    } else if (typeof argument === 'string' || argument instanceof String) {\n      this.pathString = argument;\n      this.pathArray = Path.stringToArray(argument);\n    }\n  }\n\n  equals(otherPath) {\n    return this.string === otherPath.string;\n  }\n\n  static validatePathArray(array) {\n    array.forEach(tuple => {\n      if (tuple.length !== 2) throw `Invalid path segment format: ${tuple}`;\n      if (!(tuple[0] instanceof Topic) || !(tuple[1] instanceof Topic)) throw `Invalid path segment format: ${tuple}`;\n    })\n  }\n\n  addSegment(topic, subtopic) {\n    if (this.empty) return new Path([[topic, subtopic]]);\n    return new Path(this.pathArray.concat([[topic, subtopic]]));\n  }\n\n  replaceTerminalSubtopic(newSubtopic) {\n    let lastSegment = this.lastSegment;\n    return this.withoutLastSegment.addSegment(lastSegment.firstTopic, newSubtopic);\n  }\n\n  toString() {\n    return this.string;\n  }\n\n  get array() {\n    return this.pathArray;\n  }\n\n  get string() {\n    return this.pathString;\n  }\n\n  get rootTopicPath() {\n    return new Path([[this.firstTopic, this.firstTopic]]);\n  }\n\n  get firstTopic() {\n    return this.pathArray[0][0];\n  }\n\n  get firstSubtopic() {\n    return this.pathArray[0][1];\n  }\n\n  get secondTopic() {\n    return this.pathArray[1] && this.pathArray[1][0];\n  }\n\n  get secondSubtopic() {\n    return this.pathArray[1] && this.pathArray[1][1];\n  }\n\n  get firstSegment() {\n    return new Path(this.pathArray.slice(0, 1));\n  }\n\n  get lastSegment() {\n    return new Path(this.pathArray.slice(-1));\n  }\n\n  get withoutFirstSegment() {\n    return new Path(this.pathArray.slice(1));\n  }\n\n  get withoutLastSegment() {\n    return new Path(this.pathArray.slice(0, -1));\n  }\n\n  get length() {\n    if (!this.pathArray[0]) {\n      return 0;\n    } else {\n      return this.pathArray.length;\n    }\n  }\n\n  get sectionElement() {\n    return Path.elementAtRelativePath(this, canopyContainer);\n  }\n\n  get paragraph() {\n    if (this.sectionElement) {\n      return new Paragraph(this.sectionElement);\n    } else {\n      return null;\n    }\n  }\n\n  get empty() {\n    return !this.pathArray[0];\n  }\n\n  static get default() {\n    let topic = new Topic(defaultTopic);\n    return new Path([[topic, topic]]);\n  }\n\n  static get current() {\n    let pathString = window.location.href.slice(window.location.origin.length)\n\n    if (projectPathPrefix && pathString.indexOf(`/${projectPathPrefix}`) === 0) {\n      pathString = pathString.slice(projectPathPrefix.length + 1);\n    }\n\n    if (pathString.indexOf('#/') === 0) pathString = pathString.slice(1);  // example.com[/#]/Topic\n\n    return new Path(pathString);\n  }\n\n  static get currentOrDefault() {\n    if (Path.current.empty) {\n      return Path.default;\n    } else {\n      return Path.current;\n    }\n  }\n\n  static forTopic(topic) {\n    return new Path([[topic, topic]]);\n  }\n\n  static forSegment(topic, subtopic) {\n    return new Path([[topic, subtopic]]);\n  }\n\n  static stringToArray(pathString) {\n    if (typeof pathString !== 'string') throw \"Function requires string argument\";\n\n    if (pathString.indexOf(projectPathPrefix) === 1) {\n      pathString = pathString.slice(projectPathPrefix.length + 1);\n    }\n\n    if (pathString === '/') {\n      return [];\n    }\n\n    let slashSeparatedUnits = pathString.\n      replace(/_/g, ' ').\n      split('/').\n      filter((string) => string !== '');\n\n    slashSeparatedUnits = Path.fixOrphanSubtopics(pathString, slashSeparatedUnits);\n\n    let pathArray = slashSeparatedUnits.map((slashSeparatedUnit) => {\n      // Capture two groups: (letters)#(optional_more_letters)\n      let match = slashSeparatedUnit.match(/([^#]*)(?:#([^#]*))?/);\n      return [\n        match[1] || match[2] || null,\n        match[2] || match[1] || null,\n      ];\n    }).filter((segment) => segment[0] !== null);\n\n    // we double decode URI components because we need to encode them in order to\n    // put certain characters in URLs, but characters like _ if encoded once to\n    // %5f will get converted automaticall to _ in the location, which on refresh\n    // is indistinguishable from a space having been converted to underscore, so URL\n    // construction is lossy without double encoding\n    pathArray = pathArray.map(([topicString, subtopicString]) => [\n      new Topic(decodeURIComponent(decodeURIComponent(topicString)), true),\n      new Topic(decodeURIComponent(decodeURIComponent(subtopicString)), true)\n    ]);\n\n    return pathArray;\n  }\n\n  static arrayToString(pathArray) {\n    if (!Array.isArray(pathArray)) throw 'Argument must be array';\n\n    if (Array.isArray(pathArray) && pathArray.length === 0) {\n      return '/';\n    }\n\n    if (!Array.isArray(pathArray[0])) {\n      throw 'Path array must be two-dimensional array';\n    }\n\n    let pathString = '/';\n\n    pathString += pathArray.map(([topic, subtopic]) => {\n      let pathSegmentString = topic.encodedSlug;\n      if (subtopic && subtopic.encodedSlug !== topic.encodedSlug) {\n        pathSegmentString += \"#\" + subtopic.encodedSlug;\n      }\n      return pathSegmentString;\n    }).join('/');\n\n    return pathString;\n  }\n\n  static fixOrphanSubtopics(pathString, slashSeparatedUnits) {\n    // Sometimes browsers insert forward slashes before the first pound sign which we have to remove\n    // eg /Topic/#Subtopic/A#B  -> /Topic#Subtopic/A#B\n\n    if (typeof pathString !== 'string') throw \"pathString must be a string argument\";\n    if (!Array.isArray(slashSeparatedUnits)) throw 'slashSeparatedUnits must be an array';\n\n    if (pathString.match(/\\/#\\w+/)) {\n      for (let i = 1; i < slashSeparatedUnits.length; i++) {\n        if (slashSeparatedUnits[i].match(/^#/)) {\n          if (!slashSeparatedUnits[i - 1].match(/#/)) { // eg /Topic/#Subtopic -> /Topic#Subtopic\n            let newItem = slashSeparatedUnits[i - 1] + slashSeparatedUnits[i];\n            let newArray = slashSeparatedUnits.slice(0, i - 1).\n              concat([newItem]).\n              concat(slashSeparatedUnits.slice(i + 1));\n            return newArray;\n          } else { // eg /Topic#Subtopic/#Subtopic2 -> /Topic#Subtopic/Subtopic2\n            let newItem = slashSeparatedUnits[i].slice(1);\n            let newArray = slashSeparatedUnits.slice(0, i).\n              concat([newItem]).\n              concat(slashSeparatedUnits.slice(i + 1));\n            return newArray;\n          }\n        }\n      }\n    }\n\n    return slashSeparatedUnits;\n  }\n\n  static connectingLinkValid(parentElement, pathToDisplay) {\n    if (!parentElement) throw 'Parent element required';\n    if (!(pathToDisplay instanceof Path)) throw 'pathToDisplay must be a Path object';\n\n    if (parentElement === canopyContainer) return true;\n\n    let parentParagraph = new Paragraph(parentElement);\n    if (!parentParagraph.linkByTarget(pathToDisplay.firstTopic)) {\n      console.error(`Parent element [${parentParagraph.topic.mixedCase}, ${parentParagraph.subtopic.mixedCase}] has no ` +\n        `connecting link to subsequent path segment [${pathToDisplay.firstTopic}, ${pathToDisplay.firstTopic}]`);\n      return false;\n    } else {\n      return true;\n    }\n  }\n\n  static elementAtRelativePath(suppliedPath, suppliedRootElement) {\n    if (!(suppliedPath instanceof Path)) throw 'pathToDisplay must be a Path object';\n    if (!suppliedRootElement || !suppliedRootElement.tagName) 'Root element must be a DOM node';\n\n    let rootElement = suppliedRootElement;\n    if (!suppliedRootElement) { rootElement = canopyContainer; }\n    let path = suppliedPath;\n\n    let currentNode = rootElement;\n    if (rootElement === canopyContainer) {\n      currentNode = rootElement.querySelector(\n        `[data-topic-name=\"${path.firstTopic.escapedMixedCase}\"]` +\n        `[data-subtopic-name=\"${path.firstSubtopic.escapedMixedCase}\"]` +\n        `[data-path-depth=\"${0}\"]`\n      );\n\n      if (path.length === 1) { return currentNode; }\n      if (!currentNode) return null;\n      path = path.withoutFirstSegment;\n    }\n\n    let subpath = path;\n    for (let i = 0; i < path.length; i++) {\n      let newPathDepth = Number(currentNode.dataset.pathDepth) + 1;\n      currentNode = currentNode.querySelector(\n        `[data-topic-name=\"${subpath.firstTopic.escapedMixedCase}\"]` +\n        `[data-subtopic-name=\"${subpath.firstSubtopic.escapedMixedCase}\"]` +\n        `[data-path-depth=\"${newPathDepth}\"]`\n      );\n\n      if (!currentNode) return null;\n      subpath = subpath.withoutFirstSegment;\n    }\n\n    return currentNode;\n  }\n\n  static setPath(newPath) {\n    if (!(newPath instanceof Path)) throw 'newPath must be Path object';\n\n    let oldPath = Path.current;\n    let documentTitle = newPath.firstTopic.display;\n    let historyApiFunction = newPath.equals(oldPath) ? replaceState : pushState;\n    let fullPathString = (projectPathPrefix ? `/${projectPathPrefix}` : '') + (hashUrls ? '/#' : '') + newPath.string;\n\n    historyApiFunction(\n      history.state, // this will be changed via Link#persistInHistory\n      documentTitle,\n      fullPathString\n    );\n\n    function replaceState(a, b, c) {\n      history.replaceState(a, b, c);\n    }\n\n    function pushState(a, b, c) {\n      history.pushState(a, b, c);\n    }\n  }\n}\n\nexport default Path;\n","import { canopyContainer, defaultTopic, projectPathPrefix } from 'helpers/getters';\nimport updateView from 'display/update_view';\nimport REQUEST_CACHE from 'requests/request_cache';\nimport Path from 'models/path';\n\nconst requestJson = (topic) => {\n  if (REQUEST_CACHE[topic.mixedCase]) return REQUEST_CACHE[topic.mixedCase];\n  let dataPath = projectPathPrefix + '/_data/' + topic.requestFileName + '.json';\n\n  let promise = fetch(dataPath).\n    then(res => {\n      return res.json().then((json) => {\n        return json;\n      });\n    }).catch(() => {\n      if (canopyContainer.childNodes.length === 0 && topic.mixedCase !== defaultTopic) {\n        updateView(Path.default);\n      }\n      return Promise.reject(`Requesting invalid topic: \"${topic.mixedCase}\"`);\n    });\n\n  REQUEST_CACHE[topic.mixedCase] = promise;\n\n  return promise;\n}\n\nexport default requestJson;\n","import updateView from 'display/update_view';\nimport Path from 'models/path';\n\nfunction onLocalLinkClick(targetTopic, targetSubtopic, link) {\n  return (e) => {\n    e.preventDefault();\n    let newPath, linkToSelect;\n    let newTab = e.metaKey || e.ctrlKey; // mac vs linux and windows\n\n    if (newTab && !e.altKey) { // no zoom\n      return window.open(location.origin + link.targetPath.string, '_blank');\n    }\n\n    if (newTab && e.altKey) { // zoom\n      return window.open(location.origin + link.targetPath.lastSegment.string, '_blank');\n    }\n\n    if (!newTab && e.altKey) { //zoom\n      let path = link.targetPath.lastSegment;\n      return updateView(path, link.atNewPath(path));\n    }\n\n    if (!newTab && !e.altKey && link.isSelected) {\n      newPath = link.parentLink?.paragraphPathWhenSelected;\n      return updateView(newPath, linkToSelect);\n    }\n\n    if (!newTab && !e.altKey && !link.isSelected) {\n      newPath = link.paragraphPathWhenSelected;\n      linkToSelect = link;\n      return updateView(newPath, linkToSelect);\n    }\n  };\n}\n\nfunction onGlobalAndImportLinkClick (link) {\n  return (e) => {\n    e.preventDefault();\n    let path, linkToSelect;\n    let newTab = e.metaKey || e.ctrlKey; // mac vs linux and windows\n\n    if (!newTab && !e.altKey && link.isSelected) { // close global child\n      path = link.enclosingParagraph.path;\n      return updateView(path, linkToSelect)\n    }\n\n    if (!newTab && !e.altKey && !link.isSelected) { // open global child\n      path = link.paragraphPathWhenSelected;\n      linkToSelect = link;\n      return updateView(path, linkToSelect)\n    }\n\n    if (!newTab && e.altKey) { // Redirect to global child\n      path = Path.forSegment(link.targetTopic, link.targetSubtopic);\n      return updateView(path, linkToSelect)\n    }\n\n    if (newTab && !e.altKey) { // inline\n      path = link.paragraphPathWhenSelected; // open the link in new tab\n      return window.open(location.origin + path.string, '_blank');\n    }\n\n    if (newTab && e.altKey) {\n      path = Path.forSegment(link.targetTopic, link.targetSubtopic);\n      return window.open(location.origin + path.string, '_blank');\n    }\n  }\n}\n\nexport { onLocalLinkClick, onGlobalAndImportLinkClick };\n","export default \"<svg xmlns:svg=\\\"http://www.w3.org/2000/svg\\\"\\n   xmlns=\\\"http://www.w3.org/2000/svg\\\"\\n   version=\\\"1.0\\\"\\n   width=\\\"12\\\"\\n   height=\\\"12\\\"\\n   id=\\\"svg2\\\">\\n  <defs id=\\\"defs4\\\"></defs>\\n  <rect\\n     width=\\\"5.9999995\\\"\\n     height=\\\"6\\\"\\n     x=\\\"1.5\\\"\\n     y=\\\"4.5\\\"\\n     id=\\\"rect3170\\\"\\n     style=\\\"fill:#ffffff;fill-opacity:1;fill-rule:nonzero;stroke:#0066cc;stroke-width:0.99999994;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1\\\"></rect>\\n  <path\\n     d=\\\"M 4,2.5 L 5,3.5 L 5.25,4.25 L 2.75,6.5 L 5.5,9.25 L 7.75,6.75 L 8.5,7 L 9.5,8 L 11,6.5 L 11,1 L 5.5,1 L 4,2.5 z\\\"\\n     id=\\\"path2395\\\"\\n     style=\\\"fill:#0066ff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\\\"></path>\\n  <path\\n     d=\\\"M 6,2 L 10,2 L 10,6 L 9.5,6.75 L 8.25,4.75 L 5.25,8 L 4,6.75 L 7.25,3.75 L 5.25,2.5 L 6,2 z\\\"\\n     id=\\\"path2398\\\"\\n     style=\\\"fill:#ffffff;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1\\\" ></path>\\n</svg>\\n\";","function renderStyledText(text) {\n  let buffer = '';\n  let escaped = false;\n\n  let styleStack = [];\n\n  let stylesByText = {\n    '_': 'I',\n    '*': 'B',\n    '~': 'S',\n    '`': 'CODE'\n  }\n\n  let elements = [];\n  let styleParent;\n\n  text = text.replace(/{{(OPEN|CLOSE).}}/g, (match) => match.split('').join('\\\\')); // Escape actual style tokens in user input\n\n  text = text.replace(/(^|[\\s}_*`~]+)([`])(.*?[^\\\\])(\\2)(?=[\\s.,{*_`~]|$)/g, (_, characterBeforeCodeBlock, backtick, block, backtick2) => {\n    return characterBeforeCodeBlock\n      + backtick\n      + block // For each code block,\n        .replace(/([^\\\\]|^)\\\\(?=[^\\\\]|$)/g, '$1') // remove all user-entered single backslashes from code snippet, or those added from previous line\n        .replace(/\\\\\\\\/g, '\\\\') // replace user-entered double backslashes with single backslashes\n        .split('').join('\\\\') // insert backslashes before all characters to treat code snippet as literal\n      + backtick2;\n  });\n\n  text = (function convertStyleCharacters(text) {\n    let newText = text.replace(/(^|[\\s}_*`~]+)([*`_~])(.*?(?!{{CLOSE|{{OPEN|\\\\))(\\2)(?=[\\s.,{*_`~]|$)/g, '$1{{OPEN$2}}$3{{CLOSE$4}}')\n    if (text === newText){\n      return newText;\n    } else {\n      return convertStyleCharacters(newText);\n    }\n  })(text); // Do multiple sweeps of the string replacing valid style characters with tokens until none are remaining\n\n  for (let i = 0; i < text.length; i++) {\n    let openMatch = text.slice(i).match(/^{{OPEN(.)}}/);\n    let closeMatch = text.slice(i).match(/^{{CLOSE(.)}}/);\n\n    if (openMatch) {\n      let styleCharacter = openMatch[1];\n      if (buffer) {\n        let textNode = document.createTextNode(buffer);\n        buffer = '';\n        styleParent ? styleParent.appendChild(textNode) : elements.push(textNode);\n      }\n\n      let styleElement = document.createElement(stylesByText[styleCharacter]);\n      styleParent ? styleParent.appendChild(styleElement) : elements.push(styleElement);\n      styleParent = styleElement;\n      styleStack.push(styleCharacter);\n      i += (openMatch[0].length - 1);\n\n    } else if (closeMatch && styleStack.slice(-1)[0] === closeMatch[1]) { // this style character closes the most recent open\n      if (buffer) {\n        let textNode = document.createTextNode(buffer);\n        buffer = '';\n        if (styleParent) {\n          styleParent.appendChild(textNode);\n        } else {\n          elements.push(textNode);\n        }\n      }\n      styleParent = styleParent.parentNode || null;\n      styleStack.pop();\n      i += (closeMatch[0].length - 1);\n\n    } else if (closeMatch && styleStack.slice(-1)[0] !== closeMatch[1]) { // this style character does not match and is rejected\n      buffer += closeMatch[1];\n      i += (closeMatch[0].length - 1);\n\n    } else if (!escaped && text[i] === '\\\\') { // handle escape character\n      escaped = true;\n\n    } else { // handle regular character\n      buffer += text[i];\n      escaped = false;\n    }\n  }\n\n  if (buffer) {\n    let textNode = document.createTextNode(buffer);\n    elements.push(textNode);\n  }\n\n  return elements;\n}\n\nexport default renderStyledText;\n","import { onLocalLinkClick, onGlobalAndImportLinkClick } from 'render/click_handlers';\nimport externalLinkIconSvg from 'assets/external_link_icon/icon.svg';\nimport renderStyledText from 'render/render_styled_text';\nimport Link from 'models/link';\nimport Topic from '../../bin/commands/shared/topic';\n\nfunction renderTokenElement(token, renderContext) {\n  if (token.type === 'text') {\n    return renderTextToken(token);\n  } else if (token.type === 'local') {\n    return renderLocalLink(token, renderContext);\n  } else if (token.type === 'global') {\n    return renderGlobalLink(token, renderContext);\n  } else if (token.type === 'import') {\n    return renderImportLink(token, renderContext);\n  } else if (token.type === 'url') {\n    return renderLinkLiteral(token);\n  } else if (token.type === 'image') {\n    return renderImage(token);\n  } else if (token.type === 'html_element') {\n    return renderHtmlElement(token);\n  } else if (token.type === 'footnote') {\n    return renderFootnoteSymbol(token);\n  } else if (token.type === 'code_block') {\n    return renderCodeBlock(token);\n  } else if (token.type === 'quote') {\n    return renderBlockQuote(token);\n  } else if (token.type === 'list') {\n    return renderList(token.topLevelNodes);\n  } else if (token.type === 'table') {\n    return renderTable(token)\n  } else if (token.type === 'html_block') {\n    return renderHtmlBlock(token);\n  } else if (token.type === 'footnote_rule') {\n    return renderFootnoteRule(token);\n  } else if (token.type === 'footnote_line') {\n    return renderFootnoteLine(token);\n  }\n}\n\nfunction renderTextToken(token) {\n  let spanElement = document.createElement('SPAN');\n  let styleElements = renderStyledText(token.text);\n  appendElementsToParent(styleElements, spanElement);\n\n  return spanElement;\n}\n\nfunction renderLocalLink(token, renderContext) {\n  let {\n    localLinkSubtreeCallback\n  } = renderContext;\n\n  localLinkSubtreeCallback(token);\n  return createLocalLinkElement(token)\n}\n\nfunction createLocalLinkElement(token) {\n  let linkElement = document.createElement('a');\n  linkElement.classList.add('canopy-selectable-link');\n  linkElement.dataset.targetTopic = token.targetTopic;\n  linkElement.dataset.targetSubtopic = token.targetSubtopic;\n  linkElement.dataset.enclosingTopic = token.enclosingTopic;\n  linkElement.dataset.enclosingSubtopic = token.enclosingSubtopic;\n  linkElement.dataset.text = token.text;\n\n  let styleElements = renderStyledText(token.text);\n  appendElementsToParent(styleElements, linkElement);\n\n  linkElement.addEventListener(\n    'click',\n    onLocalLinkClick(token.targetTopic, token.targetSubtopic, new Link(linkElement))\n  );\n\n  linkElement.classList.add('canopy-local-link');\n  linkElement.dataset.type = 'local';\n\n  let targetTopic = new Topic(token.targetTopic);\n  let targetSubtopic = new Topic(token.targetSubtopic);\n  linkElement.href = `/${targetTopic.slug}#${targetSubtopic.slug}`;\n  return linkElement;\n}\n\nfunction renderGlobalLink(token, renderContext) {\n  let {\n    pathArray,\n    globalLinkSubtreeCallback\n  } = renderContext;\n\n  let linkElement = createGlobalLinkElement(token, pathArray);\n\n  globalLinkSubtreeCallback(token, linkElement);\n\n  return linkElement;\n}\n\nfunction createGlobalLinkElement(token) {\n  let linkElement = document.createElement('a');\n  let styleElements = renderStyledText(token.text);\n  appendElementsToParent(styleElements, linkElement);\n\n  linkElement.classList.add('canopy-global-link');\n  linkElement.classList.add('canopy-selectable-link');\n  linkElement.dataset.type = 'global';\n\n  linkElement.dataset.targetTopic = token.targetTopic;\n  linkElement.dataset.targetSubtopic = token.targetSubtopic;\n  linkElement.dataset.enclosingTopic = token.enclosingTopic;\n  linkElement.dataset.enclosingSubtopic = token.enclosingSubtopic;\n\n  linkElement.dataset.text = token.text;\n\n  let targetTopic = new Topic(token.targetTopic, true);\n  linkElement.href = `/${targetTopic.slug}`;\n\n  linkElement.addEventListener(\n    'click',\n    onGlobalAndImportLinkClick(new Link(linkElement))\n  );\n  return linkElement\n}\n\nfunction renderImportLink(token, renderContext) {\n  let {\n    pathArray\n  } = renderContext;\n\n  let linkElement = createImportLinkElement(token, pathArray);\n\n  return linkElement;\n}\n\nfunction createImportLinkElement(token) {\n  let linkElement = document.createElement('a');\n\n  let styleElements = renderStyledText(token.text);\n  appendElementsToParent(styleElements, linkElement);\n\n  linkElement.classList.add('canopy-global-link');\n  linkElement.classList.add('canopy-selectable-link');\n  linkElement.dataset.type = 'import';\n\n  linkElement.dataset.targetTopic = token.targetTopic;\n  linkElement.dataset.targetSubtopic = token.targetSubtopic;\n  linkElement.dataset.enclosingTopic = token.enclosingTopic;\n  linkElement.dataset.enclosingSubtopic = token.enclosingSubtopic;\n  linkElement.dataset.text = token.text;\n\n  let targetTopic = new Topic(token.targetTopic);\n  let targetSubtopic = new Topic(token.targetSubtopic);\n  linkElement.href = `/${targetTopic.slug}#${targetSubtopic.slug}`;\n\n  linkElement.addEventListener(\n    'click',\n    onGlobalAndImportLinkClick(new Link(linkElement))\n  );\n\n  return linkElement\n}\n\nfunction renderLinkLiteral(token) {\n  let linkSpan = document.createElement('SPAN');\n  let linkElement = document.createElement('a');\n  linkSpan.classList.add('canopy-url-link-span');\n  linkElement.classList.add('canopy-url-link');\n  linkElement.classList.add('canopy-selectable-link');\n  linkElement.setAttribute('href', token.url);\n  let styleElements = renderStyledText(token.text);\n  appendElementsToParent(styleElements, linkElement);\n  linkElement.dataset.type = 'url';\n  linkElement.dataset.text = token.text;\n  linkSpan.appendChild(linkElement);\n  linkElement.innerHTML += externalLinkIconSvg.replace(/\\r?\\n|\\r/g, '');\n\n  return linkSpan;\n}\n\nfunction renderImage(token) {\n  let divElement = document.createElement('DIV');\n  divElement.classList.add('canopy-image-div');\n\n  let imageElement = document.createElement('IMG');\n  divElement.appendChild(imageElement);\n\n  imageElement.setAttribute('src', token.resourceUrl);\n  imageElement.classList.add('canopy-image');\n\n  let anchorElement = document.createElement('A');\n  anchorElement.setAttribute('href', token.anchorUrl || token.resourceUrl);\n  anchorElement.setAttribute('target', '_blank');\n  anchorElement.appendChild(imageElement);\n  divElement.appendChild(anchorElement);\n\n  if (token.title) {\n    imageElement.setAttribute('title', token.title);\n    let captionElement = document.createElement('SUP');\n    let captionDiv = document.createElement('DIV');\n    captionElement.appendChild(document.createTextNode(token.title));\n    captionElement.classList.add('canopy-image-caption');\n    captionDiv.classList.add('canopy-caption-div');\n    divElement.appendChild(captionElement);\n  } else {\n    divElement.appendChild(anchorElement);\n  }\n\n  if (token.altText) {\n    imageElement.setAttribute('alt', token.altText);\n  }\n\n  return divElement;\n}\n\nfunction renderHtmlElement(token) {\n  let divElement = document.createElement('DIV');\n  divElement.innerHTML = token.html;\n  divElement.classList.add('canopy-raw-html');\n  return divElement;\n}\n\n\nfunction renderFootnoteSymbol(token) {\n  let superscriptElement = document.createElement('SUP');\n  let textNode = document.createTextNode(token.text);\n  superscriptElement.appendChild(textNode);\n  return superscriptElement;\n}\n\nfunction appendElementsToParent(collection, parent) {\n  collection.forEach((item) => {\n    parent.appendChild(item);\n  });\n}\n\nfunction renderCodeBlock(token) {\n  let preElement = document.createElement('PRE');\n  let codeBlockElement = document.createElement('CODE');\n  preElement.appendChild(codeBlockElement);\n\n  codeBlockElement.innerText = token.text;\n\n  return preElement;\n}\n\nfunction renderBlockQuote(token) {\n  let blockQuoteElement = document.createElement('BLOCKQUOTE');\n\n  blockQuoteElement.innerText = token.text;\n\n  return blockQuoteElement;\n}\n\nfunction renderList(listNodeObjects) {\n  let listElement = listNodeObjects[0].ordered ?\n    document.createElement('OL') :\n    document.createElement('UL');\n\n  if (listNodeObjects[0].ordered) {\n    listElement.setAttribute('type', listNodeObjects[0].ordinal);\n  }\n\n  listNodeObjects.forEach((listNodeObject) => {\n    let listItemElement = document.createElement('LI');\n\n    listNodeObject.tokensOfLine.forEach(\n      (token) => {\n        let tokenElement = renderTokenElement(token);\n        listItemElement.appendChild(tokenElement);\n      }\n    );\n\n    if (listNodeObject.children.length > 0) {\n      let childList = renderList(listNodeObject.children);\n      listItemElement.appendChild(childList);\n    }\n\n    listElement.appendChild(listItemElement);\n  });\n  return listElement;\n}\n\nfunction renderTable(token, renderContext) {\n  let tableElement = document.createElement('TABLE');\n  token.rows.forEach(\n    (tokensByCellOfRow) => {\n      let tableRowElement = document.createElement('TR');\n      tokensByCellOfRow.forEach(\n        (tokensOfCell) => {\n          let tableCellElement = document.createElement('TD');\n\n          tokensOfCell.forEach(\n            (token) => {\n              let tokenElement = renderTokenElement(token, renderContext);\n              tableCellElement.appendChild(tokenElement);\n            }\n          );\n\n          tableRowElement.appendChild(tableCellElement);\n        }\n      )\n      tableElement.appendChild(tableRowElement);\n    }\n  );\n  return tableElement;\n}\n\nfunction renderHtmlBlock(token) {\n  let htmlContainer = document.createElement('DIV');\n  htmlContainer.innerHTML = token.html;\n  htmlContainer.classList.add('canopy-raw-html');\n  return htmlContainer;\n}\n\nfunction renderFootnoteRule() {\n  let horizonalRule = document.createElement('HR');\n  horizonalRule.classList.add('canopy-footnote-rule');\n  return horizonalRule;\n}\n\nfunction renderFootnoteLine(footnoteLineToken, renderContext) {\n  let footnoteSpan = document.createElement('SPAN');\n  footnoteSpan.classList.add('canopy-footnote-span');\n  let textNode = document.createTextNode(footnoteLineToken.superscript + '. ');\n  footnoteSpan.appendChild(textNode);\n  footnoteLineToken.tokens.forEach((token) => {\n    let tokenElement = renderTokenElement(token, renderContext);\n    footnoteSpan.appendChild(tokenElement);\n  });\n\n  return footnoteSpan;\n}\n\nexport default renderTokenElement;\n","import fetchAndRenderPath from 'render/fetch_and_render_path';\nimport requestJson from 'requests/request_json';\nimport Paragraph from 'models/paragraph';\nimport Topic from '../../bin/commands/shared/topic';\nimport renderTokenElement from 'render/render_token_element';\n\nfunction renderDomTree(renderContext) {\n  let {\n    subtopic,\n    paragraphsBySubtopic\n  } = renderContext;\n\n  let sectionElement = createSectionElement(renderContext);\n  let paragraph = new Paragraph(sectionElement);\n\n  renderContext.displayBlockingPromises = [];\n  renderContext.localLinkSubtreeCallback = localLinkSubtreeCallback(sectionElement, renderContext);\n  renderContext.globalLinkSubtreeCallback = globalLinkSubtreeCallback(sectionElement, renderContext);\n\n  let tokensOfParagraph = paragraphsBySubtopic[subtopic.mixedCase];\n  if (!tokensOfParagraph) throw `Paragraph with subtopic not found: ${subtopic.mixedCase}`;\n\n  tokensOfParagraph.forEach((token) => {\n    let element = renderTokenElement(token, renderContext);\n    paragraph.paragraphElement.appendChild(element);\n  });\n\n  return Promise.all(renderContext.displayBlockingPromises).then(() => sectionElement);\n}\n\nfunction localLinkSubtreeCallback(sectionElement, renderContext) {\n  return (token) => {\n    let promisedSubtree = renderDomTree(\n      Object.assign({}, renderContext, {\n        subtopic: new Topic(token.targetSubtopic, true)\n      })\n    );\n\n    promisedSubtree.then((subtree) => {\n      sectionElement.appendChild(subtree);\n    });\n\n    renderContext.displayBlockingPromises.push(promisedSubtree);\n  }\n}\n\nfunction globalLinkSubtreeCallback(sectionElement, renderContext) {\n  let {\n    pathToDisplay,\n    subtopic,\n    displayBlockingPromises\n  } = renderContext;\n\n  return (token, linkElement) => {\n    let topic = new Topic(token.targetTopic, true);\n    requestJson(topic); // eager-load and cache\n\n    if (globalLinkIsOpen(linkElement, pathToDisplay, subtopic)) {\n      let newPath = pathToDisplay.withoutFirstSegment;\n      let whenTopicTreeAppended = fetchAndRenderPath(newPath, sectionElement);\n      displayBlockingPromises.push(whenTopicTreeAppended)\n    }\n  }\n}\n\nfunction createSectionElement(renderContext) {\n  let {\n    topic, subtopic, displayTopicName, pathDepth\n  } = renderContext;\n\n  let sectionElement = document.createElement('section');\n  sectionElement.classList.add('canopy-section');\n  let paragraphElement = document.createElement('p');\n  paragraphElement.classList.add('canopy-paragraph');\n  sectionElement.appendChild(paragraphElement);\n  sectionElement.style.display = 'none';\n  sectionElement.dataset.topicName = topic.mixedCase;\n  sectionElement.dataset.displayTopicName = displayTopicName;\n  sectionElement.dataset.subtopicName = subtopic.mixedCase;\n  sectionElement.dataset.pathDepth = pathDepth;\n\n  if (topic.mixedCase === subtopic.mixedCase) {\n    pathDepth > 0 && sectionElement.prepend(document.createElement('hr'));\n    sectionElement.classList.add('canopy-topic-section');\n  }\n\n  return sectionElement;\n}\n\nfunction globalLinkIsOpen(linkElement, path, currentlyRenderingSubtopic) {\n  let subtopicOfPathContainingOpenGlobalReference = path.firstSubtopic;\n  let openGlobalLinkExists = path.secondTopic;\n\n  let openGlobalLinkTargetTopic = path.secondTopic;\n  let openGlobalLinkTargetSubtopic = openGlobalLinkTargetTopic;\n\n  let thisGlobalLinkIsPointingToTheRightThingToBeOpen =\n    linkElement.dataset.targetTopic === openGlobalLinkTargetTopic?.mixedCase &&\n    linkElement.dataset.targetSubtopic === openGlobalLinkTargetSubtopic?.mixedCase;\n\n  let thisGlobalLinkIsInCorrectSubtopicToBeOpen = currentlyRenderingSubtopic.mixedCase ===\n    subtopicOfPathContainingOpenGlobalReference.mixedCase;\n\n  return openGlobalLinkExists &&\n    thisGlobalLinkIsPointingToTheRightThingToBeOpen &&\n    thisGlobalLinkIsInCorrectSubtopicToBeOpen;\n}\n\nexport default renderDomTree;\n","import renderDomTree from 'render/render_dom_tree';\nimport requestJson from 'requests/request_json';\nimport Path from 'models/path';\n\nconst fetchAndRenderPath = (pathToDisplay, parentElement) => {\n  if (pathToDisplay.length === 0) {\n    return Promise.resolve(null);\n  }\n\n  let preexistingElement = Path.elementAtRelativePath(pathToDisplay.firstSegment, parentElement);\n  if (preexistingElement) {\n    if (!Path.connectingLinkValid(parentElement, pathToDisplay)) return Promise.resolve();\n    return fetchAndRenderPath(pathToDisplay.withoutFirstSegment, preexistingElement);\n  }\n\n  let uponResponsePromise = requestJson(pathToDisplay.firstTopic);\n\n  let uponRender = uponResponsePromise.then(({ paragraphsBySubtopic, displayTopicName }) => {\n    return renderDomTree(\n      {\n        topic: pathToDisplay.firstTopic,\n        subtopic: pathToDisplay.firstTopic,\n        pathToDisplay,\n        displayTopicName,\n        paragraphsBySubtopic,\n        pathDepth: Number(parentElement.dataset.pathDepth) + 1 || 0\n      },\n    );\n  });\n\n  return uponRender.then((domTree) => parentElement.appendChild(domTree));\n}\n\nexport default fetchAndRenderPath;\n","import { canopyContainer } from 'helpers/getters';\nimport renderStyledText from 'render/render_styled_text';\nimport displayPath from 'display/display_path';\nimport Link from 'models/link';\nimport Path from 'models/path';\nimport updateView from 'display/update_view';\n\nfunction setHeader(topicName) {\n  let existingHeader = document.querySelector('#_canopy h1')\n  if (existingHeader) { existingHeader.remove(); }\n  let headerDomElement = document.createElement('h1');\n  let styleElements = renderStyledText(topicName);\n  Array.from(styleElements).forEach((element) => {headerDomElement.appendChild(element)});\n  canopyContainer.prepend(headerDomElement);\n}\n\nfunction hideAllSectionElements() {\n  Array.from(document.getElementsByTagName(\"section\")).forEach((sectionElement) => {\n    sectionElement.style.display = 'none';\n  });\n}\n\nfunction deselectAllLinks() {\n  Array.from(document.getElementsByTagName(\"a\")).forEach((linkElement) => {\n    linkElement.classList.remove('canopy-selected-link');\n    linkElement.classList.remove('canopy-open-link');\n  });\n}\n\nfunction deselectSectionElement() {\n  Array.from(document.querySelectorAll('.canopy-selected-section')).forEach((sectionElement) => {\n    sectionElement.classList.remove('canopy-selected-section');\n  });\n}\n\nfunction tryPathPrefix(path, displayOptions) {\n  console.log(\"No section element found for path: \", path.string);\n  console.log(\"Trying: \", path.withoutLastSegment.string);\n  if (path.length > 1) {\n    return displayPath(path.withoutLastSegment, null, displayOptions);\n  } else {\n    console.error(\"Invalid path: \" + path.array);\n    return updateView(Path.default);\n  }\n}\n\nconst resetDom = () => {\n  deselectAllLinks();\n  hideAllSectionElements();\n  deselectSectionElement();\n}\n\nfunction scrollPage(displayOptions) {\n  let behavior = displayOptions.initialPageLoad ? 'auto' : 'smooth';\n\n  window.scrollTo(\n    {\n      top: Link.selection.enclosingParagraph.paragraphElement.offsetTop - (window.screen.height * .3),\n      behavior: behavior\n    }\n  );\n}\n\nexport {\n  setHeader,\n  resetDom,\n  tryPathPrefix,\n  scrollPage\n};\n","import Path from 'models/path';\nimport Link from 'models/link';\nimport updateView from 'display/update_view';\nimport {\n  setHeader,\n  tryPathPrefix,\n  resetDom,\n  scrollPage\n} from 'display/helpers';\n\nconst displayPath = (pathToDisplay, linkToSelect, displayOptions) => {\n  displayOptions = displayOptions || {};\n  if (!pathToDisplay.paragraph) return tryPathPrefix(pathToDisplay, displayOptions);\n  if (linkToSelect?.contradicts(pathToDisplay)) {\n    return updateView(linkToSelect.paragraphPathWhenSelected, linkToSelect, displayOptions);\n  }\n\n  resetDom();\n  Path.setPath(linkToSelect?.urlPathWhenSelected || pathToDisplay);\n  setHeader(pathToDisplay.rootTopicPath.paragraph.displayTopicName);\n  document.title = pathToDisplay.firstTopic.mixedCase;\n  Link.select(linkToSelect); // if null, persists deselect\n\n  pathToDisplay.paragraph.select();\n  displayPathTo(pathToDisplay.paragraph);\n  if (linkToSelect) scrollPage(displayOptions);\n};\n\nconst displayPathTo = (paragraph) => {\n  paragraph.display();\n  if (paragraph.isPageRoot) return;\n  paragraph.parentLink && paragraph.parentLinks.forEach(link => link.open());\n  paragraph.ancestorImportReferences.forEach(link => link.open());\n  if (paragraph.parentLink && !Link.selection) Link.select(paragraph.parentLink);\n  displayPathTo(paragraph.parentParagraph);\n}\n\nexport default displayPath;\n","import fetchAndRenderPath from 'render/fetch_and_render_path';\nimport displayPath from 'display/display_path';\nimport Link from 'models/link';\nimport Path from 'models/path';\nimport { canopyContainer } from 'helpers/getters';\n\nconst updateView = (pathToDisplay, linkToSelect, displayOptions) => {\n  validatePathAndLink(pathToDisplay, linkToSelect);\n  if (pathToDisplay.empty) pathToDisplay = Path.default;\n\n  let newTreeAppended = fetchAndRenderPath(pathToDisplay, canopyContainer);\n\n  return newTreeAppended.then(() => {\n    displayPath(\n      pathToDisplay,\n      linkToSelect,\n      displayOptions\n    );\n  }).catch(handleError(pathToDisplay, displayOptions));\n}\n\nfunction validatePathAndLink(pathToDisplay, linkToSelect) {\n  if (!(pathToDisplay instanceof Path)) throw 'Invalid path argument';\n  if (linkToSelect && !(linkToSelect instanceof Link)) throw 'Invalid link selection argument';\n}\n\nfunction handleError(pathToDisplay, displayOptions) {\n  return (e) => {\n    if (e === 'Link selector callback provided no link') {\n      displayPath(pathToDisplay, null, displayOptions);\n    } else {\n      console.error(e);\n    }\n  }\n}\n\nexport default updateView;\n","import updateView from 'display/update_view';\nimport Path from 'models/path';\nimport Link from 'models/link';\nimport Paragraph from 'models/paragraph';\n\nfunction moveUpward() {\n  let link = Link.selection;\n\n  if (link.enclosingParagraph.equals(Paragraph.pageRoot)) {\n    return updateView(link.enclosingParagraph.path); // deselect link\n  }\n\n  return updateView(\n    link.parentLink.paragraphPathWhenSelected,\n    link.parentLink\n  );\n}\n\nfunction topicParentLink() {\n  let link = Link.selection;\n  let newLink = link.enclosingParagraph.topicParagraph.parentLink\n\n  return updateView(\n    newLink?.paragraphPathWhenSelected || Path.current,\n    newLink || link\n  );\n}\n\nfunction moveDownward() {\n  let oldLink = Link.selection;\n\n  if (oldLink.isImport) {\n    updateView(\n      oldLink.paragraphPathWhenSelected,\n      oldLink.targetParagraph.parentLink\n    );\n  }\n\n  if (oldLink.isGlobal || oldLink.isLocal) {\n    let newLink = oldLink.targetParagraph?.firstLink || oldLink.targetParagraph?.parentLink;\n\n    updateView(\n      newLink.paragraphPathWhenSelected,\n      newLink\n    );\n  }\n\n  if (!oldLink.isParent) {\n    updateView(\n      oldLink.paragraphPathWhenSelected,\n      oldLink\n    );\n  }\n}\n\nfunction moveLeftward() {\n  let link = Link.selection.previousSibling || Link.selection.lastSibling;\n  return updateView(\n    link.paragraphPathWhenSelected,\n    link\n  );\n}\n\nfunction moveRightward() {\n  let link = Link.selection.nextSibling || Link.selection.firstSibling;\n\n  return updateView(\n    link.paragraphPathWhenSelected,\n    link\n  );\n}\n\nfunction moveDownOrRedirect(newTab, altKey) {\n  if (Link.selection.isLocal && !altKey) { // no zoom\n    let link = Link.selection.targetParagraph?.firstLink || Link.selection.targetParagraph?.parentLink;\n    let path = link.paragraphPathWhenSelected;\n\n    if (newTab) {\n      return window.open(location.origin + Link.selection.targetPath, '_blank');\n    } else {\n      return updateView(path, link);\n    }\n  }\n\n  if (Link.selection.isLocal && altKey) { // zoom\n    let link = Link.selection;\n    let path = link.paragraphPathWhenSelected.lastSegment;\n\n    if (newTab) {\n      return window.open(location.origin + Link.selection.targetPath.lastSegment, '_blank');\n    } else {\n      return updateView(\n        path,\n        link.atNewPath(path)\n      );\n    }\n  }\n\n  if (Link.selection.isGlobal) { // redirect\n    let path = Link.selection.targetPath.lastSegment;\n\n    if (newTab) {\n      return window.open(location.origin + path.string, '_blank');\n    } else {\n      return updateView(\n        path,\n        Link.selectALink(path)\n      )\n    }\n  }\n\n  if (Link.selection.isImport) { // redirect\n    let path = Link.selection.targetPath.lastSegment;\n\n    if (newTab) {\n      return window.open(location.origin + path.string, '_blank');\n    } else {\n      return updateView(\n        path,\n        Link.selection.parentLink.atNewPath(path)\n      )\n    }\n  }\n\n  if (Link.selection.type === 'url') {\n    if (newTab) {\n      return window.open(Link.selection.element.href, '_blank');\n    } else {\n      window.location = Link.selection.element.href;\n    }\n  }\n}\n\nfunction depthFirstSearch() {\n  let link = Link.selection;\n\n  // Open a parent link\n  if (link.isLocal && link.hasChildren) {\n    let nextLink = link.firstChildLink || link.nextSibling || link;\n    return updateView(\n      nextLink.paragraphPathWhenSelected,\n      nextLink\n    );\n  }\n\n  if (link.isGlobalOrImport) {\n    let linkToSelect = link.nextSibling || link.parentLink?.nextSibling || link.enclosingParagraph.firstLink;\n    return updateView(\n      linkToSelect.enclosingParagraph.path,\n      linkToSelect\n    );\n  }\n\n  // Move to the next sibling including parent link with no children\n  if (link.nextSibling && !link.nextSibling.equals(link)) {\n    return updateView(\n      link.nextSibling.enclosingParagraph.path,\n      link.nextSibling,\n    );\n  }\n\n  // Move to next parent sibling, grandparent sibling, etc.\n  if (link.lastSibling.equals(link)) {\n    let linkToSelect = (function parentSibling (link) {\n      if (!(link.parentLink && link.parentLink.isLocal)) { // If there is no parent link that is local\n        return link.firstSibling; // cycle\n      } else if (link.parentLink.nextSibling) { // If there is a parent-sibling link select that\n        return link.parentLink.nextSibling;\n      } else {\n        return parentSibling(link.parentLink) // otherwise repeat the above steps using the local parent link\n      }\n    })(link);\n\n    return updateView(\n      linkToSelect.paragraphPathWhenSelected,\n      linkToSelect\n    );\n  }\n}\n\nfunction zoomOnLocalPath() {\n  let currentLink = Link.selection;\n  let newPath = currentLink.localPathWhenSelected;\n\n  let newLink = currentLink.atNewPath(newPath);\n\n  return updateView(\n    newPath,\n    newLink,\n  );\n}\n\nfunction removeSelection() {\n  return updateView(Path.current.rootTopicPath);\n}\n\nexport {\n  moveUpward,\n  topicParentLink,\n  moveDownward,\n  moveLeftward,\n  moveRightward,\n  moveDownOrRedirect,\n  depthFirstSearch,\n  zoomOnLocalPath,\n  removeSelection\n};\n","import {\n  moveUpward,\n  topicParentLink,\n  moveDownward,\n  moveLeftward,\n  moveRightward,\n  moveDownOrRedirect,\n  depthFirstSearch,\n  zoomOnLocalPath,\n  removeSelection\n} from 'keys/key_handlers';\nimport updateView from 'display/update_view';\nimport Path from 'models/path';\nimport Link from 'models/link';\n\nconst registerKeyListeners = () => {\n  window.addEventListener('keydown', function(e) {\n    let modifiers =\n      (e.metaKey ? 'meta-' : '') +\n      (e.ctrlKey ? 'ctrl-' : '') +\n      (e.altKey ? 'alt-' : '') +\n      (e.shiftKey ? 'shift-' : '');\n\n    let keyName = keyNames[e.keyCode];\n    let shortcutName = modifiers + keyName;\n\n    if (['tab', 'down', 'up'].includes(keyName)) {\n      e.preventDefault();\n    }\n\n    if (Link.selection) {\n      (shortcutRelationships[shortcutName]||function(){})()\n    } else if (shortcutRelationships[shortcutName]) {\n      updateView(\n        Path.current,\n        Link.selectALink()\n      );\n    }\n  });\n}\n\nconst shortcutRelationships = {\n  'left': moveLeftward,\n  'up': moveUpward,\n  'down': moveDownward,\n  'right': moveRightward,\n  'shift-up': topicParentLink,\n\n  'h': moveLeftward,\n  'j': moveDownward,\n  'k': moveUpward,\n  'l': moveRightward,\n\n  'escape': removeSelection,\n  'z': zoomOnLocalPath,\n\n  'enter': moveDownOrRedirect,\n  'meta-enter': moveDownOrRedirect.bind(null, true), // mac\n  'ctrl-enter': moveDownOrRedirect.bind(null, true), // windows & linux\n  'alt-enter': moveDownOrRedirect.bind(null, false, true),\n  'meta-alt-enter': moveDownOrRedirect.bind(null, true, true), // mac\n  'ctrl-alt-enter': moveDownOrRedirect.bind(null, true, true), // windows & linux\n\n  'tab': depthFirstSearch,\n}\n\nconst keyNames = {\n  37: 'left',\n  39: 'right',\n  38: 'up',\n  40: 'down',\n\n  71: 'g',\n  72: 'h',\n  75: 'k',\n  74: 'j',\n  76: 'l',\n  186: ';',\n  90: 'z',\n\n  13: 'enter',\n  9: 'tab',\n  27: 'escape',\n\n  192: '`',\n\n  49: '1',\n  50: '2',\n  51: '3',\n  52: '4',\n  53: '5',\n\n}\n\nexport default registerKeyListeners;\n","import updateView from 'display/update_view';\nimport Path from 'models/path';\nimport Link from 'models/link';\n\nfunction registerPopStateListener() {\n  if ('scrollRestoration' in history) {\n    history.scrollRestoration = 'manual';\n  }\n\n  window.addEventListener('popstate', (e) => {\n    let linkSelection = Link.selectionPresentInEvent(e) ? new Link(e.state) : null;\n\n    updateView(\n      Path.currentOrDefault,\n      linkSelection || Link.sessionSelection\n    );\n  });\n}\n\nexport default registerPopStateListener;\n","import 'style/canopy.scss';\nimport updateView from 'display/update_view';\nimport registerKeyListeners from 'keys/register_key_listeners';\nimport registerPopStateListener from 'history/register_pop_state_listener';\nimport Path from 'models/path';\nimport Link from 'models/link';\n\nregisterKeyListeners();\nregisterPopStateListener();\n\nupdateView(\n  Path.currentOrDefault,\n  Link.priorSelection,\n  { initialPageLoad: true }\n);\n"],"names":["module","exports","removeStyleCharacters","string","newString","replace","require","Topic","fromMixedCase","this","display","mixedCase","escapedMixedCase","slug","encodedSlug","caps","toUpperCase","fileName","requestFileName","encodeURIComponent","capsFile","___CSS_LOADER_EXPORT___","push","id","cssWithMappingToString","list","toString","map","item","content","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","k","_k","cssMapping","btoa","base64","unescape","JSON","stringify","data","sourceMapping","sourceURLs","sources","source","sourceRoot","stylesInDOM","getIndexByIdentifier","identifier","result","modulesToDom","options","idCountMap","identifiers","base","count","indexByIdentifier","obj","css","sourceMap","references","updater","addElementStyle","byIndex","splice","api","domAPI","update","newObj","remove","lastIdentifiers","newList","index","newLastIdentifiers","_i","_index","memo","insert","style","target","styleTarget","document","querySelector","window","HTMLIFrameElement","contentDocument","head","e","getTarget","Error","appendChild","element","createElement","setAttributes","attributes","styleElement","nonce","setAttribute","insertStyleElement","styleTagTransform","apply","parentNode","removeChild","removeStyleElement","styleSheet","cssText","firstChild","createTextNode","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","nc","canopyContainer","getElementById","defaultTopic","dataset","projectPathPrefix","hashUrls","getAncestorElement","currentElement","className","parentElement","classList","contains","Link","argument","tagName","metadataObject","selectorCallback","linkElement","link","pathString","Paragraph","path","text","relativeLinkNumber","object","paragraph","Path","linkBySelector","linkToSelect","add","persistInHistory","persistInSession","state","containsLinkSelectionMetadata","sessionData","sessionStorage","getItem","parse","history","historySelection","sessionSelection","selectedLink","linkData","metadata","setItem","location","pathname","hash","replaceState","title","href","firstLink","parentLink","otherLink","targetTopic","targetSubtopic","paragraphPathWhenSelected","elementFromMetadata","HTMLAnchorElement","transferDataset","_targetTopic","_targetSubtopic","_enclosingTopic","enclosingTopic","_enclosingSubtopic","enclosingSubtopic","_typeValue","type","enclosingSectionElement","isParent","pathDepth","enclosingParagraph","isGlobalOrImport","Number","sectionElement","newPath","parentParagraph","links","find","matcher","pathArray","slice","lastSegment","matches","storedRelativeLinkNumber","indexOf","collectMetadata","addSegment","isLocal","replaceTerminalSubtopic","equals","linkElements","siblings","targetParagraph","lastLink","includes","isOpen","isGlobal","isImport","hasLinks","otherParagraph","_topicName","topicName","_subtopicName","subtopicName","console","trace","paragraphElement","Array","from","childNodes","currentParagraph","currentTopicParagraph","topicParagraph","unshift","linkObjects","querySelectorAll","topic","subtopic","callback","filter","linkByTarget","linksBySelector","pageRoot","displayTopicName","isTopic","isArray","validatePathArray","arrayToString","String","stringToArray","array","forEach","tuple","origin","current","empty","slashSeparatedUnits","split","fixOrphanSubtopics","slashSeparatedUnit","match","segment","topicString","subtopicString","decodeURIComponent","pathSegmentString","newItem","pathToDisplay","firstTopic","error","suppliedPath","suppliedRootElement","rootElement","currentNode","firstSubtopic","withoutFirstSegment","subpath","newPathDepth","oldPath","documentTitle","historyApiFunction","b","c","pushState","fullPathString","otherPath","newSubtopic","withoutLastSegment","elementAtRelativePath","REQUEST_CACHE","dataPath","promise","fetch","then","res","json","updateView","Promise","reject","onGlobalAndImportLinkClick","preventDefault","newTab","metaKey","ctrlKey","altKey","isSelected","open","styleParent","buffer","escaped","styleStack","stylesByText","elements","convertStyleCharacters","newText","_","characterBeforeCodeBlock","backtick","block","backtick2","openMatch","closeMatch","styleCharacter","textNode","pop","renderTokenElement","token","renderContext","spanElement","appendElementsToParent","renderStyledText","renderTextToken","localLinkSubtreeCallback","addEventListener","targetPath","atNewPath","createLocalLinkElement","renderLocalLink","globalLinkSubtreeCallback","createGlobalLinkElement","renderGlobalLink","createImportLinkElement","renderImportLink","linkSpan","url","innerHTML","externalLinkIconSvg","renderLinkLiteral","divElement","imageElement","resourceUrl","anchorElement","anchorUrl","captionElement","captionDiv","altText","renderImage","html","renderHtmlElement","superscriptElement","renderFootnoteSymbol","preElement","codeBlockElement","innerText","renderCodeBlock","blockQuoteElement","renderBlockQuote","renderList","topLevelNodes","tableElement","rows","tokensByCellOfRow","tableRowElement","tokensOfCell","tableCellElement","tokenElement","renderTable","htmlContainer","renderHtmlBlock","horizonalRule","footnoteLineToken","footnoteSpan","superscript","tokens","renderFootnoteLine","collection","parent","listNodeObjects","listElement","ordered","ordinal","listNodeObject","listItemElement","tokensOfLine","children","childList","renderDomTree","paragraphsBySubtopic","prepend","createSectionElement","displayBlockingPromises","promisedSubtree","assign","subtree","requestJson","currentlyRenderingSubtopic","subtopicOfPathContainingOpenGlobalReference","openGlobalLinkExists","secondTopic","openGlobalLinkTargetTopic","openGlobalLinkTargetSubtopic","thisGlobalLinkIsPointingToTheRightThingToBeOpen","thisGlobalLinkIsInCorrectSubtopicToBeOpen","globalLinkIsOpen","whenTopicTreeAppended","fetchAndRenderPath","tokensOfParagraph","all","resolve","preexistingElement","firstSegment","domTree","displayPathTo","isPageRoot","parentLinks","ancestorImportReferences","displayOptions","contradicts","getElementsByTagName","urlPathWhenSelected","existingHeader","headerDomElement","styleElements","setHeader","rootTopicPath","select","behavior","initialPageLoad","scrollTo","top","screen","height","scrollPage","log","displayPath","tryPathPrefix","validatePathAndLink","handleError","moveUpward","moveDownward","oldLink","newLink","moveLeftward","moveRightward","moveDownOrRedirect","shortcutRelationships","currentLink","localPathWhenSelected","bind","hasChildren","nextLink","firstChildLink","nextSibling","lastSibling","parentSibling","firstSibling","keyNames","modifiers","shiftKey","keyName","keyCode","shortcutName","scrollRestoration","linkSelection"],"sourceRoot":""}
#_canopy {
  padding-top: 15px;
  overflow-anchor: none; // Prevent browser from trying to maintain position when page contents change, which might interfere with window.scrollTo

  /* Removing DOM elements from the bottom of the screen can force the page to scroll upward to the existing elements
  which is not animated. If we keep a padding on the bottom of the last element just beyond the viewport, then
  removal of elements from the bottom of the visible stack never brings the real bottom of the page into view, and so
  the scroll upwards can be animated using the window.scrollTo method. */

  padding-bottom: calc(80vh);


  h1 {
    text-align: center;
    margin: auto;
    margin-top: 10px;
  }

  hr {
    width: 120px;
    display: block;
    height: 1px;
    border: 0;
    border-top: 5px solid #ccc;
    margin: 0px auto;
  }

  section.canopy-topic-section {
    padding-top: 25px;
  }

  section {
    padding-top: 15px;
  }

  p {
    overflow: visible; // In case external link icon is at end of line
    font-size: 21px;
    max-width: 750px;
    margin: auto;

    line-height: 1.3;
    letter-spacing: -.003em;
    font-weight: 400;
    font-family: Times, serif;

    position: relative; // to allow absolute children
  }

  .canopy-topic-section hr + p {
    padding-top: 20px;
  }

///////////// Link styles /////////////////

  a.canopy-selectable-link {
    text-decoration: underline #DDDDDD;
    color: black;
    cursor: pointer;

    &:focus {
      outline:0;
    }

    &.canopy-open-link {
      // text-shadow: .8px 0px 0px #000000;
      text-decoration: underline;
      background-color: #F3F3F3;
    }

    &:hover {
      text-decoration: underline #000000;
    }

    &.canopy-selected-link {
      background-color: #edeefc;
      text-shadow: 0px 0px 0px #000000;
      text-decoration: none;
    }

    &.canopy-url-link {
      text-decoration: none; // we want the selection background to extend beyond the icon but the underlining only until the end of the icon's bottom
      display: inline;
      overflow-wrap: break-word;
      white-space: normal;
      margin-right: -2px; // we want the text after the icon to hug the icon, eg if it is a period

      .canopy-url-link-tokens-container {
        text-decoration: underline #DDDDDD;

        &:hover {
          text-decoration: underline #000000; // hover underline should be black
        }
      }

      .canopy-url-link-svg-container {
        padding-right: 3px; // this is the spacing after the icon that extends the selected-link-selection bg but not the underlining
        margin-left: -8px; // We add 3 non-breaking spaces, then move the svg over them so the last word always wraps with svg
        margin-right: -8px; // If character after is punctuation and we move it within the spacing, it will also wrap with the svg
      }

      .canopy-url-link-tokens-spacing { // this is the spacing before the icon that creates space for the icon's negative margin
        font-size: 18px;                // we use spaces and not padding because spaces can get text-decoration
      }

      span {
        display: inline;
      }

      svg {
        height: 15px;
        width: 12px;
        vertical-align: -4px; // move the icon in-line with the text
      }
     }
  }

/////////////////////////////////////////////

  span.canopy-text-span {
    display: block;
  }

  hr.canopy-footnote-rule {
    width: 750px;
    display: block;
    height: 1px;
    border: 0;
    border-top: 1px solid #ccc;
    margin: 12px 0;
    padding: 0;
  }

  sup {
    font-size: 60%;
    padding: 2px;
  }

  .canopy-footnote-span {
    font-size: 80%;
    display: block;
    span { // text after number
      margin-left: 2px;
    }
    &:not(:last-child) {
      padding-bottom: 7px;
    }
  }

  blockquote {
    padding: 0 .7em;
    color: #565e67;

    a, a.canopy-selectable-link {
      color: #565e67;
    }

    &[dir="rtl"] {
      border-right: 0.25em solid lightgray;
    }

    &[dir="ltr"] {
      border-left: 0.25em solid lightgray;
    }

    margin-block-start: .5em;
    margin-block-end: .5em;
    margin-inline-start: 0px;
    margin-inline-end: 0px;

    a.canopy-selectable-link {
      text-decoration: underline #D3D3D3;
    }
  }

  pre {
    margin: 10px 10px;
    background-color: #eff0f1;
    padding: 5px;
    font-size: 85%;
  }

  code {
    background-color: #eff0f1;
    font-size: 90%;
  }

  table {
    margin: 21px auto auto auto;
    table-layout: auto;
    max-width: 90%;
    border-collapse: collapse;
    border: none; // we put the border on the TDs to allow omitted table cells
    font-size: 18px;
    min-width: 500px;
    table-layout: fixed;

    &:not(:last-child) {
      margin-bottom: 21px;
    }

    td, th {
      border: 1px solid black;
      text-align: center;
      padding: 10px;

      // width: 0%; // this seems to make cells even without expanding table

      &.hidden {
        display: none;
      }

      br {
        display: block; // makes it have a width
        content: ""; // clears default height
        padding-bottom: 2px;
      }
    }

    td.canopy-table-link-cell {
      cursor: pointer;

      a.canopy-selectable-link {
        text-decoration: none;
        text-shadow: none;
      }

      &:has(.canopy-selected-link) {
        background-color: #edeefc;
      }

      &:has(.canopy-open-link):not(:has(.canopy-selected-link)) {
        background-color: #F3F3F3;
      }

      &:hover:not(:has(.canopy-selected-link)), // selected link style overrides hover
      &:hover:has(.canopy-open-link):not(:has(.canopy-selected-link)) {
        background-color: #f5f6fe;

        .canopy-selected-link {
            background-color: #f5f6fe;
        }
      }
    }
  }

  .canopy-table-list-container {
    display: flex;
    flex-direction: column;
    max-width: 96vw;
    width: 96vw;
    margin-left: calc((-96vw / 2) + (750px / 2));

    &:not(:first-child) {
      margin-top: 20px;
    }

    .canopy-table-list {
      display: flex;
      flex-direction: column;
      margin: 0 auto;

      .canopy-table-list-row {
        display: flex;
        max-width: 96vw;
      }

      .canopy-table-list-cell {
        display: flex;
        width: calc(115px + 3vw);
        max-width: 11vw;
        height: 23vw;
        max-height: 95px;
        margin: 5px;
        border: 1.5px solid black;
        border-radius: 5px;
        padding: 8px 12px;
        text-align: center;
        justify-content: center;
        box-sizing: border-box;
      }

      @media screen and (max-width: 1000px) {
        .canopy-table-list-cell {
          max-width: 10vw;
        }

        .canopy-table-list-content-container * {
          max-width: 6vw;
        }
      }

      .canopy-table-list-content-container {
        align-items: center;
        display: flex;
        justify-content: center;
        overflow: scroll;
        overflow: hidden;
      }

      .canopy-table-list-content-container * {
        align-items: center;
        justify-content: center;
        max-height: 70px;
        max-width: 140px;
        text-wrap: balance;
        word-wrap: break-word;
        overflow-wrap: break-word;
        hyphens: auto;
      }

      .canopy-table-list-link-cell {
        cursor: pointer;

        a.canopy-selectable-link {
          text-decoration: none;
          text-shadow: none;
        }

        &:has(.canopy-selected-link) {
          background-color: #edeefc;
        }

        &:has(.canopy-open-link):not(:has(.canopy-selected-link)) {
          background-color: #F3F3F3;
        }

        &:hover:not(:has(.canopy-selected-link)), // selected link style overrides hover
        &:hover:has(.canopy-open-link):not(:has(.canopy-selected-link)) {
          background-color: #f5f6fe;

          .canopy-selected-link {
              background-color: #f5f6fe;
          }
        }
      }
    }
  }

  .canopy-image {
    &:not(:last-child) {
      margin-bottom: 15px;
    }

    margin-top: 15px;

    a {
      margin: 0 auto;
      display: block;
      background-color: F1F1F1;
    }

    img {
      display: block;
      width: 100%;
      margin: 0 auto;
    }

    span.canopy-image-caption {
      margin: 0px auto;
      width: 100%;
      padding: 6px 0;
      text-align: left;
      display: block;
      font-size: 16px;
      margin-top: 4px;
      line-height: 18px;
      color: #595959;

      a {
        color: #595959;
      }

      span {
        display: inline;
      }
    }
  }

  div.canopy-image-div {
    float: right;
    border: 1px solid #c8ccd1;
    padding: 3px;
    background-color: #f8f9fa;
    font-size: 94%;
    text-align: center;
    overflow: hidden;
    margin: 10px;
  }

  div.canopy-image-div > sup {
    display: block;
  }

  ol, ul {
    margin-top: 15px;
    margin-left: 10px;
    margin-right: 10px;
    margin-bottom: 0px;

    &:not(:last-child) {
      margin-bottom: 15px;
    }

    li:not(:last-child) {
      margin-bottom: 10px;
    }
  }

  div.canopy-raw-html {
    display: inline;
  }
}
